
----SRC LAYER----
WITH
SRC_MIRA as ( SELECT *     from       ODS_ACTUARIAL.BWC_STG_MIRA_RESERVE_EXTRACT )
//SRC_MIRA as ( SELECT *     from      DST_MIRA_RESERVE_EXTRACT)
----LOGIC LAYER----
,
LOGIC_MIRA as ( SELECT 
		UNIQUE_ID_KEY AS UNIQUE_ID_KEY,
		EXTRACT_DATE AS EXTRACT_DATE,
		QRTR_YEAR AS QRTR_YEAR,
		CLAIM_NMBR AS CLAIM_NMBR,
		INJRY_DATE AS INJRY_DATE,
		INJRY_YEAR AS INJRY_YEAR,
		PLCY_NMBR AS PLCY_NMBR,
		MANUAL_CLASS_NMBR AS MANUAL_CLASS_NMBR,
		PRDCT_STS_CODE AS PRDCT_STS_CODE,
		INJRY_TYPE_CODE AS INJRY_TYPE_CODE,
		EMPLY_TYPE_CODE AS EMPLY_TYPE_CODE,
		CVRG_TYPE_CODE AS CVRG_TYPE_CODE,
		PLCY_TYPE_CODE AS PLCY_TYPE_CODE,
		CLAIM_CTGRY_CODE AS CLAIM_CTGRY_CODE,
		ACDNT_TYPE_CODE AS ACDNT_TYPE_CODE,
		INJRY_SVRTY_CODE AS INJRY_SVRTY_CODE,
		CLAIM_STS_CODE AS CLAIM_STS_CODE,
		PRMRY_ICD_CODE AS PRMRY_ICD_CODE,
		SELF_INSRD_IND AS SELF_INSRD_IND,
		STOP_CNDTN_IND AS STOP_CNDTN_IND,
		FATAL_INJRY_IND AS FATAL_INJRY_IND,
		CLAIM_INCTV_IND AS CLAIM_INCTV_IND,
		CLAIM_CLSD_IND AS CLAIM_CLSD_IND,
		C92_APLCT_STS_CODE AS C92_APLCT_STS_CODE,
		C92_APLCT_ALWD_DATE AS C92_APLCT_ALWD_DATE,
		C92_APLCT_DSLWD_DATE AS C92_APLCT_DSLWD_DATE,
		CO_PAID_WEEK_QTY AS CO_PAID_WEEK_QTY,
		FLNG_DATE AS FLNG_DATE,
		ESTMT_RTW_DATE AS ESTMT_RTW_DATE,
		RTW_DATE AS RTW_DATE,
		DTH_DATE AS DTH_DATE,
		REHAB_START_DATE AS REHAB_START_DATE,
		MMI_DATE AS MMI_DATE,
		CLAIM_FIRST_DCSN_DATE AS CLAIM_FIRST_DCSN_DATE,
		LAST_CMPNS_PAID_DATE AS LAST_CMPNS_PAID_DATE,
		LAST_CMPNS_STOP_DATE AS LAST_CMPNS_STOP_DATE,
		LAST_DPNDN_BNFT_PAID_DATE AS LAST_DPNDN_BNFT_PAID_DATE,
		LAST_DTH_BNFT_PAY_DATE AS LAST_DTH_BNFT_PAY_DATE,
		LAST_DTH_BNFT_STOP_DATE AS LAST_DTH_BNFT_STOP_DATE,
		LAST_LM_PAID_DATE AS LAST_LM_PAID_DATE,
		LAST_LM_STOP_DATE AS LAST_LM_STOP_DATE,
		LAST_FD_PAID_DATE AS LAST_FD_PAID_DATE,
		LAST_FD_STOP_DATE AS LAST_FD_STOP_DATE,
		LAST_PP_STOP_DATE AS LAST_PP_STOP_DATE,
		LAST_PRCNT_PP_PAID_DATE AS LAST_PRCNT_PP_PAID_DATE,
		LAST_CO_STOP_DATE AS LAST_CO_STOP_DATE,
		LAST_WL_STOP_DATE AS LAST_WL_STOP_DATE,
		LAST_TT_PAID_DATE AS LAST_TT_PAID_DATE,
		LAST_TT_STOP_DATE AS LAST_TT_STOP_DATE,
		LAST_TP_STOP_DATE AS LAST_TP_STOP_DATE,
		LAST_MDCL_SRVC_DATE AS LAST_MDCL_SRVC_DATE,
		LAST_MDCL_PAID_DATE AS LAST_MDCL_PAID_DATE,
		LAST_PRDCNT_DATE AS LAST_PRDCNT_DATE,
		TOTAL_INCRD_AMT AS TOTAL_INCRD_AMT,
		TOTAL_PAID_AMT AS TOTAL_PAID_AMT,
		TOTAL_ORGNL_RSRV_AMT AS TOTAL_ORGNL_RSRV_AMT,
		TOTAL_ADJST_RSRV_AMNT AS TOTAL_ADJST_RSRV_AMNT,
		TOTAL_PBLSH_RSRV_AMT AS TOTAL_PBLSH_RSRV_AMT,
		TOTAL_INDMN_PAID_AMT AS TOTAL_INDMN_PAID_AMT,
		DTH_BNFT_INCRD_AMT AS DTH_BNFT_INCRD_AMT,
		DTH_BNFT_PAID_AMT AS DTH_BNFT_PAID_AMT,
		DTH_BNFT_ORGNL_RSRV_AMT AS DTH_BNFT_ORGNL_RSRV_AMT,
		DTH_BNFT_ADJST_RSRV_AMNT AS DTH_BNFT_ADJST_RSRV_AMNT,
		DTH_BNFT_PRDCT_IND AS DTH_BNFT_PRDCT_IND,
		LM_INCRD_AMT AS LM_INCRD_AMT,
		LM_PAID_AMT AS LM_PAID_AMT,
		LM_ORGNL_RSRV_AMT AS LM_ORGNL_RSRV_AMT,
		LM_ADJST_RSRV_AMNT AS LM_ADJST_RSRV_AMNT,
		LM_PRDCT_IND AS LM_PRDCT_IND,
		MDCL_INCRD_AMT AS MDCL_INCRD_AMT,
		MDCL_PAID_AMT AS MDCL_PAID_AMT,
		MDCL_ORGNL_RSRV_AMT AS MDCL_ORGNL_RSRV_AMT,
		MDCL_ADJST_RSRV_AMNT AS MDCL_ADJST_RSRV_AMNT,
		MDCL_PRDCT_IND AS MDCL_PRDCT_IND,
		PT_INCRD_AMT AS PT_INCRD_AMT,
		PT_PAID_AMT AS PT_PAID_AMT,
		PT_ORGNL_RSRV_AMT AS PT_ORGNL_RSRV_AMT,
		PT_ADJST_RSRV_AMNT AS PT_ADJST_RSRV_AMNT,
		PT_PRDCT_IND AS PT_PRDCT_IND,
		FD_INCRD_AMT AS FD_INCRD_AMT,
		FD_PAID_AMT AS FD_PAID_AMT,
		FD_ORGNL_RSRV_AMT AS FD_ORGNL_RSRV_AMT,
		FD_ADJST_RSRV_AMNT AS FD_ADJST_RSRV_AMNT,
		FD_PRDCT_IND AS FD_PRDCT_IND,
		CO_INCRD_AMT AS CO_INCRD_AMT,
		CO_PAID_AMT AS CO_PAID_AMT,
		CO_ORGNL_RSRV_AMT AS CO_ORGNL_RSRV_AMT,
		CO_ADJST_RSRV_AMNT AS CO_ADJST_RSRV_AMNT,
		CO_PRDCT_IND AS CO_PRDCT_IND,
		SUM_PP_PRCNT_PP_INCRD_AMT AS SUM_PP_PRCNT_PP_INCRD_AMT,
		SUM_PP_PRCNT_PP_PAID_AMT AS SUM_PP_PRCNT_PP_PAID_AMT,
		SUM_PP_PRCNT_PP_ORGNL_RSRV_AMT AS SUM_PP_PRCNT_PP_ORGNL_RSRV_AMT,
		SUM_PP_PRCNT_PP_ADJST_RSRV_AMNT AS SUM_PP_PRCNT_PP_ADJST_RSRV_AMNT,
		PP_PRCNT_PP_PRDCT_IND AS PP_PRCNT_PP_PRDCT_IND,
		SUM_TP_TT_WG_INCRD_AMT AS SUM_TP_TT_WG_INCRD_AMT,
		SUM_TP_TT_WG_PAID_AMT AS SUM_TP_TT_WG_PAID_AMT,
		SUM_TP_TT_WG_ORGNL_RSRV_AMT AS SUM_TP_TT_WG_ORGNL_RSRV_AMT,
		SUM_TP_TT_WG_ADJST_RSRV_AMNT AS SUM_TP_TT_WG_ADJST_RSRV_AMNT,
		TP_TT_WL_PRDCT_IND AS TP_TT_WL_PRDCT_IND,
		OIG_INCRD_AMT AS OIG_INCRD_AMT,
		OIG_PAID_AMT AS OIG_PAID_AMT,
		OIG_ORGNL_RSRV_AMT AS OIG_ORGNL_RSRV_AMT,
		OIG_ADJST_RSRV_AMNT AS OIG_ADJST_RSRV_AMNT,
		SLRY_CNTNT_AMT AS SLRY_CNTNT_AMT,
		SLRY_CNTNT_RDCTN_AMT AS SLRY_CNTNT_RDCTN_AMT,
		SLRY_CNTNT_LM_RDCTN_AMT AS SLRY_CNTNT_LM_RDCTN_AMT,
		SLRY_CNTNT_OTH_LM_RDCTN_AMT AS SLRY_CNTNT_OTH_LM_RDCTN_AMT,
		MDCL_RDCTN_AMT AS MDCL_RDCTN_AMT,
		LM_LMWL_RDCTN_AMT AS LM_LMWL_RDCTN_AMT,
		LUMP_SUM_STLMN_AMT AS LUMP_SUM_STLMN_AMT,
		PP_PRCNT_PP_PAID_AMT AS PP_PRCNT_PP_PAID_AMT,
		DPNDN_QTY AS DPNDN_QTY,
		CRT_DTTM AS CRT_DTTM,
		CRT_PRGRM_NAME AS CRT_PRGRM_NAME 
				from SRC_MIRA
            )
----RENAME LAYER ----
,
RENAME_MIRA as ( SELECT 
			
			UNIQUE_ID_KEY AS UNIQUE_ID_KEY,EXTRACT_DATE AS EXTRACT_DATE,QRTR_YEAR AS QRTR_YEAR,CLAIM_NMBR AS CLAIM_NMBR,INJRY_DATE AS INJRY_DATE,INJRY_YEAR AS INJRY_YEAR,PLCY_NMBR AS PLCY_NMBR,MANUAL_CLASS_NMBR AS MANUAL_CLASS_NMBR,PRDCT_STS_CODE AS PRDCT_STS_CODE,INJRY_TYPE_CODE AS INJRY_TYPE_CODE,EMPLY_TYPE_CODE AS EMPLY_TYPE_CODE,CVRG_TYPE_CODE AS CVRG_TYPE_CODE,PLCY_TYPE_CODE AS PLCY_TYPE_CODE,CLAIM_CTGRY_CODE AS CLAIM_CTGRY_CODE,ACDNT_TYPE_CODE AS ACDNT_TYPE_CODE,INJRY_SVRTY_CODE AS INJRY_SVRTY_CODE,CLAIM_STS_CODE AS CLAIM_STS_CODE,PRMRY_ICD_CODE AS PRMRY_ICD_CODE,SELF_INSRD_IND AS SELF_INSRD_IND,STOP_CNDTN_IND AS STOP_CNDTN_IND,FATAL_INJRY_IND AS FATAL_INJRY_IND,CLAIM_INCTV_IND AS CLAIM_INCTV_IND,CLAIM_CLSD_IND AS CLAIM_CLSD_IND,C92_APLCT_STS_CODE AS C92_APLCT_STS_CODE,C92_APLCT_ALWD_DATE AS C92_APLCT_ALWD_DATE,C92_APLCT_DSLWD_DATE AS C92_APLCT_DSLWD_DATE,CO_PAID_WEEK_QTY AS CO_PAID_WEEK_QTY,FLNG_DATE AS FLNG_DATE,ESTMT_RTW_DATE AS ESTMT_RTW_DATE,RTW_DATE AS RTW_DATE,DTH_DATE AS DTH_DATE,REHAB_START_DATE AS REHAB_START_DATE,MMI_DATE AS MMI_DATE,CLAIM_FIRST_DCSN_DATE AS CLAIM_FIRST_DCSN_DATE,LAST_CMPNS_PAID_DATE AS LAST_CMPNS_PAID_DATE,LAST_CMPNS_STOP_DATE AS LAST_CMPNS_STOP_DATE,LAST_DPNDN_BNFT_PAID_DATE AS LAST_DPNDN_BNFT_PAID_DATE,LAST_DTH_BNFT_PAY_DATE AS LAST_DTH_BNFT_PAY_DATE,LAST_DTH_BNFT_STOP_DATE AS LAST_DTH_BNFT_STOP_DATE,LAST_LM_PAID_DATE AS LAST_LM_PAID_DATE,LAST_LM_STOP_DATE AS LAST_LM_STOP_DATE,LAST_FD_PAID_DATE AS LAST_FD_PAID_DATE,LAST_FD_STOP_DATE AS LAST_FD_STOP_DATE,LAST_PP_STOP_DATE AS LAST_PP_STOP_DATE,LAST_PRCNT_PP_PAID_DATE AS LAST_PRCNT_PP_PAID_DATE,LAST_CO_STOP_DATE AS LAST_CO_STOP_DATE,LAST_WL_STOP_DATE AS LAST_WL_STOP_DATE,LAST_TT_PAID_DATE AS LAST_TT_PAID_DATE,LAST_TT_STOP_DATE AS LAST_TT_STOP_DATE,LAST_TP_STOP_DATE AS LAST_TP_STOP_DATE,LAST_MDCL_SRVC_DATE AS LAST_MDCL_SRVC_DATE,LAST_MDCL_PAID_DATE AS LAST_MDCL_PAID_DATE,LAST_PRDCNT_DATE AS LAST_PRDCNT_DATE,TOTAL_INCRD_AMT AS TOTAL_INCRD_AMT,TOTAL_PAID_AMT AS TOTAL_PAID_AMT,TOTAL_ORGNL_RSRV_AMT AS TOTAL_ORGNL_RSRV_AMT,TOTAL_ADJST_RSRV_AMNT AS TOTAL_ADJST_RSRV_AMNT,TOTAL_PBLSH_RSRV_AMT AS TOTAL_PBLSH_RSRV_AMT,TOTAL_INDMN_PAID_AMT AS TOTAL_INDMN_PAID_AMT,DTH_BNFT_INCRD_AMT AS DTH_BNFT_INCRD_AMT,DTH_BNFT_PAID_AMT AS DTH_BNFT_PAID_AMT,DTH_BNFT_ORGNL_RSRV_AMT AS DTH_BNFT_ORGNL_RSRV_AMT,DTH_BNFT_ADJST_RSRV_AMNT AS DTH_BNFT_ADJST_RSRV_AMNT,DTH_BNFT_PRDCT_IND AS DTH_BNFT_PRDCT_IND,LM_INCRD_AMT AS LM_INCRD_AMT,LM_PAID_AMT AS LM_PAID_AMT,LM_ORGNL_RSRV_AMT AS LM_ORGNL_RSRV_AMT,LM_ADJST_RSRV_AMNT AS LM_ADJST_RSRV_AMNT,LM_PRDCT_IND AS LM_PRDCT_IND,MDCL_INCRD_AMT AS MDCL_INCRD_AMT,MDCL_PAID_AMT AS MDCL_PAID_AMT,MDCL_ORGNL_RSRV_AMT AS MDCL_ORGNL_RSRV_AMT,MDCL_ADJST_RSRV_AMNT AS MDCL_ADJST_RSRV_AMNT,MDCL_PRDCT_IND AS MDCL_PRDCT_IND,PT_INCRD_AMT AS PT_INCRD_AMT,PT_PAID_AMT AS PT_PAID_AMT,PT_ORGNL_RSRV_AMT AS PT_ORGNL_RSRV_AMT,PT_ADJST_RSRV_AMNT AS PT_ADJST_RSRV_AMNT,PT_PRDCT_IND AS PT_PRDCT_IND,FD_INCRD_AMT AS FD_INCRD_AMT,FD_PAID_AMT AS FD_PAID_AMT,FD_ORGNL_RSRV_AMT AS FD_ORGNL_RSRV_AMT,FD_ADJST_RSRV_AMNT AS FD_ADJST_RSRV_AMNT,FD_PRDCT_IND AS FD_PRDCT_IND,CO_INCRD_AMT AS CO_INCRD_AMT,CO_PAID_AMT AS CO_PAID_AMT,CO_ORGNL_RSRV_AMT AS CO_ORGNL_RSRV_AMT,CO_ADJST_RSRV_AMNT AS CO_ADJST_RSRV_AMNT,CO_PRDCT_IND AS CO_PRDCT_IND,SUM_PP_PRCNT_PP_INCRD_AMT AS SUM_PP_PRCNT_PP_INCRD_AMT,SUM_PP_PRCNT_PP_PAID_AMT AS SUM_PP_PRCNT_PP_PAID_AMT,SUM_PP_PRCNT_PP_ORGNL_RSRV_AMT AS SUM_PP_PRCNT_PP_ORGNL_RSRV_AMT,SUM_PP_PRCNT_PP_ADJST_RSRV_AMNT AS SUM_PP_PRCNT_PP_ADJST_RSRV_AMNT,PP_PRCNT_PP_PRDCT_IND AS PP_PRCNT_PP_PRDCT_IND,SUM_TP_TT_WG_INCRD_AMT AS SUM_TP_TT_WG_INCRD_AMT,SUM_TP_TT_WG_PAID_AMT AS SUM_TP_TT_WG_PAID_AMT,SUM_TP_TT_WG_ORGNL_RSRV_AMT AS SUM_TP_TT_WG_ORGNL_RSRV_AMT,SUM_TP_TT_WG_ADJST_RSRV_AMNT AS SUM_TP_TT_WG_ADJST_RSRV_AMNT,TP_TT_WL_PRDCT_IND AS TP_TT_WL_PRDCT_IND,OIG_INCRD_AMT AS OIG_INCRD_AMT,OIG_PAID_AMT AS OIG_PAID_AMT,OIG_ORGNL_RSRV_AMT AS OIG_ORGNL_RSRV_AMT,OIG_ADJST_RSRV_AMNT AS OIG_ADJST_RSRV_AMNT,SLRY_CNTNT_AMT AS SLRY_CNTNT_AMT,SLRY_CNTNT_RDCTN_AMT AS SLRY_CNTNT_RDCTN_AMT,SLRY_CNTNT_LM_RDCTN_AMT AS SLRY_CNTNT_LM_RDCTN_AMT,SLRY_CNTNT_OTH_LM_RDCTN_AMT AS SLRY_CNTNT_OTH_LM_RDCTN_AMT,MDCL_RDCTN_AMT AS MDCL_RDCTN_AMT,LM_LMWL_RDCTN_AMT AS LM_LMWL_RDCTN_AMT,LUMP_SUM_STLMN_AMT AS LUMP_SUM_STLMN_AMT,PP_PRCNT_PP_PAID_AMT AS PP_PRCNT_PP_PAID_AMT,DPNDN_QTY AS DPNDN_QTY,CRT_DTTM AS CRT_DTTM,CRT_PRGRM_NAME AS CRT_PRGRM_NAME 
			from      LOGIC_MIRA
        )
----FILTER LAYER(uses aliases)----
,

        FILTER_MIRA as ( SELECT  * 
			from     RENAME_MIRA 
            
        )
----JOIN LAYER----
,
 JOIN_MIRA as ( SELECT * 
			from  FILTER_MIRA )
 SELECT * FROM JOIN_MIRA