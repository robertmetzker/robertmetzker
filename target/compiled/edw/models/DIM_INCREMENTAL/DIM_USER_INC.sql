-- depends_on: EDW_STAGING_DIM.DIM_REVENUE_CENTER











WITH diff as (
select
    PRIMARY_SOURCE_SYSTEM, 
    SUPERVISOR_FIRST_NAME, 
    SUPERVISOR_LAST_NAME, 
    SUPERVISOR_MIDDLE_NAME, 
    UNIQUE_ID_KEY, 
    USER_EMAIL, 
    USER_FIRST_NAME, 
    USER_LAST_NAME, 
    USER_LOGIN_NAME, 
    USER_MIDDLE_NAME, 
    USER_PHONE_NUMBER, 
    USER_PHONE_NUMBER_EXTENSION, 
    USER_ROLE, 
    USER_TYPE
    from  EDW_STAGING_DIM.DIM_USER 
minus
select 
    PRIMARY_SOURCE_SYSTEM, 
    SUPERVISOR_FIRST_NAME, 
    SUPERVISOR_LAST_NAME, 
    SUPERVISOR_MIDDLE_NAME, 
    UNIQUE_ID_KEY, 
    USER_EMAIL, 
    USER_FIRST_NAME, 
    USER_LAST_NAME, 
    USER_LOGIN_NAME, 
    USER_MIDDLE_NAME, 
    USER_PHONE_NUMBER, 
    USER_PHONE_NUMBER_EXTENSION, 
    USER_ROLE, 
    USER_TYPE
    from DEV_EDW_32600145.DIM_INCREMENTAL.DIM_USER_INC 
),
src as ( select * from EDW_STAGING_DIM.DIM_USER )
select src.* from src
inner join diff on ( diff.UNIQUE_ID_KEY = src.UNIQUE_ID_KEY )