-- depends_on: EDW_STAGING_DIM.DIM_ICD











WITH diff as (
select
    ASSIGN_ICD_TO_FIELD_IND, 
    AUTHORIZED_BILL_USE_IND, 
    AUTHORIZED_CLAIM_USE_IND, 
    BWC_GENERIC_BODY_PART_DESC, 
    BWC_INJURY_CLASS_DESC, 
    BWC_SPECIFIC_BODY_PART_DESC, 
    CATASTROPHIC_ICD_IND, 
    CMS_PROHIBITED_IND, 
    CURRENT_RECORD_IND, 
    EM_REFERRAL_CODE, 
    EM_REFERRAL_DESC, 
    ENCODER_VALIDATION_REQUIRED_IND, 
    GENDER_SPECIFIC_CODE, 
    GENDER_SPECIFIC_DESC, 
    ICD_ACP_ELIGIBILE_IND, 
    ICD_CODE, 
    ICD_CODE_CHAPTER_NUMBER, 
    ICD_CODE_CHAPTER_NUMBER_LONG_DESC, 
    ICD_CODE_CHAPTER_NUMBER_SHORT_DESC, 
    ICD_CODE_LONG_DESC, 
    ICD_CODE_SHORT_DESC, 
    ICD_CODE_STATUS_CODE, 
    ICD_CODE_STATUS_DESC, 
    ICD_CODE_STATUS_EFFECTIVE_DATE, 
    ICD_CODE_STATUS_END_DATE, 
    ICD_CODE_VERSION_NUMBER, 
    ICD_LOCATION_REQUIRED_IND, 
    ICD_POTENTIAL_SEVERE_COMPLICATIONS_IND, 
    ICD_PRIOR_AUTHORIZATION_REQUIRED_IND, 
    ICD_PRIVACY_IND, 
    ICD_PSYCHOLOGICAL_IND, 
    ICD_SECURITY_AUTHORIZATION_IND, 
    ICD_SITE_REQUIRED_IND, 
    ICD_STATUTORY_OCCUPATIONAL_DISEASE_IND, 
    ICD_SUBROGATION_REVIEW_IND, 
    PRIMARY_SOURCE_SYSTEM, 
    UNIQUE_ID_KEY
    from  EDW_STAGING_DIM.DIM_ICD 
where current_record_ind = 'Y'
minus
select 
    ASSIGN_ICD_TO_FIELD_IND, 
    AUTHORIZED_BILL_USE_IND, 
    AUTHORIZED_CLAIM_USE_IND, 
    BWC_GENERIC_BODY_PART_DESC, 
    BWC_INJURY_CLASS_DESC, 
    BWC_SPECIFIC_BODY_PART_DESC, 
    CATASTROPHIC_ICD_IND, 
    CMS_PROHIBITED_IND, 
    CURRENT_RECORD_IND, 
    EM_REFERRAL_CODE, 
    EM_REFERRAL_DESC, 
    ENCODER_VALIDATION_REQUIRED_IND, 
    GENDER_SPECIFIC_CODE, 
    GENDER_SPECIFIC_DESC, 
    ICD_ACP_ELIGIBILE_IND, 
    ICD_CODE, 
    ICD_CODE_CHAPTER_NUMBER, 
    ICD_CODE_CHAPTER_NUMBER_LONG_DESC, 
    ICD_CODE_CHAPTER_NUMBER_SHORT_DESC, 
    ICD_CODE_LONG_DESC, 
    ICD_CODE_SHORT_DESC, 
    ICD_CODE_STATUS_CODE, 
    ICD_CODE_STATUS_DESC, 
    ICD_CODE_STATUS_EFFECTIVE_DATE, 
    ICD_CODE_STATUS_END_DATE, 
    ICD_CODE_VERSION_NUMBER, 
    ICD_LOCATION_REQUIRED_IND, 
    ICD_POTENTIAL_SEVERE_COMPLICATIONS_IND, 
    ICD_PRIOR_AUTHORIZATION_REQUIRED_IND, 
    ICD_PRIVACY_IND, 
    ICD_PSYCHOLOGICAL_IND, 
    ICD_SECURITY_AUTHORIZATION_IND, 
    ICD_SITE_REQUIRED_IND, 
    ICD_STATUTORY_OCCUPATIONAL_DISEASE_IND, 
    ICD_SUBROGATION_REVIEW_IND, 
    PRIMARY_SOURCE_SYSTEM, 
    UNIQUE_ID_KEY
    from DEV_EDW_32600145.DIM_INCREMENTAL.DIM_ICD_INC 
where current_record_ind = 'Y'
),
src as ( select * from EDW_STAGING_DIM.DIM_ICD )
select src.* from src
inner join diff on ( diff.UNIQUE_ID_KEY = src.UNIQUE_ID_KEY )