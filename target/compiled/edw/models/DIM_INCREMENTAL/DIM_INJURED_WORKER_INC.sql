-- depends_on: EDW_STAGING_DIM.DIM_INJURED_WORKER











WITH diff as (
select
    BIRTH_DATE, 
    COURTESY_TITLE_NAME, 
    CURRENT_RECORD_IND, 
    CUSTOMER_NUMBER, 
    DEATH_DATE, 
    DOCUMENT_BLOCK_IND, 
    FIRST_NAME, 
    FOREIGN_CITIZEN_IND, 
    FULL_NAME, 
    GENDER_TYPE_CODE, 
    GENDER_TYPE_DESC, 
    LAST_NAME, 
    MAILING_ADDRESS_CITY_NAME, 
    MAILING_ADDRESS_COMMENT_TEXT, 
    MAILING_ADDRESS_COUNTRY_NAME, 
    MAILING_ADDRESS_COUNTY_NAME, 
    MAILING_ADDRESS_POSTAL_CODE, 
    MAILING_ADDRESS_STATE_CODE, 
    MAILING_ADDRESS_STATE_NAME, 
    MAILING_ADDRESS_VALIDATED_IND, 
    MAILING_FORMATTED_ADDRESS_POSTAL_CODE, 
    MAILING_FORMATTED_ADDRESS_ZIP4_CODE, 
    MAILING_FORMATTED_ADDRESS_ZIP_CODE, 
    MAILING_STREET_ADDRESS_1, 
    MAILING_STREET_ADDRESS_2, 
    MARITAL_STATUS_TYPE_DESC, 
    MIDDLE_NAME, 
    PARTICIPATION_TYPE_CODE, 
    PARTICIPATION_TYPE_DESC, 
    PHYSICAL_ADDRESS_CITY_NAME, 
    PHYSICAL_ADDRESS_COMMENT_TEXT, 
    PHYSICAL_ADDRESS_COUNTRY_NAME, 
    PHYSICAL_ADDRESS_COUNTY_NAME, 
    PHYSICAL_ADDRESS_POSTAL_CODE, 
    PHYSICAL_ADDRESS_STATE_CODE, 
    PHYSICAL_ADDRESS_STATE_NAME, 
    PHYSICAL_ADDRESS_VALIDATED_IND, 
    PHYSICAL_FORMATTED_ADDRESS_POSTAL_CODE, 
    PHYSICAL_FORMATTED_ADDRESS_ZIP4_CODE, 
    PHYSICAL_FORMATTED_ADDRESS_ZIP_CODE, 
    PHYSICAL_STREET_ADDRESS_1, 
    PHYSICAL_STREET_ADDRESS_2, 
    PRIMARY_LANGUAGE_TYPE_DESC, 
    PRIMARY_SOURCE_SYSTEM, 
    RETIREMENT_DATE, 
    SUFFIX_NAME, 
    THREATENING_BEHAVIOR_BLOCK_IND, 
    UNIQUE_ID_KEY
    from  EDW_STAGING_DIM.DIM_INJURED_WORKER 
where current_record_ind = 'Y'
minus
select 
    BIRTH_DATE, 
    COURTESY_TITLE_NAME, 
    CURRENT_RECORD_IND, 
    CUSTOMER_NUMBER, 
    DEATH_DATE, 
    DOCUMENT_BLOCK_IND, 
    FIRST_NAME, 
    FOREIGN_CITIZEN_IND, 
    FULL_NAME, 
    GENDER_TYPE_CODE, 
    GENDER_TYPE_DESC, 
    LAST_NAME, 
    MAILING_ADDRESS_CITY_NAME, 
    MAILING_ADDRESS_COMMENT_TEXT, 
    MAILING_ADDRESS_COUNTRY_NAME, 
    MAILING_ADDRESS_COUNTY_NAME, 
    MAILING_ADDRESS_POSTAL_CODE, 
    MAILING_ADDRESS_STATE_CODE, 
    MAILING_ADDRESS_STATE_NAME, 
    MAILING_ADDRESS_VALIDATED_IND, 
    MAILING_FORMATTED_ADDRESS_POSTAL_CODE, 
    MAILING_FORMATTED_ADDRESS_ZIP4_CODE, 
    MAILING_FORMATTED_ADDRESS_ZIP_CODE, 
    MAILING_STREET_ADDRESS_1, 
    MAILING_STREET_ADDRESS_2, 
    MARITAL_STATUS_TYPE_DESC, 
    MIDDLE_NAME, 
    PARTICIPATION_TYPE_CODE, 
    PARTICIPATION_TYPE_DESC, 
    PHYSICAL_ADDRESS_CITY_NAME, 
    PHYSICAL_ADDRESS_COMMENT_TEXT, 
    PHYSICAL_ADDRESS_COUNTRY_NAME, 
    PHYSICAL_ADDRESS_COUNTY_NAME, 
    PHYSICAL_ADDRESS_POSTAL_CODE, 
    PHYSICAL_ADDRESS_STATE_CODE, 
    PHYSICAL_ADDRESS_STATE_NAME, 
    PHYSICAL_ADDRESS_VALIDATED_IND, 
    PHYSICAL_FORMATTED_ADDRESS_POSTAL_CODE, 
    PHYSICAL_FORMATTED_ADDRESS_ZIP4_CODE, 
    PHYSICAL_FORMATTED_ADDRESS_ZIP_CODE, 
    PHYSICAL_STREET_ADDRESS_1, 
    PHYSICAL_STREET_ADDRESS_2, 
    PRIMARY_LANGUAGE_TYPE_DESC, 
    PRIMARY_SOURCE_SYSTEM, 
    RETIREMENT_DATE, 
    SUFFIX_NAME, 
    THREATENING_BEHAVIOR_BLOCK_IND, 
    UNIQUE_ID_KEY
    from DEV_EDW_32600145.DIM_INCREMENTAL.DIM_INJURED_WORKER_INC 
where current_record_ind = 'Y'
),
src as ( select * from EDW_STAGING_DIM.DIM_INJURED_WORKER )
select src.* from src
inner join diff on ( diff.unique_id_key = src.unique_id_key )