-- depends_on: EDW_STAGING_DIM.DIM_NDC











WITH diff as (
select
    ACTIVE_DRUG_STRENGTH_QUANTITY, 
    AED_CONVERSION_FACTOR, 
    BWC_FORMULARY_COVERAGE_CODE, 
    BWC_FORMULARY_COVERAGE_DESC, 
    BWC_FORMULARY_COVERAGE_LIMITATION_DESC, 
    BWC_FORMULARY_PRIOR_AUTHORIZATION_IND, 
    CURRENT_AWP_DRUG_AMOUNT, 
    CURRENT_RECORD_IND, 
    DEA_DRUG_SCHEDULE_CODE, 
    DEA_DRUG_SCHEDULE_DESC, 
    DOSAGE_FORM_CODE, 
    DOSAGE_FORM_DESC, 
    DRUG_STRENGTH_CODE, 
    GPI_10_DRUG_NAME_EXT_CODE, 
    GPI_10_DRUG_NAME_EXT_DESC, 
    GPI_12_DRUG_DOSAGE_FORM_CODE, 
    GPI_12_DRUG_DOSAGE_FORM_DESC, 
    GPI_14_CODE, 
    GPI_14_DESC, 
    GPI_2_GROUP_CODE, 
    GPI_2_GROUP_DESC, 
    GPI_4_CLASS_CODE, 
    GPI_4_CLASS_DESC, 
    GPI_6_SUBCLASS_CODE, 
    GPI_6_SUBCLASS_DESC, 
    GPI_8_DRUG_NAME_CODE, 
    GPI_8_DRUG_NAME_DESC, 
    GPI_EFFECTIVE_DATE, 
    GPI_END_DATE, 
    GPI_PAYMENT_CATEGORY_DESC, 
    MED_CONVERSION_FACTOR, 
    MILLIGRAMS_EQUIVALENCE_PER_UNIT, 
    NDC_11_CODE, 
    NDC_11_FORMATTED_CODE, 
    NDC_2_PACKAGE_CODE, 
    NDC_4_PRODUCT_CODE, 
    NDC_4_PRODUCT_DESC, 
    NDC_5_LABELER_CODE, 
    NDC_5_LABELER_NAME, 
    NDC_EFFECTIVE_DATE, 
    NDC_END_DATE, 
    NDC_VERSION_NUMBER, 
    OVER_THE_COUNTER_CODE, 
    OVER_THE_COUNTER_DESC, 
    PACKAGE_DOSE_CODE, 
    PACKAGE_DOSE_DESC, 
    PACKAGE_QTY, 
    PACKAGE_SIZE_QTY, 
    PACKAGE_SIZE_UNIT_OF_MEASURE_CODE, 
    PACKAGE_SIZE_UNIT_OF_MEASURE_DESC, 
    PACKAGE_TYPE_CODE, 
    PACKAGE_TYPE_DESC, 
    PRIMARY_SOURCE_SYSTEM, 
    ROUTE_OF_ADMINISTRATION_CODE, 
    ROUTE_OF_ADMINISTRATION_DESC, 
    STRENGTH_MEASURE_CODE, 
    UNIQUE_ID_KEY
    from  EDW_STAGING_DIM.DIM_NDC 
where current_record_ind = 'Y'
minus
select 
    ACTIVE_DRUG_STRENGTH_QUANTITY, 
    AED_CONVERSION_FACTOR, 
    BWC_FORMULARY_COVERAGE_CODE, 
    BWC_FORMULARY_COVERAGE_DESC, 
    BWC_FORMULARY_COVERAGE_LIMITATION_DESC, 
    BWC_FORMULARY_PRIOR_AUTHORIZATION_IND, 
    CURRENT_AWP_DRUG_AMOUNT, 
    CURRENT_RECORD_IND, 
    DEA_DRUG_SCHEDULE_CODE, 
    DEA_DRUG_SCHEDULE_DESC, 
    DOSAGE_FORM_CODE, 
    DOSAGE_FORM_DESC, 
    DRUG_STRENGTH_CODE, 
    GPI_10_DRUG_NAME_EXT_CODE, 
    GPI_10_DRUG_NAME_EXT_DESC, 
    GPI_12_DRUG_DOSAGE_FORM_CODE, 
    GPI_12_DRUG_DOSAGE_FORM_DESC, 
    GPI_14_CODE, 
    GPI_14_DESC, 
    GPI_2_GROUP_CODE, 
    GPI_2_GROUP_DESC, 
    GPI_4_CLASS_CODE, 
    GPI_4_CLASS_DESC, 
    GPI_6_SUBCLASS_CODE, 
    GPI_6_SUBCLASS_DESC, 
    GPI_8_DRUG_NAME_CODE, 
    GPI_8_DRUG_NAME_DESC, 
    GPI_EFFECTIVE_DATE, 
    GPI_END_DATE, 
    GPI_PAYMENT_CATEGORY_DESC, 
    MED_CONVERSION_FACTOR, 
    MILLIGRAMS_EQUIVALENCE_PER_UNIT, 
    NDC_11_CODE, 
    NDC_11_FORMATTED_CODE, 
    NDC_2_PACKAGE_CODE, 
    NDC_4_PRODUCT_CODE, 
    NDC_4_PRODUCT_DESC, 
    NDC_5_LABELER_CODE, 
    NDC_5_LABELER_NAME, 
    NDC_EFFECTIVE_DATE, 
    NDC_END_DATE, 
    NDC_VERSION_NUMBER, 
    OVER_THE_COUNTER_CODE, 
    OVER_THE_COUNTER_DESC, 
    PACKAGE_DOSE_CODE, 
    PACKAGE_DOSE_DESC, 
    PACKAGE_QTY, 
    PACKAGE_SIZE_QTY, 
    PACKAGE_SIZE_UNIT_OF_MEASURE_CODE, 
    PACKAGE_SIZE_UNIT_OF_MEASURE_DESC, 
    PACKAGE_TYPE_CODE, 
    PACKAGE_TYPE_DESC, 
    PRIMARY_SOURCE_SYSTEM, 
    ROUTE_OF_ADMINISTRATION_CODE, 
    ROUTE_OF_ADMINISTRATION_DESC, 
    STRENGTH_MEASURE_CODE, 
    UNIQUE_ID_KEY
    from DEV_EDW_32600145.DIM_INCREMENTAL.DIM_NDC_INC 
where current_record_ind = 'Y'
),
src as ( select * from EDW_STAGING_DIM.DIM_NDC )
select src.* from src
inner join diff on ( diff.UNIQUE_ID_KEY = src.UNIQUE_ID_KEY )