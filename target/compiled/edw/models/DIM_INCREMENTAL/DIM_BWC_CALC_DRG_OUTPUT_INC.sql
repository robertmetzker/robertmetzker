-- depends_on: EDW_STAGING_DIM.DIM_BWC_CALC_DRG_OUTPUT











WITH diff as (
select
    DATE_SENT, 
    DIAGNOSIS_CODE_1, 
    DIAGNOSIS_CODE_2, 
    DIAGNOSIS_CODE_3, 
    DIAGNOSIS_CODE_4, 
    DIAGNOSIS_CODE_5, 
    DIAGNOSIS_DESC_1, 
    DIAGNOSIS_DESC_2, 
    DIAGNOSIS_DESC_3, 
    DIAGNOSIS_DESC_4, 
    DIAGNOSIS_DESC_5, 
    DIAGNOSIS_RELATED_GROUP_CODE, 
    DIAGNOSIS_RELATED_GROUP_TITLE, 
    GROUPER_METHOD, 
    GROUPER_VERSION, 
    MAJOR_CATEGORY, 
    MAJOR_TITLE, 
    MEDICAL_INVOICE_NUMBER, 
    NON_OR_PROCEDURE_CODE_1, 
    NON_OR_PROCEDURE_CODE_2, 
    NON_OR_PROCEDURE_CODE_3, 
    NON_OR_PROCEDURE_CODE_4, 
    NON_OR_PROCEDURE_CODE_5, 
    NON_OR_PROCEDURE_DESC_1, 
    NON_OR_PROCEDURE_DESC_2, 
    NON_OR_PROCEDURE_DESC_3, 
    NON_OR_PROCEDURE_DESC_4, 
    NON_OR_PROCEDURE_DESC_5, 
    OR_PROCEDURE_CODE_1, 
    OR_PROCEDURE_CODE_2, 
    OR_PROCEDURE_CODE_3, 
    OR_PROCEDURE_CODE_4, 
    OR_PROCEDURE_CODE_5, 
    OR_PROCEDURE_DESC_1, 
    OR_PROCEDURE_DESC_2, 
    OR_PROCEDURE_DESC_3, 
    OR_PROCEDURE_DESC_4, 
    OR_PROCEDURE_DESC_5, 
    PRICER_VERSION, 
    PRIMARY_SOURCE_SYSTEM, 
    RETURN_CODE, 
    RETURN_EXTENSION, 
    RETURN_MESSAGE, 
    UNIQUE_ID_KEY
    from  EDW_STAGING_DIM.DIM_BWC_CALC_DRG_OUTPUT 
minus
select 
    DATE_SENT, 
    DIAGNOSIS_CODE_1, 
    DIAGNOSIS_CODE_2, 
    DIAGNOSIS_CODE_3, 
    DIAGNOSIS_CODE_4, 
    DIAGNOSIS_CODE_5, 
    DIAGNOSIS_DESC_1, 
    DIAGNOSIS_DESC_2, 
    DIAGNOSIS_DESC_3, 
    DIAGNOSIS_DESC_4, 
    DIAGNOSIS_DESC_5, 
    DIAGNOSIS_RELATED_GROUP_CODE, 
    DIAGNOSIS_RELATED_GROUP_TITLE, 
    GROUPER_METHOD, 
    GROUPER_VERSION, 
    MAJOR_CATEGORY, 
    MAJOR_TITLE, 
    MEDICAL_INVOICE_NUMBER, 
    NON_OR_PROCEDURE_CODE_1, 
    NON_OR_PROCEDURE_CODE_2, 
    NON_OR_PROCEDURE_CODE_3, 
    NON_OR_PROCEDURE_CODE_4, 
    NON_OR_PROCEDURE_CODE_5, 
    NON_OR_PROCEDURE_DESC_1, 
    NON_OR_PROCEDURE_DESC_2, 
    NON_OR_PROCEDURE_DESC_3, 
    NON_OR_PROCEDURE_DESC_4, 
    NON_OR_PROCEDURE_DESC_5, 
    OR_PROCEDURE_CODE_1, 
    OR_PROCEDURE_CODE_2, 
    OR_PROCEDURE_CODE_3, 
    OR_PROCEDURE_CODE_4, 
    OR_PROCEDURE_CODE_5, 
    OR_PROCEDURE_DESC_1, 
    OR_PROCEDURE_DESC_2, 
    OR_PROCEDURE_DESC_3, 
    OR_PROCEDURE_DESC_4, 
    OR_PROCEDURE_DESC_5, 
    PRICER_VERSION, 
    PRIMARY_SOURCE_SYSTEM, 
    RETURN_CODE, 
    RETURN_EXTENSION, 
    RETURN_MESSAGE, 
    UNIQUE_ID_KEY
    from DEV_EDW_32600145.DIM_INCREMENTAL.DIM_BWC_CALC_DRG_OUTPUT_INC 
),
src as ( select * from EDW_STAGING_DIM.DIM_BWC_CALC_DRG_OUTPUT )
select src.* from src
inner join diff on ( diff.UNIQUE_ID_KEY = src.UNIQUE_ID_KEY )