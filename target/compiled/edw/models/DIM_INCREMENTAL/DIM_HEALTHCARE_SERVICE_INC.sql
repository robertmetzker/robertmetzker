-- depends_on: EDW_STAGING_DIM.DIM_HEALTHCARE_SERVICE











WITH diff as (
select
    CODE, 
    CODE_DESC, 
    CURRENT_RECORD_IND, 
    FEE_SCHEDULE_DESC, 
    GPI_4_CLASS_CODE, 
    GPI_4_CLASS_DESC, 
    PAYMENT_CATEGORY, 
    PRIMARY_SOURCE_SYSTEM, 
    PROCEDURE_CODE_EFFECTIVE_DATE, 
    PROCEDURE_CODE_END_DATE, 
    PROCEDURE_CODE_ENTRY_DATE, 
    SERVICE_CODE_TYPE, 
    UNIQUE_ID_KEY
    from  EDW_STAGING_DIM.DIM_HEALTHCARE_SERVICE 
where current_record_ind = 'Y'
minus
select 
    CODE, 
    CODE_DESC, 
    CURRENT_RECORD_IND, 
    FEE_SCHEDULE_DESC, 
    GPI_4_CLASS_CODE, 
    GPI_4_CLASS_DESC, 
    PAYMENT_CATEGORY, 
    PRIMARY_SOURCE_SYSTEM, 
    PROCEDURE_CODE_EFFECTIVE_DATE, 
    PROCEDURE_CODE_END_DATE, 
    PROCEDURE_CODE_ENTRY_DATE, 
    SERVICE_CODE_TYPE, 
    UNIQUE_ID_KEY
    from DEV_EDW_32600145.DIM_INCREMENTAL.DIM_HEALTHCARE_SERVICE_INC 
where current_record_ind = 'Y'
),
src as ( select * from EDW_STAGING_DIM.DIM_HEALTHCARE_SERVICE )
select src.* from src
inner join diff on ( diff.UNIQUE_ID_KEY = src.UNIQUE_ID_KEY )