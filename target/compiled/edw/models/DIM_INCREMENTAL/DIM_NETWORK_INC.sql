-- depends_on: EDW_STAGING_DIM.DIM_NETWORK











WITH diff as (
select
    CORESUITE_CUSTOMER_NUMBER, 
    CURRENT_ACQUIRING_MCO_NAME, 
    CURRENT_ACQUIRING_MCO_NUMBER, 
    CURRENT_RECORD_IND, 
    MCO_ACQUISITION_PATH, 
    MCO_CLOSE_BUSINESS_DATE, 
    NETWORK_CERTIFICATION_EFFECTIVE_DATE, 
    NETWORK_CERTIFICATION_END_DATE, 
    NETWORK_CERTIFICATION_STATUS_CODE, 
    NETWORK_CERTIFICATION_STATUS_DESC, 
    NETWORK_FINANCIAL_ADDRESS_CITY_NAME, 
    NETWORK_FINANCIAL_ADDRESS_STATE_CODE, 
    NETWORK_FINANCIAL_ADDRESS_ZIP4_CODE, 
    NETWORK_FINANCIAL_ADDRESS_ZIP_CODE, 
    NETWORK_FINANCIAL_STREET_ADDRESS_1, 
    NETWORK_FINANCIAL_STREET_ADDRESS_2, 
    NETWORK_MAILING_ADDRESS_CITY_NAME, 
    NETWORK_MAILING_ADDRESS_STATE_CODE, 
    NETWORK_MAILING_ADDRESS_ZIP4_CODE, 
    NETWORK_MAILING_ADDRESS_ZIP_CODE, 
    NETWORK_MAILING_STREET_ADDRESS_1, 
    NETWORK_MAILING_STREET_ADDRESS_2, 
    NETWORK_NAME, 
    NETWORK_NUMBER, 
    NETWORK_PHYSICAL_ADDRESS_CITY_NAME, 
    NETWORK_PHYSICAL_ADDRESS_STATE_CODE, 
    NETWORK_PHYSICAL_ADDRESS_ZIP4_CODE, 
    NETWORK_PHYSICAL_ADDRESS_ZIP_CODE, 
    NETWORK_PHYSICAL_STREET_ADDRESS_1, 
    NETWORK_PHYSICAL_STREET_ADDRESS_2, 
    NETWORK_TYPE_CODE, 
    NETWORK_TYPE_DESC, 
    PRIMARY_SOURCE_SYSTEM, 
    UNIQUE_ID_KEY
    from  EDW_STAGING_DIM.DIM_NETWORK 
where current_record_ind = 'Y'
minus
select 
    CORESUITE_CUSTOMER_NUMBER, 
    CURRENT_ACQUIRING_MCO_NAME, 
    CURRENT_ACQUIRING_MCO_NUMBER, 
    CURRENT_RECORD_IND, 
    MCO_ACQUISITION_PATH, 
    MCO_CLOSE_BUSINESS_DATE, 
    NETWORK_CERTIFICATION_EFFECTIVE_DATE, 
    NETWORK_CERTIFICATION_END_DATE, 
    NETWORK_CERTIFICATION_STATUS_CODE, 
    NETWORK_CERTIFICATION_STATUS_DESC, 
    NETWORK_FINANCIAL_ADDRESS_CITY_NAME, 
    NETWORK_FINANCIAL_ADDRESS_STATE_CODE, 
    NETWORK_FINANCIAL_ADDRESS_ZIP4_CODE, 
    NETWORK_FINANCIAL_ADDRESS_ZIP_CODE, 
    NETWORK_FINANCIAL_STREET_ADDRESS_1, 
    NETWORK_FINANCIAL_STREET_ADDRESS_2, 
    NETWORK_MAILING_ADDRESS_CITY_NAME, 
    NETWORK_MAILING_ADDRESS_STATE_CODE, 
    NETWORK_MAILING_ADDRESS_ZIP4_CODE, 
    NETWORK_MAILING_ADDRESS_ZIP_CODE, 
    NETWORK_MAILING_STREET_ADDRESS_1, 
    NETWORK_MAILING_STREET_ADDRESS_2, 
    NETWORK_NAME, 
    NETWORK_NUMBER, 
    NETWORK_PHYSICAL_ADDRESS_CITY_NAME, 
    NETWORK_PHYSICAL_ADDRESS_STATE_CODE, 
    NETWORK_PHYSICAL_ADDRESS_ZIP4_CODE, 
    NETWORK_PHYSICAL_ADDRESS_ZIP_CODE, 
    NETWORK_PHYSICAL_STREET_ADDRESS_1, 
    NETWORK_PHYSICAL_STREET_ADDRESS_2, 
    NETWORK_TYPE_CODE, 
    NETWORK_TYPE_DESC, 
    PRIMARY_SOURCE_SYSTEM, 
    UNIQUE_ID_KEY
    from DEV_EDW_32600145.DIM_INCREMENTAL.DIM_NETWORK_INC 
where current_record_ind = 'Y'
),
src as ( select * from EDW_STAGING_DIM.DIM_NETWORK )
select src.* from src
inner join diff on ( diff.UNIQUE_ID_KEY = src.UNIQUE_ID_KEY )