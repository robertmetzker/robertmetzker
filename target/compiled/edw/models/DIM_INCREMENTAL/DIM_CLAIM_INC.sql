-- depends_on: EDW_STAGING_DIM.DIM_CLAIM











WITH diff as (
select
    ACCIDENT_DESCRIPTION_TEXT, 
    ACCIDENT_LOCATION_CITY, 
    ACCIDENT_LOCATION_COUNTRY, 
    ACCIDENT_LOCATION_COUNTY, 
    ACCIDENT_LOCATION_NAME, 
    ACCIDENT_LOCATION_POSTAL_CODE, 
    ACCIDENT_LOCATION_STATE, 
    ACCIDENT_LOCATION_STATE_CODE, 
    ACCIDENT_LOCATION_TEXT, 
    ACCIDENT_PREMISES_TEXT, 
    CATASTROPHIC_IND, 
    CLAIM_NUMBER, 
    CLAIM_STATE_DESC, 
    CLAIM_STATUS_DESC, 
    CLAIM_STATUS_REASON_DESC, 
    COMBINED_IND, 
    COVID_EMERGENCY_WORKER_IND, 
    COVID_EXPOSURE_IND, 
    COVID_HEALTH_CARE_WORKER_IND, 
    CURRENT_CORESUITE_CLAIM_TYPE_CODE, 
    CURRENT_CORESUITE_CLAIM_TYPE_DESC, 
    EMPLOYER_PREMISES_IND, 
    FILING_MEDIA_DESC, 
    FILING_SOURCE_DESC, 
    FIREFIGHTER_CANCER_IND, 
    K_PROGRAM_END_DATE, 
    K_PROGRAM_ENROLLMENT_DESC, 
    K_PROGRAM_REASON_DESC, 
    K_PROGRAM_START_DATE, 
    K_PROGRAM_TYPE_DESC, 
    PRIMARY_SOURCE_SYSTEM, 
    SB223_IND, 
    UNIQUE_ID_KEY
    from  EDW_STAGING_DIM.DIM_CLAIM 
minus
select 
    ACCIDENT_DESCRIPTION_TEXT, 
    ACCIDENT_LOCATION_CITY, 
    ACCIDENT_LOCATION_COUNTRY, 
    ACCIDENT_LOCATION_COUNTY, 
    ACCIDENT_LOCATION_NAME, 
    ACCIDENT_LOCATION_POSTAL_CODE, 
    ACCIDENT_LOCATION_STATE, 
    ACCIDENT_LOCATION_STATE_CODE, 
    ACCIDENT_LOCATION_TEXT, 
    ACCIDENT_PREMISES_TEXT, 
    CATASTROPHIC_IND, 
    CLAIM_NUMBER, 
    CLAIM_STATE_DESC, 
    CLAIM_STATUS_DESC, 
    CLAIM_STATUS_REASON_DESC, 
    COMBINED_IND, 
    COVID_EMERGENCY_WORKER_IND, 
    COVID_EXPOSURE_IND, 
    COVID_HEALTH_CARE_WORKER_IND, 
    CURRENT_CORESUITE_CLAIM_TYPE_CODE, 
    CURRENT_CORESUITE_CLAIM_TYPE_DESC, 
    EMPLOYER_PREMISES_IND, 
    FILING_MEDIA_DESC, 
    FILING_SOURCE_DESC, 
    FIREFIGHTER_CANCER_IND, 
    K_PROGRAM_END_DATE, 
    K_PROGRAM_ENROLLMENT_DESC, 
    K_PROGRAM_REASON_DESC, 
    K_PROGRAM_START_DATE, 
    K_PROGRAM_TYPE_DESC, 
    PRIMARY_SOURCE_SYSTEM, 
    SB223_IND, 
    UNIQUE_ID_KEY
    from DEV_EDW_32600145.DIM_INCREMENTAL.DIM_CLAIM_INC 
),
src as ( select * from EDW_STAGING_DIM.DIM_CLAIM )
select src.* from src
inner join diff on ( diff.UNIQUE_ID_KEY = src.UNIQUE_ID_KEY )