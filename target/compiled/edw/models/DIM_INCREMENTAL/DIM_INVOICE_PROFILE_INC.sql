-- depends_on: EDW_STAGING_DIM.DIM_INVOICE_PROFILE











WITH diff as (
select
    ADJUSTMENT_TYPE, 
    INVOICE_FEE_SCHEDULE_DESC, 
    INVOICE_INPUT_METHOD_CODE, 
    INVOICE_INPUT_METHOD_DESC, 
    INVOICE_PAYMENT_CATEGORY, 
    IN_SUBROGATION_IND, 
    MEDICAL_INVOICE_TYPE_CODE, 
    PAID_ABOVE_ZERO_IND, 
    PRIMARY_SOURCE_SYSTEM, 
    SUBROGATION_TYPE_DESC, 
    UNIQUE_ID_KEY
    from  EDW_STAGING_DIM.DIM_INVOICE_PROFILE 
minus
select 
    ADJUSTMENT_TYPE, 
    INVOICE_FEE_SCHEDULE_DESC, 
    INVOICE_INPUT_METHOD_CODE, 
    INVOICE_INPUT_METHOD_DESC, 
    INVOICE_PAYMENT_CATEGORY, 
    IN_SUBROGATION_IND, 
    MEDICAL_INVOICE_TYPE_CODE, 
    PAID_ABOVE_ZERO_IND, 
    PRIMARY_SOURCE_SYSTEM, 
    SUBROGATION_TYPE_DESC, 
    UNIQUE_ID_KEY
    from DEV_EDW_32600145.DIM_INCREMENTAL.DIM_INVOICE_PROFILE_INC 
),
src as ( select * from EDW_STAGING_DIM.DIM_INVOICE_PROFILE )
select src.* from src
inner join diff on ( diff.UNIQUE_ID_KEY = src.UNIQUE_ID_KEY )