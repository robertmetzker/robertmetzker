-- depends_on: EDW_STAGING_DIM.DIM_PROVIDER











WITH diff as (
select
    CORRESPONDENCE_ADDRESS_CITY, 
    CORRESPONDENCE_ADDRESS_STATE_CODE, 
    CORRESPONDENCE_COUNTY_NAME, 
    CORRESPONDENCE_FULL_ZIP_CODE, 
    CORRESPONDENCE_STREET_ADDRESS_1, 
    CORRESPONDENCE_STREET_ADDRESS_2, 
    CORRESPONDENCE_ZIP_CODE_EXT, 
    CORRESPONDENCE_ZIP_CODE_NUMBER, 
    CRITICAL_ACCESS_IND, 
    CURRENT_CERTIFICATION_STATUS, 
    CURRENT_ENROLLMENT_STATUS, 
    CURRENT_RECORD_IND, 
    DEP_90_DAY_EXAM_IND, 
    DEP_ACTIVE_IND, 
    DEP_ADDITIONAL_LANGUAGE_IND, 
    DEP_ADMINISTRATIVE_AGENT_NAME, 
    DEP_ADR_FILE_REVIEW_IND, 
    DEP_ADR_IME_IND, 
    DEP_ASBESTOSIS_EXAM_IND, 
    DEP_B_READER_IND, 
    DEP_C92A_FILE_REVIEW_IND, 
    DEP_C92_EXAM_IND, 
    DEP_DM_IME_IND, 
    DEP_DUR_REVIEW_IND, 
    DEP_IME_IND, 
    DEP_MEDICAL_FILE_REVIEW_IND, 
    DEP_ONLINE_FILE_REVIEW_IND, 
    DEP_PRIOR_AUTHORIZATION_REVIEW_IND, 
    DEP_PULMONARY_EXAM_IND, 
    DEP_PULMONARY_REVIEW_IND, 
    DEP_SERVICE_CODE, 
    DEP_SERVICE_DESC, 
    DEP_STATUS_DESC, 
    MCO_MEDICAL_DIRECTOR_IND, 
    MEDICARE_NUMBER, 
    MEDICARE_NUMBER_STATE_CODE, 
    MEDICARE_PROVIDER_TYPE_CODE, 
    MEDICARE_PROVIDER_TYPE_DESC, 
    NEW_PATIENT_CODE, 
    NEW_PATIENT_DESC, 
    NPI_CONFIRMATION_IND, 
    NPI_NUMBER, 
    OPPS_QUALITY_IND, 
    OUT_OF_STATE_STATUS_DESC, 
    PEACH_BASE_NUMBER, 
    PEACH_FORMATTED_NUMBER, 
    PEACH_SUFFIX_NUMBER, 
    PRACTICE_ADDRESS_CITY, 
    PRACTICE_ADDRESS_STATE_CODE, 
    PRACTICE_COUNTY_NAME, 
    PRACTICE_FULL_ZIP_CODE, 
    PRACTICE_STREET_ADDRESS_1, 
    PRACTICE_STREET_ADDRESS_2, 
    PRACTICE_TYPE_DESC, 
    PRACTICE_ZIP_CODE_EXT, 
    PRACTICE_ZIP_CODE_NUMBER, 
    PRIMARY_SOURCE_SYSTEM, 
    PROGRAM_PARTICIPATION_PERIOD, 
    PROVIDER_CBSA_CODE, 
    PROVIDER_DBA_SORT_NAME, 
    PROVIDER_NAME, 
    PROVIDER_PEACH_NUMBER, 
    PROVIDER_PHONE_NUMBER, 
    PROVIDER_PROGRAM_CODE, 
    PROVIDER_PROGRAM_DESC, 
    PROVIDER_PROGRAM_FOCUS_TEXT, 
    PROVIDER_TYPE_CODE, 
    PROVIDER_TYPE_DESC, 
    UNIQUE_ID_KEY
    from  EDW_STAGING_DIM.DIM_PROVIDER 
where current_record_ind = 'Y'
minus
select 
    CORRESPONDENCE_ADDRESS_CITY, 
    CORRESPONDENCE_ADDRESS_STATE_CODE, 
    CORRESPONDENCE_COUNTY_NAME, 
    CORRESPONDENCE_FULL_ZIP_CODE, 
    CORRESPONDENCE_STREET_ADDRESS_1, 
    CORRESPONDENCE_STREET_ADDRESS_2, 
    CORRESPONDENCE_ZIP_CODE_EXT, 
    CORRESPONDENCE_ZIP_CODE_NUMBER, 
    CRITICAL_ACCESS_IND, 
    CURRENT_CERTIFICATION_STATUS, 
    CURRENT_ENROLLMENT_STATUS, 
    CURRENT_RECORD_IND, 
    DEP_90_DAY_EXAM_IND, 
    DEP_ACTIVE_IND, 
    DEP_ADDITIONAL_LANGUAGE_IND, 
    DEP_ADMINISTRATIVE_AGENT_NAME, 
    DEP_ADR_FILE_REVIEW_IND, 
    DEP_ADR_IME_IND, 
    DEP_ASBESTOSIS_EXAM_IND, 
    DEP_B_READER_IND, 
    DEP_C92A_FILE_REVIEW_IND, 
    DEP_C92_EXAM_IND, 
    DEP_DM_IME_IND, 
    DEP_DUR_REVIEW_IND, 
    DEP_IME_IND, 
    DEP_MEDICAL_FILE_REVIEW_IND, 
    DEP_ONLINE_FILE_REVIEW_IND, 
    DEP_PRIOR_AUTHORIZATION_REVIEW_IND, 
    DEP_PULMONARY_EXAM_IND, 
    DEP_PULMONARY_REVIEW_IND, 
    DEP_SERVICE_CODE, 
    DEP_SERVICE_DESC, 
    DEP_STATUS_DESC, 
    MCO_MEDICAL_DIRECTOR_IND, 
    MEDICARE_NUMBER, 
    MEDICARE_NUMBER_STATE_CODE, 
    MEDICARE_PROVIDER_TYPE_CODE, 
    MEDICARE_PROVIDER_TYPE_DESC, 
    NEW_PATIENT_CODE, 
    NEW_PATIENT_DESC, 
    NPI_CONFIRMATION_IND, 
    NPI_NUMBER, 
    OPPS_QUALITY_IND, 
    OUT_OF_STATE_STATUS_DESC, 
    PEACH_BASE_NUMBER, 
    PEACH_FORMATTED_NUMBER, 
    PEACH_SUFFIX_NUMBER, 
    PRACTICE_ADDRESS_CITY, 
    PRACTICE_ADDRESS_STATE_CODE, 
    PRACTICE_COUNTY_NAME, 
    PRACTICE_FULL_ZIP_CODE, 
    PRACTICE_STREET_ADDRESS_1, 
    PRACTICE_STREET_ADDRESS_2, 
    PRACTICE_TYPE_DESC, 
    PRACTICE_ZIP_CODE_EXT, 
    PRACTICE_ZIP_CODE_NUMBER, 
    PRIMARY_SOURCE_SYSTEM, 
    PROGRAM_PARTICIPATION_PERIOD, 
    PROVIDER_CBSA_CODE, 
    PROVIDER_DBA_SORT_NAME, 
    PROVIDER_NAME, 
    PROVIDER_PEACH_NUMBER, 
    PROVIDER_PHONE_NUMBER, 
    PROVIDER_PROGRAM_CODE, 
    PROVIDER_PROGRAM_DESC, 
    PROVIDER_PROGRAM_FOCUS_TEXT, 
    PROVIDER_TYPE_CODE, 
    PROVIDER_TYPE_DESC, 
    UNIQUE_ID_KEY
    from DEV_EDW_32600145.DIM_INCREMENTAL.DIM_PROVIDER_INC 
where current_record_ind = 'Y'
),
src as ( select * from EDW_STAGING_DIM.DIM_PROVIDER )
select src.* from src
inner join diff on ( diff.UNIQUE_ID_KEY = src.UNIQUE_ID_KEY )