
    
    



select count(*) as validation_errors
from (

    select
        MEDICAL_INVOICE_NUMBER||'-'||MEDICAL_INVOICE_LINE_SEQUENCE_NUMBER||'-'||MEDICAL_INVOICE_LINE_EXTENSION_NUMBER||'-'||MEDICAL_INVOICE_LINE_VERSION_NUMBER||'-'||SOURCE_LINE_DLM_DATE_KEY

    from EDW_STG_MEDICAL_MART.FACT_PRESCRIPTION_BILLING
    where MEDICAL_INVOICE_NUMBER||'-'||MEDICAL_INVOICE_LINE_SEQUENCE_NUMBER||'-'||MEDICAL_INVOICE_LINE_EXTENSION_NUMBER||'-'||MEDICAL_INVOICE_LINE_VERSION_NUMBER||'-'||SOURCE_LINE_DLM_DATE_KEY is not null
    group by MEDICAL_INVOICE_NUMBER||'-'||MEDICAL_INVOICE_LINE_SEQUENCE_NUMBER||'-'||MEDICAL_INVOICE_LINE_EXTENSION_NUMBER||'-'||MEDICAL_INVOICE_LINE_VERSION_NUMBER||'-'||SOURCE_LINE_DLM_DATE_KEY
    having count(*) > 1

) validation_errors


