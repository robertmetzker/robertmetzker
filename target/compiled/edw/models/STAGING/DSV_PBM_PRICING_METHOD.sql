 
----SRC LAYER----
WITH
SRC_P as ( SELECT *     from      STAGING.DST_PBM_PRICING_METHOD ),
----LOGIC LAYER----
LOGIC_P as ( SELECT 
		UNIQUE_ID_KEY AS UNIQUE_ID_KEY,
		PBM_PRCNG_CODE AS PBM_PRCNG_CODE,
		PBM_PRCNG_SRC_CODE AS PBM_PRCNG_SRC_CODE,
		PBM_PRCNG_DESC AS PBM_PRCNG_DESC,
		PBM_PRCNG_SRC_DESC AS PBM_PRCNG_SRC_DESC 
				from SRC_P
            )
----RENAME LAYER ----
,
RENAME_P as ( SELECT UNIQUE_ID_KEY AS UNIQUE_ID_KEY,
			
			PBM_PRCNG_CODE AS PRICE_TYPE_CODE,
			
			PBM_PRCNG_SRC_CODE AS PBM_PRICING_SOURCE_CODE,
			
			PBM_PRCNG_DESC AS PRICE_TYPE_DESC,
			
			PBM_PRCNG_SRC_DESC AS PBM_PRICING_SOURCE_DESC 
			from      LOGIC_P
        )
----FILTER LAYER(uses aliases)----
,

        FILTER_P as ( SELECT  * 
			from     RENAME_P 
            
        )
----JOIN LAYER----
,
 JOIN_P as ( SELECT * 
			from  FILTER_P )
 SELECT * FROM JOIN_P