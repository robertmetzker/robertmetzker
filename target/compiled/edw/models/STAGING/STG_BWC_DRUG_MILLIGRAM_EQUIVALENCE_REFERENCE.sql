----SRC LAYER----
WITH
SRC_DME as ( SELECT *     from      DEV_VIEWS.BWC_FILES.DRUG_MILLIGRAM_EQUIVALENCE_REFERENCE ),
----LOGIC LAYER----
LOGIC_DME as ( SELECT 
		MEDISPAN_14_GPI_CODE AS MEDISPAN_14_GPI_CODE,
		MEDISPAN_14_GPI_NAME AS MEDISPAN_14_GPI_NAME,
		DRUG_ROUTE_CODE AS DRUG_ROUTE_CODE,
		DRUG_ROUTE_NAME AS DRUG_ROUTE_NAME,
		DRUG_STRENGTH_CODE AS DRUG_STRENGTH_CODE,
		DRUG_STRENGTH_MEASURE_CODE AS DRUG_STRENGTH_MEASURE_CODE,
		MEDISPAN_4_GPI_CODE AS MEDISPAN_4_GPI_CODE,
		MEDISPAN_4_GPI_NAME AS MEDISPAN_4_GPI_NAME,
		MEDISPAN_8_GPI_CODE AS MEDISPAN_8_GPI_CODE,
		MEDISPAN_8_GPI_NAME AS MEDISPAN_8_GPI_NAME,
		EQUIVALENT_DRUG_NAME AS EQUIVALENT_DRUG_NAME,
		ACTIVE_DRUG_STRENGTH_QUANTITY AS ACTIVE_DRUG_STRENGTH_QUANTITY,
		CONVERSION_FACTOR_QUANTITY AS CONVERSION_FACTOR_QUANTITY,
		MILLIGRAM_EQUIVALENCE_QUANTITY AS MILLIGRAM_EQUIVALENCE_QUANTITY 
				from SRC_DME
            )
----RENAME LAYER ----
,
RENAME_DME as ( SELECT MEDISPAN_14_GPI_CODE AS MEDISPAN_14_GPI_CODE,MEDISPAN_14_GPI_NAME AS MEDISPAN_14_GPI_NAME,DRUG_ROUTE_CODE AS DRUG_ROUTE_CODE,DRUG_ROUTE_NAME AS DRUG_ROUTE_NAME,DRUG_STRENGTH_CODE AS DRUG_STRENGTH_CODE,DRUG_STRENGTH_MEASURE_CODE AS DRUG_STRENGTH_MEASURE_CODE,MEDISPAN_4_GPI_CODE AS MEDISPAN_4_GPI_CODE,MEDISPAN_4_GPI_NAME AS MEDISPAN_4_GPI_NAME,MEDISPAN_8_GPI_CODE AS MEDISPAN_8_GPI_CODE,MEDISPAN_8_GPI_NAME AS MEDISPAN_8_GPI_NAME,EQUIVALENT_DRUG_NAME AS EQUIVALENT_DRUG_NAME,ACTIVE_DRUG_STRENGTH_QUANTITY AS ACTIVE_DRUG_STRENGTH_QUANTITY,CONVERSION_FACTOR_QUANTITY AS CONVERSION_FACTOR_QUANTITY,MILLIGRAM_EQUIVALENCE_QUANTITY AS MILLIGRAM_EQUIVALENCE_QUANTITY 
			from      LOGIC_DME
        )
----FILTER LAYER(uses aliases)----
,

        FILTER_DME as ( SELECT  * 
			from     RENAME_DME 
            
        )
----JOIN LAYER----
,
 JOIN_DME as ( SELECT * 
			from  FILTER_DME )
 SELECT * FROM JOIN_DME