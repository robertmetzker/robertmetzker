----SRC LAYER----
WITH
SRC_PAYCAT as ( SELECT *     from      DEV_VIEWS.BWC_FILES.REVENUE_CODE_PAYMENT_CATEGORY )
----LOGIC LAYER----
,
LOGIC_PAYCAT as ( SELECT 
		TRIM(REVENUE_CODE) AS REVENUE_CODE,
		TRIM(PAYMENT_CATEGORY) AS PAYMENT_CATEGORY 
				from SRC_PAYCAT
            )
----RENAME LAYER ----
,
RENAME_PAYCAT as ( SELECT REVENUE_CODE AS REVENUE_CODE,PAYMENT_CATEGORY AS PAYMENT_CATEGORY 
			from      LOGIC_PAYCAT
        )
----FILTER LAYER(uses aliases)----
,

        FILTER_PAYCAT as ( SELECT  * 
			from     RENAME_PAYCAT 
            
        )
----JOIN LAYER----
,
 JOIN_PAYCAT as ( SELECT * 
			from  FILTER_PAYCAT )
 SELECT * FROM JOIN_PAYCAT