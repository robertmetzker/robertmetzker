
    
    



select count(*) as validation_errors
from (

    select
        CHECK_NUMBER||WARRANT_NUMBER||TCN_NUMBER||ACNTB_CODE||PYMNT_FUND_TYPE||CVRG_TYPE||BILL_TYPE_F2||BILL_TYPE_L3||ACDNT_TYPE||STS_CODE

    from STAGING.DSV_DETAIL_PAYMENT_CODING
    where CHECK_NUMBER||WARRANT_NUMBER||TCN_NUMBER||ACNTB_CODE||PYMNT_FUND_TYPE||CVRG_TYPE||BILL_TYPE_F2||BILL_TYPE_L3||ACDNT_TYPE||STS_CODE is not null
    group by CHECK_NUMBER||WARRANT_NUMBER||TCN_NUMBER||ACNTB_CODE||PYMNT_FUND_TYPE||CVRG_TYPE||BILL_TYPE_F2||BILL_TYPE_L3||ACDNT_TYPE||STS_CODE
    having count(*) > 1

) validation_errors


