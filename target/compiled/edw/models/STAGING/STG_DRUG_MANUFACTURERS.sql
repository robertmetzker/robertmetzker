----SRC LAYER----
WITH
SRC_MNMN as ( SELECT *     from      DEV_VIEWS.DBEABP00.TEAMNMN ),
----LOGIC LAYER----
LOGIC_MNMN as ( SELECT 
		FK_MLBI_NMBR AS FK_MLBI_NMBR,
		MNMN_CRT_DTTM AS MNMN_CRT_DTTM,
		CASE WHEN TRIM(NAME)='' THEN NULL ELSE TRIM(NAME) END AS NAME,
		CASE WHEN TRIM(ABRVD_NAME)='' THEN NULL ELSE TRIM(ABRVD_NAME) END AS ABRVD_NAME,
		CASE WHEN TRIM(LBLR_TYPE_CODE)='' then NULL ELSE TRIM(LBLR_TYPE_CODE) END AS LBLR_TYPE_CODE,
		cast(EFCTV_DATE as DATE) AS EFCTV_DATE,
		cast(ENDNG_DATE as DATE) AS ENDNG_DATE,
		CASE WHEN TRIM(CRT_USER_CODE)='' THEN NULL ELSE TRIM(CRT_USER_CODE) END AS CRT_USER_CODE,
		CASE WHEN TRIM(CRT_PRGRM_NAME)='' THEN NULL ELSE TRIM(CRT_PRGRM_NAME) END AS CRT_PRGRM_NAME,
		CASE WHEN TRIM(DCTVT_USER_CODE)='' THEN NULL ELSE TRIM(DCTVT_USER_CODE) END AS DCTVT_USER_CODE,
		CASE WHEN TRIM(DCTVT_PRGRM_NAME)='' THEN NULL ELSE TRIM(DCTVT_PRGRM_NAME) END AS DCTVT_PRGRM_NAME,
		DCTVT_DTTM AS DCTVT_DTTM 
				from SRC_MNMN
            )
----RENAME LAYER ----
,
RENAME_MNMN as ( SELECT FK_MLBI_NMBR AS FK_MLBI_NMBR,MNMN_CRT_DTTM AS MNMN_CRT_DTTM,NAME AS NAME,ABRVD_NAME AS ABRVD_NAME,LBLR_TYPE_CODE AS LBLR_TYPE_CODE,EFCTV_DATE AS EFCTV_DATE,ENDNG_DATE AS ENDNG_DATE,CRT_USER_CODE AS CRT_USER_CODE,CRT_PRGRM_NAME AS CRT_PRGRM_NAME,DCTVT_USER_CODE AS DCTVT_USER_CODE,DCTVT_PRGRM_NAME AS DCTVT_PRGRM_NAME,DCTVT_DTTM AS DCTVT_DTTM 
			from      LOGIC_MNMN
        )
----FILTER LAYER(uses aliases)----
,

        FILTER_MNMN as ( SELECT  * 
			from     RENAME_MNMN 
            
        )
----JOIN LAYER----
,
 JOIN_MNMN as ( SELECT * 
			from  FILTER_MNMN )
 SELECT * FROM JOIN_MNMN