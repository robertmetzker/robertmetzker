 
----SRC LAYER----
WITH
SRC_APC as ( SELECT *     from      STAGING.DST_AMBULATORY_PAYMENT_CLASSIFICATION ),
----LOGIC LAYER----
LOGIC_APC as ( SELECT 
		UNIQUE_ID_KEY AS UNIQUE_ID_KEY,
		APC_CODE AS APC_CODE,
		DESCRIPTION AS DESCRIPTION,
		STATUS AS STATUS,
		STATUS_DESC AS STATUS_DESC,
		RELATIVE_WEIGHT AS RELATIVE_WEIGHT,
		APC_AMOUNT AS APC_AMOUNT,
		EFFECTIVE_DATE AS EFFECTIVE_DATE,
		EXPIRATION_DATE AS EXPIRATION_DATE 
				from SRC_APC
            )
----RENAME LAYER ----
,
RENAME_APC as ( SELECT UNIQUE_ID_KEY AS UNIQUE_ID_KEY,APC_CODE AS APC_CODE,
			
			DESCRIPTION AS APC_DESC,
			
			STATUS AS APC_CODE_STATUS_CODE,
			
			STATUS_DESC AS APC_CODE_STATUS_DESC,
			
			RELATIVE_WEIGHT AS APC_RELATIVE_WEIGHT_RATE,APC_AMOUNT AS APC_AMOUNT,
			
			EFFECTIVE_DATE AS APC_EFFECTIVE_DATE,
			
			EXPIRATION_DATE AS APC_EXPIRATION_DATE 
			from      LOGIC_APC
        )
----FILTER LAYER(uses aliases)----
,

        FILTER_APC as ( SELECT  * 
			from     RENAME_APC 
            
        )
----JOIN LAYER----
,
 JOIN_APC as ( SELECT * 
			from  FILTER_APC )
 SELECT * FROM JOIN_APC