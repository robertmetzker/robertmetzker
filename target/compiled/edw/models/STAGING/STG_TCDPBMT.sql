----SRC LAYER----
WITH
SRC_T as ( SELECT *     from      DEV_VIEWS.DBDWQP00.TCDPBMT ),
----LOGIC LAYER----
LOGIC_T as ( SELECT 
		UPPER(TRIM(PBM_PRCNG_CODE)) AS PBM_PRCNG_CODE,
		UPPER(TRIM(PBM_PRCNG_TYPE)) AS PBM_PRCNG_TYPE,
		UPPER(TRIM(PBM_PRCNG_DESC)) AS PBM_PRCNG_DESC,
		DW_CNTRL_DATE AS DW_CNTRL_DATE 
				from SRC_T
            )
----RENAME LAYER ----
,
RENAME_T as ( SELECT PBM_PRCNG_CODE AS PBM_PRCNG_CODE,PBM_PRCNG_TYPE AS PBM_PRCNG_TYPE,PBM_PRCNG_DESC AS PBM_PRCNG_DESC,DW_CNTRL_DATE AS DW_CNTRL_DATE 
			from      LOGIC_T
        )
----FILTER LAYER(uses aliases)----
,

        FILTER_T as ( SELECT  * 
			from     RENAME_T 
            
        )
----JOIN LAYER----
,
 JOIN_T as ( SELECT * 
			from  FILTER_T )
 SELECT * FROM JOIN_T