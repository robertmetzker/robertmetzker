

----SRC LAYER----
WITH
SRC_MS as ( SELECT *     from      STAGING.DST_MODIFIER_SEQUENCE )
//SRC_MS as ( SELECT *     from      DST_MODIFIER_SEQUENCE)
----LOGIC LAYER----
,
LOGIC_MS as ( SELECT 
		UNIQUE_ID_KEY AS UNIQUE_ID_KEY,
		MOD_SET AS MOD_SET,
		REF_DGN_DESC AS REF_DGN_DESC,
		MOD_CODE_1 AS MOD_CODE_1,
		MOD_DESC_1 AS MOD_DESC_1,
		MOD_CODE_2 AS MOD_CODE_2,
		MOD_DESC_2 AS MOD_DESC_2,
		MOD_CODE_3 AS MOD_CODE_3,
		MOD_DESC_3 AS MOD_DESC_3,
		MOD_CODE_4 AS MOD_CODE_4,
		MOD_DESC_4 AS MOD_DESC_4 
				from SRC_MS
            )
----RENAME LAYER ----
,
RENAME_MS as ( SELECT UNIQUE_ID_KEY AS UNIQUE_ID_KEY,
			
			MOD_SET AS MODIFIER_SET_CODE,
			
			REF_DGN_DESC AS MODIFIER_SET_DESC,
			
			MOD_CODE_1 AS MODIFIER_SEQUENCE_1_CODE,
			
			MOD_DESC_1 AS CURRENT_MODIFIER_1_DESC,
			
			MOD_CODE_2 AS MODIFIER_SEQUENCE_2_CODE,
			
			MOD_DESC_2 AS CURRENT_MODIFIER_2_DESC,
			
			MOD_CODE_3 AS MODIFIER_SEQUENCE_3_CODE,
			
			MOD_DESC_3 AS CURRENT_MODIFIER_3_DESC,
			
			MOD_CODE_4 AS MODIFIER_SEQUENCE_4_CODE,
			
			MOD_DESC_4 AS CURRENT_MODIFIER_4_DESC 
			from      LOGIC_MS
        )
----FILTER LAYER(uses aliases)----
,

        FILTER_MS as ( SELECT  * 
			from     RENAME_MS 
            
        )
----JOIN LAYER----
,
 JOIN_MS as ( SELECT * 
			from  FILTER_MS )
 SELECT * FROM JOIN_MS