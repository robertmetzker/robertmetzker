----SRC LAYER----
WITH
SRC_MIRA as ( SELECT *     from      DEV_VIEWS.ACCESS_ACTUARIAL.MIRA_VALIDATION_EXTRACT_FINAL )
//SRC_MIRA as ( SELECT *     from      MIRA_VALIDATION_EXTRACT_FINAL)
----LOGIC LAYER----
,
LOGIC_MIRA as ( SELECT 
		TRIM(EA_OICL) AS EA_OICL,
		TRIM(CLAIM_NUMBER) AS CLAIM_NUMBER,
		TRIM(WCIS_POLICY_NUMBER) AS WCIS_POLICY_NUMBER,
		TRIM(EMPLOYER_TYPE) AS EMPLOYER_TYPE,
		TRIM(COVERAGE_TYPE) AS COVERAGE_TYPE,
		INJURY_DATE,
		INJURY_YEAR,
		TRIM(MANUAL) AS MANUAL,
		LAST_PREDICTION_DATE,
		TRIM(LAST_PREDICTION_STATUS) AS LAST_PREDICTION_STATUS,
		TRIM(INJURY_TYPE) AS INJURY_TYPE,
		TRIM(PRIMARY_ICD) AS PRIMARY_ICD,
		TOTAL_INCURRED,
		TOTAL_PAID,
		TOTAL_ORIGINAL_RESERVE,
		TOTAL_ADJUSTED_RESERVE,
		TOTAL_PUBLISHED_RESERVE,
		MO_REDUCTION,
		SC_ONLY_REDUCTION,
		SC_AND_LM_ONLY_REDUCTION,
		SC_AND_OTHER_INDEMNITY_REDUCTION,
		LMWL_REDUCTION,
		TRIM(CLAIM_CATEGORY) AS CLAIM_CATEGORY,
		SC_TOTAL,
		TOTAL_INDEMNITY_PAID,
		LAST_COMP_STOP_DATE,
		LAST_LM_STOP_DATE,
		DTH_INCURRED,
		DTH_PAID,
		DTH_ORIGINAL_RESERVE,
		DTH_ADJUSTED_RESERVE,
		LM_INCURRED,
		LM_PAID,
		LM_ORIGINAL_RESERVE,
		LM_ADJUSTED_RESERVE,
		MED_INCURRED,
		MED_PAID,
		MED_ORIGINAL_RESERVE,
		MED_ADJUSTED_RESERVE,
		PT_INCURRED,
		PT_PAID,
		PT_ORIGINAL_RESERVE,
		PT_ADJUSTED_RESERVE,
		PPG_INCURRED,
		PPG_PAID,
		PPG_ORIGINAL_RESERVE,
		PPG_ADJUSTED_RESERVE,
		TG_INCURRED,
		TG_PAID,
		TG_ORIGINAL_RESERVE,
		TG_ADJUSTED_RESERVE,
		FD_INCURRED,
		FD_PAID,
		FD_ORIGINAL_RESERVE,
		FD_ADJUSTED_RESERVE,
		CO_INCURRED,
		CO_PAID,
		CO_ORIGINAL_RESERVE,
		CO_ADJUSTED_RESERVE,
		OIG_INCURRED,
		OIG_PAID,
		OIG_ORIGINAL_RESERVE,
		OIG_ADJUSTED_RESERVE,
		TRIM(DTH_PREDICTION_FLAG) AS DTH_PREDICTION_FLAG,
		TRIM(LM_PREDICTION_FLAG) AS LM_PREDICTION_FLAG,
		TRIM(MED_PREDICTION_FLAG) AS MED_PREDICTION_FLAG,
		TRIM(PT_PREDICTION_FLAG) AS PT_PREDICTION_FLAG,
		TRIM(TG_PREDICTION_FLAG) AS TG_PREDICTION_FLAG,
		TRIM(FD_PREDICTION_FLAG) AS FD_PREDICTION_FLAG,
		TRIM(CO_PREDICTION_FLAG) AS CO_PREDICTION_FLAG,
		LAST_MED_PAY_DATE,
		LSS_AMOUNT,
		EXTRC_DATE,
		TRIM(FILE_NAME) AS FILE_NAME

				from SRC_MIRA
            )
----RENAME LAYER ----
,
RENAME_MIRA as ( SELECT EA_OICL AS EA_OICL,CLAIM_NUMBER AS CLAIM_NUMBER,EXTRC_DATE AS EXTRC_DATE,WCIS_POLICY_NUMBER AS WCIS_POLICY_NUMBER,EMPLOYER_TYPE AS EMPLOYER_TYPE,COVERAGE_TYPE AS COVERAGE_TYPE,INJURY_DATE AS INJURY_DATE,INJURY_YEAR AS INJURY_YEAR,MANUAL AS MANUAL,LAST_PREDICTION_DATE AS LAST_PREDICTION_DATE,LAST_PREDICTION_STATUS AS LAST_PREDICTION_STATUS,INJURY_TYPE AS INJURY_TYPE,PRIMARY_ICD AS PRIMARY_ICD,TOTAL_INCURRED AS TOTAL_INCURRED,TOTAL_PAID AS TOTAL_PAID,TOTAL_ORIGINAL_RESERVE AS TOTAL_ORIGINAL_RESERVE,TOTAL_ADJUSTED_RESERVE AS TOTAL_ADJUSTED_RESERVE,TOTAL_PUBLISHED_RESERVE AS TOTAL_PUBLISHED_RESERVE,MO_REDUCTION AS MO_REDUCTION,SC_ONLY_REDUCTION AS SC_ONLY_REDUCTION,SC_AND_LM_ONLY_REDUCTION AS SC_AND_LM_ONLY_REDUCTION,SC_AND_OTHER_INDEMNITY_REDUCTION AS SC_AND_OTHER_INDEMNITY_REDUCTION,LMWL_REDUCTION AS LMWL_REDUCTION,CLAIM_CATEGORY AS CLAIM_CATEGORY,SC_TOTAL AS SC_TOTAL,TOTAL_INDEMNITY_PAID AS TOTAL_INDEMNITY_PAID,LAST_COMP_STOP_DATE AS LAST_COMP_STOP_DATE,LAST_LM_STOP_DATE AS LAST_LM_STOP_DATE,DTH_INCURRED AS DTH_INCURRED,DTH_PAID AS DTH_PAID,DTH_ORIGINAL_RESERVE AS DTH_ORIGINAL_RESERVE,DTH_ADJUSTED_RESERVE AS DTH_ADJUSTED_RESERVE,LM_INCURRED AS LM_INCURRED,LM_PAID AS LM_PAID,LM_ORIGINAL_RESERVE AS LM_ORIGINAL_RESERVE,LM_ADJUSTED_RESERVE AS LM_ADJUSTED_RESERVE,MED_INCURRED AS MED_INCURRED,MED_PAID AS MED_PAID,MED_ORIGINAL_RESERVE AS MED_ORIGINAL_RESERVE,MED_ADJUSTED_RESERVE AS MED_ADJUSTED_RESERVE,PT_INCURRED AS PT_INCURRED,PT_PAID AS PT_PAID,PT_ORIGINAL_RESERVE AS PT_ORIGINAL_RESERVE,PT_ADJUSTED_RESERVE AS PT_ADJUSTED_RESERVE,PPG_INCURRED AS PPG_INCURRED,PPG_PAID AS PPG_PAID,PPG_ORIGINAL_RESERVE AS PPG_ORIGINAL_RESERVE,PPG_ADJUSTED_RESERVE AS PPG_ADJUSTED_RESERVE,TG_INCURRED AS TG_INCURRED,TG_PAID AS TG_PAID,TG_ORIGINAL_RESERVE AS TG_ORIGINAL_RESERVE,TG_ADJUSTED_RESERVE AS TG_ADJUSTED_RESERVE,FD_INCURRED AS FD_INCURRED,FD_PAID AS FD_PAID,FD_ORIGINAL_RESERVE AS FD_ORIGINAL_RESERVE,FD_ADJUSTED_RESERVE AS FD_ADJUSTED_RESERVE,CO_INCURRED AS CO_INCURRED,CO_PAID AS CO_PAID,CO_ORIGINAL_RESERVE AS CO_ORIGINAL_RESERVE,CO_ADJUSTED_RESERVE AS CO_ADJUSTED_RESERVE,OIG_INCURRED AS OIG_INCURRED,OIG_PAID AS OIG_PAID,OIG_ORIGINAL_RESERVE AS OIG_ORIGINAL_RESERVE,OIG_ADJUSTED_RESERVE AS OIG_ADJUSTED_RESERVE,DTH_PREDICTION_FLAG AS DTH_PREDICTION_FLAG,LM_PREDICTION_FLAG AS LM_PREDICTION_FLAG,MED_PREDICTION_FLAG AS MED_PREDICTION_FLAG,PT_PREDICTION_FLAG AS PT_PREDICTION_FLAG,TG_PREDICTION_FLAG AS TG_PREDICTION_FLAG,FD_PREDICTION_FLAG AS FD_PREDICTION_FLAG,CO_PREDICTION_FLAG AS CO_PREDICTION_FLAG,LAST_MED_PAY_DATE AS LAST_MED_PAY_DATE,LSS_AMOUNT AS LSS_AMOUNT,FILE_NAME AS FILE_NAME 
			from      LOGIC_MIRA
        )
----FILTER LAYER(uses aliases)----
,

        FILTER_MIRA as ( SELECT  * 
			from     RENAME_MIRA 
            
        )
----JOIN LAYER----
,
 JOIN_MIRA as ( SELECT * 
			from  FILTER_MIRA )
 SELECT * FROM JOIN_MIRA