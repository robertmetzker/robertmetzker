----SRC LAYER----
WITH
SCD1 as ( SELECT PRACTICE_ADDRESS_CITY, CORRESPONDENCE_ADDRESS_STATE_CODE,  MEDICARE_NUMBER
, NPI_CONFIRMATION_IND, PEACH_FORMATTED_NUMBER, CORRESPONDENCE_STREET_ADDRESS_1
, CORRESPONDENCE_STREET_ADDRESS_2, DEP_ADMINISTRATIVE_AGENT_NAME, CORRESPONDENCE_COUNTY_NAME, DEP_ADR_FILE_REVIEW_IND
, DEP_PULMONARY_EXAM_IND, DEP_IME_IND, PROVIDER_PEACH_NUMBER, PRACTICE_STREET_ADDRESS_1, DEP_ACTIVE_IND
, DEP_C92A_FILE_REVIEW_IND, MCO_MEDICAL_DIRECTOR_IND, PROVIDER_TYPE_DESC, CORRESPONDENCE_ADDRESS_CITY
, MEDICARE_NUMBER_STATE_CODE, PROVIDER_PHONE_NUMBER, CORRESPONDENCE_FULL_ZIP_CODE, DEP_MEDICAL_FILE_REVIEW_IND
, DEP_B_READER_IND, PROVIDER_TYPE_CODE, CORRESPONDENCE_ZIP_CODE_NUMBER, CORRESPONDENCE_ZIP_CODE_EXT, OUT_OF_STATE_STATUS_DESC
, PRACTICE_ZIP_CODE_EXT, CURRENT_CERTIFICATION_STATUS, PEACH_SUFFIX_NUMBER, DEP_SERVICE_DESC, DEP_C92_EXAM_IND
, DEP_PRIOR_AUTHORIZATION_REVIEW_IND, PRACTICE_COUNTY_NAME, PRACTICE_STREET_ADDRESS_2, DEP_PULMONARY_REVIEW_IND
, DEP_ADDITIONAL_LANGUAGE_IND, DEP_ASBESTOSIS_EXAM_IND, PRACTICE_TYPE_DESC, NPI_NUMBER
, DEP_SERVICE_CODE, PRACTICE_FULL_ZIP_CODE, DEP_ONLINE_FILE_REVIEW_IND, PEACH_BASE_NUMBER, DEP_STATUS_DESC
, DEP_DUR_REVIEW_IND, PRACTICE_ADDRESS_STATE_CODE, CURRENT_ENROLLMENT_STATUS, DEP_ADR_IME_IND
, DEP_DM_IME_IND, PRACTICE_ZIP_CODE_NUMBER, DEP_90_DAY_EXAM_IND , PROVIDER_SPECIALTY_LIST_TEXT,  UNIQUE_ID_KEY    
	from      STAGING.DSV_PROVIDER ),
SCD2 as ( SELECT *    
	from      EDW_STAGING_SNAPSHOT.DIM_PROVIDER_SNAPSHOT_STEP1 ),
FINAL as ( SELECT * 
			from  SCD2 
				INNER JOIN SCD1 USING( UNIQUE_ID_KEY )  )
select * from FINAL