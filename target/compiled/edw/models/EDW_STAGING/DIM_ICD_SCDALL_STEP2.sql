----SRC LAYER----
WITH
SCD1 as ( SELECT ICD_ACP_ELIGIBILE_IND,ICD_LOCATION_REQUIRED_IND,BWC_INJURY_CLASS_DESC,EM_REFERRAL_DESC
,BWC_GENERIC_BODY_PART_DESC,EM_REFERRAL_CODE,ENCODER_VALIDATION_REQUIRED_IND,ICD_SECURITY_AUTHORIZATION_IND
,ICD_POTENTIAL_SEVERE_COMPLICATIONS_IND,GENDER_SPECIFIC_CODE,BWC_SPECIFIC_BODY_PART_DESC,ICD_STATUTORY_OCCUPATIONAL_DISEASE_IND
,ICD_CODE,GENDER_SPECIFIC_DESC,ICD_PRIVACY_IND,ICD_CODE_CHAPTER_NUMBER_SHORT_DESC,ICD_SUBROGATION_REVIEW_IND,AUTHORIZED_CLAIM_USE_IND
,ICD_CODE_VERSION_NUMBER,CMS_PROHIBITED_IND,ICD_PSYCHOLOGICAL_IND,ICD_SITE_REQUIRED_IND,CATASTROPHIC_ICD_IND,ICD_PRIOR_AUTHORIZATION_REQUIRED_IND
,ASSIGN_ICD_TO_FIELD_IND,AUTHORIZED_BILL_USE_IND,ICD_CODE_CHAPTER_NUMBER_LONG_DESC,ICD_CODE_CHAPTER_NUMBER 
, UNIQUE_ID_KEY    from      STAGING.DSV_ICD ),
SCD2 as ( SELECT *    from      EDW_STAGING_SNAPSHOT.DIM_ICD_SNAPSHOT_STEP1 ),
FINAL as ( SELECT * 
			from  SCD2 
				INNER JOIN SCD1 USING(UNIQUE_ID_KEY)  )
select * from FINAL