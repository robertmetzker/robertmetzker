----SRC LAYER----
WITH
SCD1 as ( SELECT MAILING_STREET_ADDRESS_1, PHYSICAL_FORMATTED_ADDRESS_ZIP_CODE, COVERED_INDIVIDUAL_FIRST_NAME, HOME_PHONE_NUMBER, PHYSICAL_ADDRESS_CITY_NAME, MAILING_ADDRESS_STATE_CODE, MAILING_ADDRESS_STATE_NAME, PHYSICAL_ADDRESS_POSTAL_CODE, MAILING_STREET_ADDRESS_2, COVERED_INDIVIDUAL_CUSTOMER_NUMBER, MAILING_FORMATTED_ADDRESS_ZIP_CODE, PHYSICAL_STREET_ADDRESS_2, EMAIL_ADDRESS, MAILING_ADDRESS_COUNTRY_NAME, PHYSICAL_ADDRESS_STATE_NAME, PHYSICAL_ADDRESS_STATE_CODE, MAILING_ADDRESS_POSTAL_CODE, MAILING_ADDRESS_COUNTY_NAME, COVERED_INDIVIDUAL_LAST_NAME, COVERED_INDIVIDUAL_NAME, PHYSICAL_ADDRESS_COMMENT_TEXT, PHYSICAL_STREET_ADDRESS_1, MAILING_ADDRESS_VALIDATED_IND, MAILING_ADDRESS_CITY_NAME, DOCUMENT_BLOCK_IND, PHYSICAL_ADDRESS_COUNTY_NAME
 ,  md5(cast(
    
    coalesce(cast(COVERED_INDIVIDUAL_CUSTOMER_NUMBER as 
    varchar
), '')

 as 
    varchar
)) as COVERED_INDIVIDUAL_CUSTOMER_HKEY
, MAILING_FORMATTED_ADDRESS_ZIP4_CODE, PHYSICAL_ADDRESS_VALIDATED_IND, PHYSICAL_FORMATTED_ADDRESS_ZIP4_CODE, PHYSICAL_FORMATTED_ADDRESS_POSTAL_CODE, PHYSICAL_ADDRESS_COUNTRY_NAME, MAILING_ADDRESS_COMMENT_TEXT, CELL_PHONE_NUMBER, MAILING_FORMATTED_ADDRESS_POSTAL_CODE ,TAX_ID_NUMBER, UNIQUE_ID_KEY    
	--, '1901-01-01' as DBT_VALID_FROM, '2099-12-31' as DBT_VALID_TO
	from      STAGING.DSV_COVERED_INDIVIDUAL_CUSTOMER )

select * from SCD1