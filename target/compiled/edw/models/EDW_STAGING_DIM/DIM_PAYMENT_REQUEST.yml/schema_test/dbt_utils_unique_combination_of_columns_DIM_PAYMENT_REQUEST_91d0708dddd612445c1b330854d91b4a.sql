





with validation_errors as (

    select
        PAY_MEDIA_PREFERENCE_TYPE_CODE, PAY_REQUEST_TYPE_CODE, PAY_REQUEST_STATE_TYPE_CODE, PAY_REQUEST_STATUS_TYPE_CODE, PAY_REQUEST_STATUS_REASON_TYPE_CODE
    from EDW_STAGING_DIM.DIM_PAYMENT_REQUEST

    group by PAY_MEDIA_PREFERENCE_TYPE_CODE, PAY_REQUEST_TYPE_CODE, PAY_REQUEST_STATE_TYPE_CODE, PAY_REQUEST_STATUS_TYPE_CODE, PAY_REQUEST_STATUS_REASON_TYPE_CODE
    having count(*) > 1

)

select count(*)
from validation_errors


