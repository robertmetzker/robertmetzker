

      create or replace  table DEV_EDW.EDW_STAGING.DIM_NETWORK_SCDALL_STEP2  as
      (----SRC LAYER----
WITH
SCD1 as ( SELECT NETWORK_FINANCIAL_ADDRESS_ZIP_CODE,NETWORK_MAILING_ADDRESS_STATE_CODE,NETWORK_MAILING_STREET_ADDRESS_1,CORESUITE_CUSTOMER_NUMBER
,NETWORK_FINANCIAL_STREET_ADDRESS_1,NETWORK_PHYSICAL_ADDRESS_ZIP4_CODE,NETWORK_FINANCIAL_ADDRESS_ZIP4_CODE,NETWORK_TYPE_DESC
,NETWORK_FINANCIAL_ADDRESS_CITY_NAME,MCO_CLOSE_BUSINESS_DATE,NETWORK_MAILING_STREET_ADDRESS_2,CURRENT_ACQUIRING_MCO_NAME
,NETWORK_PHYSICAL_ADDRESS_ZIP_CODE,NETWORK_NUMBER,NETWORK_PHYSICAL_ADDRESS_CITY_NAME,NETWORK_FINANCIAL_STREET_ADDRESS_2,CURRENT_ACQUIRING_MCO_NUMBER,NETWORK_TYPE_CODE
,MCO_ACQUISITION_PATH,NETWORK_PHYSICAL_STREET_ADDRESS_1,NETWORK_MAILING_ADDRESS_CITY_NAME,NETWORK_MAILING_ADDRESS_ZIP4_CODE
,NETWORK_MAILING_ADDRESS_ZIP_CODE,NETWORK_PHYSICAL_STREET_ADDRESS_2,NETWORK_PHYSICAL_ADDRESS_STATE_CODE,NETWORK_FINANCIAL_ADDRESS_STATE_CODE
 , UNIQUE_ID_KEY    from      STAGING.DSV_NETWORK ),
SCD2 as ( SELECT *    from      EDW_STAGING_SNAPSHOT.DIM_NETWORK_SNAPSHOT_STEP1 ),
FINAL as ( SELECT * 
			from  SCD2 
				INNER JOIN SCD1 USING(UNIQUE_ID_KEY)  )
select * from FINAL
      );
    