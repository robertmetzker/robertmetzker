
        
        
    

    

    merge into DEV_EDW_32600145.DIM_INCREMENTAL.DIM_HOSPITAL_ICD_PROCEDURE_INC as DBT_INTERNAL_DEST
        using DEV_EDW_32600145.DIM_INCREMENTAL.DIM_HOSPITAL_ICD_PROCEDURE_INC__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.ICD_PROCEDURE_HKEY = DBT_INTERNAL_DEST.ICD_PROCEDURE_HKEY
        

    
    when matched then update set
        "ICD_PROCEDURE_HKEY" = DBT_INTERNAL_SOURCE."ICD_PROCEDURE_HKEY","UNIQUE_ID_KEY" = DBT_INTERNAL_SOURCE."UNIQUE_ID_KEY","ICD_PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."ICD_PROCEDURE_CODE","ICD_DESC" = DBT_INTERNAL_SOURCE."ICD_DESC","ICD_CODE_VERSION_NUMBER" = DBT_INTERNAL_SOURCE."ICD_CODE_VERSION_NUMBER","GENDER_SPECIFIC_CODE" = DBT_INTERNAL_SOURCE."GENDER_SPECIFIC_CODE","GENDER_SPECIFIC_DESC" = DBT_INTERNAL_SOURCE."GENDER_SPECIFIC_DESC","MIN_AGE" = DBT_INTERNAL_SOURCE."MIN_AGE","MAX_AGE" = DBT_INTERNAL_SOURCE."MAX_AGE","COVERED_FLAG" = DBT_INTERNAL_SOURCE."COVERED_FLAG","CURRENT_RECORD_IND" = DBT_INTERNAL_SOURCE."CURRENT_RECORD_IND","RECORD_EFFECTIVE_DATE" = DBT_INTERNAL_SOURCE."RECORD_EFFECTIVE_DATE","RECORD_END_DATE" = DBT_INTERNAL_SOURCE."RECORD_END_DATE","LOAD_DATETIME" = DBT_INTERNAL_SOURCE."LOAD_DATETIME","UPDATE_DATETIME" = DBT_INTERNAL_SOURCE."UPDATE_DATETIME","PRIMARY_SOURCE_SYSTEM" = DBT_INTERNAL_SOURCE."PRIMARY_SOURCE_SYSTEM"
    

    when not matched then insert
        ("ICD_PROCEDURE_HKEY", "UNIQUE_ID_KEY", "ICD_PROCEDURE_CODE", "ICD_DESC", "ICD_CODE_VERSION_NUMBER", "GENDER_SPECIFIC_CODE", "GENDER_SPECIFIC_DESC", "MIN_AGE", "MAX_AGE", "COVERED_FLAG", "CURRENT_RECORD_IND", "RECORD_EFFECTIVE_DATE", "RECORD_END_DATE", "LOAD_DATETIME", "UPDATE_DATETIME", "PRIMARY_SOURCE_SYSTEM")
    values
        ("ICD_PROCEDURE_HKEY", "UNIQUE_ID_KEY", "ICD_PROCEDURE_CODE", "ICD_DESC", "ICD_CODE_VERSION_NUMBER", "GENDER_SPECIFIC_CODE", "GENDER_SPECIFIC_DESC", "MIN_AGE", "MAX_AGE", "COVERED_FLAG", "CURRENT_RECORD_IND", "RECORD_EFFECTIVE_DATE", "RECORD_END_DATE", "LOAD_DATETIME", "UPDATE_DATETIME", "PRIMARY_SOURCE_SYSTEM")

