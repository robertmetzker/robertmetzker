

      create or replace  table DEV_EDW.STAGING.STG_ICD_CHAPTER_BODY_PART_REFERENCE  as
      (WITH
SRC_CBPR as ( SELECT *     from      DEV_VIEWS.BWC_FILES.ICD_CHAPTER_BODY_PART_REFERENCE )
----LOGIC LAYER----
,
LOGIC_CBPR as ( SELECT 
		ICD_CODE AS ICD_CODE,
		ICD_VRSN_CODE AS ICD_VRSN_CODE,
		ICD_DESC AS ICD_DESC,
		ICD_CHAPTER_NUMBER AS ICD_CHAPTER_NUMBER,
		ICD_FULL_CHAPTER_DESC AS ICD_FULL_CHAPTER_DESC,
		ICD_SHORT_CHAPTER_DEC AS ICD_SHORT_CHAPTER_DEC,
		INJURY_CLASS_DESC AS INJURY_CLASS_DESC,
		ICD_GENERAL_BODY_PART_DESC AS ICD_GENERAL_BODY_PART_DESC,
		ICD_SPECIFIC_BODY_PART_DESC AS ICD_SPECIFIC_BODY_PART_DESC 
				from SRC_CBPR
            )
----RENAME LAYER ----
,
RENAME_CBPR as ( SELECT ICD_CODE AS ICD_CODE,ICD_VRSN_CODE AS ICD_VRSN_CODE,ICD_DESC AS ICD_DESC,ICD_CHAPTER_NUMBER AS ICD_CHAPTER_NUMBER,ICD_FULL_CHAPTER_DESC AS ICD_FULL_CHAPTER_DESC,ICD_SHORT_CHAPTER_DEC AS ICD_SHORT_CHAPTER_DEC,INJURY_CLASS_DESC AS INJURY_CLASS_DESC,ICD_GENERAL_BODY_PART_DESC AS ICD_GENERAL_BODY_PART_DESC,ICD_SPECIFIC_BODY_PART_DESC AS ICD_SPECIFIC_BODY_PART_DESC 
			from      LOGIC_CBPR
        )
----FILTER LAYER(uses aliases)----
,

        FILTER_CBPR as ( SELECT  * 
			from     RENAME_CBPR 
            
        )
----JOIN LAYER----
,
 JOIN_CBPR as ( SELECT * 
			from  FILTER_CBPR )
 SELECT * FROM JOIN_CBPR
      );
    