

      create or replace  table DEV_EDW.STAGING.STG_CUSTOMER_SOC_SEC_RET_DTL  as
      (----SRC LAYER----
WITH
SRC_CSSRD as ( SELECT *     from      DEV_VIEWS.PCMP.BWC_CUSTOMER_SOC_SEC_RET_DTL  )
----LOGIC LAYER----
,
LOGIC_CSSRD as ( SELECT 
		cast(CUST_SOC_SEC_RET_DTL_ID as numeric(31,0)) AS CUST_SOC_SEC_RET_DTL_ID,
		cast(CUST_ID as numeric(31,0)) AS CUST_ID,
		cast(CUST_SOC_SEC_RET_DTL_DT as DATE) AS CUST_SOC_SEC_RET_DTL_DT,
		cast(CUST_SOC_SEC_RET_DTL_EFF_DT as DATE) AS CUST_SOC_SEC_RET_DTL_EFF_DT,
		cast(CUST_SOC_SEC_RET_DTL_END_DT as DATE) AS CUST_SOC_SEC_RET_DTL_END_DT,
		CAST(AUDIT_USER_ID_CREA AS NUMERIC(31,0))AS AUDIT_USER_ID_CREA,
		AUDIT_USER_CREA_DTM::TIMESTAMP AS AUDIT_USER_CREA_DTM,
		CAST(AUDIT_USER_ID_UPDT AS NUMERIC(31,0)) AS AUDIT_USER_ID_UPDT,
		AUDIT_USER_UPDT_DTM::TIMESTAMP AS AUDIT_USER_UPDT_DTM,
		UPPER(VOID_IND) AS VOID_IND 
				from SRC_CSSRD
            )
----RENAME LAYER ----
,
RENAME_CSSRD as ( SELECT CUST_SOC_SEC_RET_DTL_ID AS CUST_SOC_SEC_RET_DTL_ID,CUST_ID AS CUST_ID,CUST_SOC_SEC_RET_DTL_DT AS CUST_SOC_SEC_RET_DTL_DT,CUST_SOC_SEC_RET_DTL_EFF_DT AS CUST_SOC_SEC_RET_DTL_EFF_DT,CUST_SOC_SEC_RET_DTL_END_DT AS CUST_SOC_SEC_RET_DTL_END_DT,AUDIT_USER_ID_CREA AS AUDIT_USER_ID_CREA,AUDIT_USER_CREA_DTM AS AUDIT_USER_CREA_DTM,AUDIT_USER_ID_UPDT AS AUDIT_USER_ID_UPDT,AUDIT_USER_UPDT_DTM AS AUDIT_USER_UPDT_DTM,VOID_IND AS VOID_IND 
			from      LOGIC_CSSRD
        )
----FILTER LAYER(uses aliases)----
,

        FILTER_CSSRD as ( SELECT  * 
			from     RENAME_CSSRD 
            
        )
----JOIN LAYER----
,
 JOIN_CSSRD as ( SELECT * 
			from  FILTER_CSSRD )
 SELECT * FROM JOIN_CSSRD
      );
    