
  create or replace  view DEV_EDW.STAGING.DSV_ADMISSION  as (
    
----SRC LAYER----
WITH
SRC_ADM as ( SELECT *     from      STAGING.DST_ADMISSION )
//SRC_ADM as ( SELECT *     from      DST_ADMISSION)
----LOGIC LAYER----
,
LOGIC_ADM as ( SELECT 
		UNIQUE_ID_KEY AS UNIQUE_ID_KEY,
		ADMISSION_TYPE AS ADMISSION_TYPE,
		ADMISSION_SOURCE AS ADMISSION_SOURCE,
		DISCHARGE_STATUS AS DISCHARGE_STATUS,
		BILL_TYPE AS BILL_TYPE,
		ADMISSION_TYPE_DESC AS ADMISSION_TYPE_DESC,
		ADMISSION_SOURCE_DESC AS ADMISSION_SOURCE_DESC,
		DISCHARGE_STATUS_DESC AS DISCHARGE_STATUS_DESC ,
		BILL_TYPE_DESC AS BILL_TYPE_DESC
				from SRC_ADM
            )
----RENAME LAYER ----
,
RENAME_ADM as ( SELECT UNIQUE_ID_KEY AS UNIQUE_ID_KEY,
			
			ADMISSION_TYPE AS HOSPITAL_ADMISSION_TYPE_CODE,
			
			ADMISSION_SOURCE AS MEDICAL_INVOICE_SOURCE_OF_ADMISSION_CODE,
			
			DISCHARGE_STATUS AS MEDICAL_INVOICE_HOSPITAL_DISCHARGE_STATUS_CODE,
			
			BILL_TYPE AS MEDICAL_INVOICE_HOSPITAL_BILL_TYPE_CODE,
			
			ADMISSION_TYPE_DESC AS HOSPITAL_ADMISSION_TYPE_DESC,
			
			ADMISSION_SOURCE_DESC AS MEDICAL_INVOICE_SOURCE_OF_ADMISSION_DESC,
			
			DISCHARGE_STATUS_DESC AS MEDICAL_INVOICE_HOSPITAL_DISCHARGE_STATUS_DESC,
			
			BILL_TYPE_DESC AS MEDICAL_INVOICE_HOSPITAL_BILL_TYPE_DESC 
			from      LOGIC_ADM
        )
----FILTER LAYER(uses aliases)----
,

        FILTER_ADM as ( SELECT  * 
			from     RENAME_ADM 
            
        )
----JOIN LAYER----
,
 JOIN_ADM as ( SELECT * 
			from  FILTER_ADM )
 SELECT * FROM JOIN_ADM
  );
