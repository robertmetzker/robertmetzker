

      create or replace  table DEV_EDW.STAGING.STG_CAM_REF_VAL  as
      (----SRC LAYER----
WITH
SRC_RV as ( SELECT *     from      DEV_VIEWS.BASE.REF_VAL )

----LOGIC LAYER----
,
LOGIC_RV as ( SELECT 
		REF_RID AS REF_RID,
		TRIM(KEY_IDENTIFIER) AS KEY_IDENTIFIER,
		TRIM(VALUE) AS VALUE,
		TRIM(CREATION_USER) AS CREATION_USER,
		CREATION_DATE AS CREATION_DATE,
		TRIM(UPDATE_USER) AS UPDATE_USER,
		UPDATE_DATE AS UPDATE_DATE 
				from SRC_RV
            )
----RENAME LAYER ----
,
RENAME_RV as ( SELECT REF_RID AS REF_RID,KEY_IDENTIFIER AS KEY_IDENTIFIER,VALUE AS VALUE,CREATION_USER AS CREATION_USER,CREATION_DATE AS CREATION_DATE,UPDATE_USER AS UPDATE_USER,UPDATE_DATE AS UPDATE_DATE 
			from      LOGIC_RV
        )
----FILTER LAYER(uses aliases)----
,

        FILTER_RV as ( SELECT  * 
			from     RENAME_RV 
            
        )
----JOIN LAYER----
,
 JOIN_RV as ( SELECT * 
			from  FILTER_RV )
 SELECT * FROM JOIN_RV
      );
    