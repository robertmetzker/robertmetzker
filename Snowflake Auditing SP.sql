--- FACT_METRICS( martname, cutoff )
--      call FACT_METRICS('CLAIMS_MART',0);

--- TABLE_PROFILE (DBNAME , TSCHEMA , TNAME )
--      call TABLE_PROFILE ('DEV_EDW_32600145','STAGING', 'DST_ACTIVITY');

declare
    rs resultset;
    rs_output resultset;
begin
    -- get relevant tables
    let db :='RDA1_SOURCE';
    let db_catalog:= db||'.INFORMATION_SCHEMA.tables';
    let table_schema :='DW_REPORT';
        
    rs := (select table_schema, table_name from IDENTIFIER(:db_catalog) where TABLE_SCHEMA != 'INFORMATION_SCHEMA' and TABLE_SCHEMA = :table_schema);

    let tmp_array := ARRAY_CONSTRUCT();
    let table_count :=0;let i:=0;
    for arow_rs in rs do
        i:=i+1;
        let aschema := '"'||arow_rs.table_schema::TEXT||'"';
        let atable := '"'||arow_rs.table_name::TEXT||'"';
        
        let qualified_table:=db||'.'||aschema||'.'||atable;
        
        select count(*) into table_count from  identifier(:qualified_table);
        tmp_array := array_append(:tmp_array, 
                                    OBJECT_CONSTRUCT(
                                        'table_name', arow_rs.table_name, 
                                        'table_schema', arow_rs.table_schema,
                                        'count', table_count)
                                  );
        if (i> 10) then break;end if;
    end for;
    rs_output := (select 
                    value:table_schema::text as table_schema,
                    value:table_name::text as table_name,
                    value:count::number as table_count 
                  from table(flatten(:tmp_array)));
    return table(rs_output);
end;

select sum("LINE_UNITS_OF_PAID_SERVICE_COUNT") as total, 
        min("LINE_UNITS_OF_PAID_SERVICE_COUNT") as minval, 
        max("LINE_UNITS_OF_PAID_SERVICE_COUNT") as maxval 
from DEV_EDW.MEDICAL_MART.FACT_CONSOLIDATED_MEDICAL_BILLING;




create or replace procedure FACT_METRICS (MARTNAME TEXT, cutoff number)
    RETURNS TABLE ( db text, table_schema text, table_name text, table_column text, numrows number, total number, min_val number, max_val number, row_avg number)
    LANGUAGE SQL
    EXECUTE AS OWNER
    as
declare
    rs resultset;
    rs2 resultset;
    rs_output resultset;
begin
    -- get relevant tables
    let db :='DEV_EDW';
    let db_catalog:= db||'.INFORMATION_SCHEMA.columns';
    -- let table_schema :='MEDICAL_MART';
    let table_schema := :MARTNAME;
    let cut_off := :CUTOFF;
    
    let col_type := 'NUMBER';
    rs := (select table_schema, table_name, column_name from 
            IDENTIFIER(:db_catalog) where (COLUMN_NAME like '%COUNT' or COLUMN_NAME like '%AMOUNT') and TABLE_SCHEMA != 'INFORMATION_SCHEMA'
             and TABLE_SCHEMA = :table_schema and DATA_TYPE = :col_type);

    let tmp_array := ARRAY_CONSTRUCT();
    let table_count :=0;let i:=0;
    for arow_rs in rs do
        i:=i+1;
        let aschema := '"'||arow_rs.table_schema::TEXT||'"';
        let atable := '"'||arow_rs.table_name::TEXT||'"';
        let acol := '"'||arow_rs.column_name::TEXT||'"';
        let qualified_table:=db||'.'||aschema||'.'||atable;
        --        
        let query := 'select count('||acol||') as numrows, sum('||acol||') as total, min('||acol||') as minval, max('||acol||') as maxval, avg('||acol||') as rowavg from '|| qualified_table;
        rs2 :=  ( execute immediate :query    );
        
        for arow_rs2 in rs2 do
          let numrows  := arow_rs2.numrows::INTEGER;
          let total  := arow_rs2.total::INTEGER;
          let minval := arow_rs2.minval::text;
          let maxval := arow_rs2.maxval::text;
          let rowavg := arow_rs2.rowavg::number;
          let obj :=  OBJECT_CONSTRUCT('db',db,'table_name', atable,'table_schema', aschema,'column',acol, 'numrows',numrows, 'total',total, 'min_val',minval, 'max_val',maxval);
          tmp_array := array_append(:tmp_array, obj );
       end for;
       
       if (cut_off <= 0) then cut_off := 1000; end if;
       if (i>= cut_off) then break; end if;
    
    end for;
    rs_output := (select 
                    value:db::text as db,
                    value:table_schema::text as table_schema,
                    value:table_name::text as table_name,
                    value:column::text as table_column,
                    value:numrows::number as numrows,
                    value:total::number as total,
                    value:min_val::number as min_val,
                    value:max_val::number as max_val,
                    trunc( (total/numrows), 2) as row_avg
                  from table(flatten(:tmp_array)));
    return table(rs_output);
end
;

call FACT_METRICS('CLAIMS_MART',0);




declare
    rs resultset;
    rs_output resultset;
begin
    -- get relevant tables
    let db :='RDA1_SOURCE';
    let db_catalog:= db||'.INFORMATION_SCHEMA.tables';
    let table_schema :='DW_REPORT';
        
    rs := (select table_schema, table_name from IDENTIFIER(:db_catalog) where TABLE_SCHEMA != 'INFORMATION_SCHEMA' and TABLE_SCHEMA = :table_schema);

    let tmp_array := ARRAY_CONSTRUCT();
    let table_count :=0;let i:=0;
    for arow_rs in rs do
        i:=i+1;
        let aschema := '"'||arow_rs.table_schema::TEXT||'"';
        let atable := '"'||arow_rs.table_name::TEXT||'"';
        
        let qualified_table:=db||'.'||aschema||'.'||atable;
        
        select count(*) into table_count from  identifier(:qualified_table);
        tmp_array := array_append(:tmp_array, 
                                    OBJECT_CONSTRUCT(
                                        'table_name', arow_rs.table_name, 
                                        'table_schema', arow_rs.table_schema,
                                        'count', table_count)
                                  );
        if (i> 10) then break;end if;
    end for;
    rs_output := (select 
                    value:table_schema::text as table_schema,
                    value:table_name::text as table_name,
                    value:count::number as table_count 
                  from table(flatten(:tmp_array)));
    return table(rs_output);
end;

select sum("LINE_UNITS_OF_PAID_SERVICE_COUNT") as total, 
        min("LINE_UNITS_OF_PAID_SERVICE_COUNT") as minval, 
        max("LINE_UNITS_OF_PAID_SERVICE_COUNT") as maxval 
from DEV_EDW.MEDICAL_MART.FACT_CONSOLIDATED_MEDICAL_BILLING;




create or replace procedure FACT_METRICS (MARTNAME TEXT, cutoff number)
    RETURNS TABLE ( db text, table_schema text, table_name text, table_column text, numrows number, total number, min_val number, max_val number, row_avg number)
    LANGUAGE SQL
    EXECUTE AS OWNER
    as
declare
    rs resultset;
    rs2 resultset;
    rs_output resultset;
begin
    -- get relevant tables
    let db :='DEV_EDW';
    let db_catalog:= db||'.INFORMATION_SCHEMA.columns';
    -- let table_schema :='MEDICAL_MART';
    let table_schema := :MARTNAME;
    let cut_off := :CUTOFF;
    
    let col_type := 'NUMBER';
    rs := (select table_schema, table_name, column_name from 
            IDENTIFIER(:db_catalog) where (COLUMN_NAME like '%COUNT' or COLUMN_NAME like '%AMOUNT') and TABLE_SCHEMA != 'INFORMATION_SCHEMA'
             and TABLE_SCHEMA = :table_schema and DATA_TYPE = :col_type);

    let tmp_array := ARRAY_CONSTRUCT();
    let table_count :=0;let i:=0;
    for arow_rs in rs do
        i:=i+1;
        let aschema := '"'||arow_rs.table_schema::TEXT||'"';
        let atable := '"'||arow_rs.table_name::TEXT||'"';
        let acol := '"'||arow_rs.column_name::TEXT||'"';
        let qualified_table:=db||'.'||aschema||'.'||atable;
        --        
        let query := 'select count('||acol||') as numrows, sum('||acol||') as total, min('||acol||') as minval, max('||acol||') as maxval, avg('||acol||') as rowavg from '|| qualified_table;
        rs2 :=  ( execute immediate :query    );
        
        for arow_rs2 in rs2 do
          let numrows  := arow_rs2.numrows::INTEGER;
          let total  := arow_rs2.total::INTEGER;
          let minval := arow_rs2.minval::text;
          let maxval := arow_rs2.maxval::text;
          let rowavg := arow_rs2.rowavg::number;
          let obj :=  OBJECT_CONSTRUCT('db',db,'table_name', atable,'table_schema', aschema,'column',acol, 'numrows',numrows, 'total',total, 'min_val',minval, 'max_val',maxval);
          tmp_array := array_append(:tmp_array, obj );
       end for;
       
       if (cut_off <= 0) then cut_off := 1000; end if;
       if (i>= cut_off) then break; end if;
    
    end for;
    rs_output := (select 
                    value:db::text as db,
                    value:table_schema::text as table_schema,
                    value:table_name::text as table_name,
                    value:column::text     ||
                    IFF(value:total::number=0,'  *','') as table_column,
                    value:numrows::number as numrows,
                    value:total::number as total,
                    value:min_val::number as min_val,
                    value:max_val::number as max_val,
                    trunc( (total/numrows), 2) as row_avg
                  from table(flatten(:tmp_array)));
    return table(rs_output);
end
;

grant usage on procedure DEV_EDW_32600145.PUBLIC.FACT_METRICS(varchar, number) to PUBLIC;

call FACT_METRICS('CLAIMS_MART',0);

use database dev_edw;



----- Create 3 parameter table profiler
create or replace procedure TABLE_PROFILE (DBNAME TEXT, TSCHEMA TEXT, TNAME TEXT)
    RETURNS TABLE ( TABLE_DB text, TABLE_SCHEMA text, TABLE_NAME text, FIELD_NAME text, TOTAL_ROWS number, TOTAL_VALS number, TOTAL_BLANKS number, PCT_POP number, PCT_DIST number, MIN_VAL text, MAX_VAL text, TOP_RANK text, TOP_RANK_COUNT number, NONBLANK_TOP_RANK text,  NONBLANK_TOP_RANK_COUNT number, NONBLANK_TOP_RANK_LENGTH number, BOTTOM_RANK text, BOTTOM_RANK_COUNT number, BOTTOM_RANK_LENGTH number )
    LANGUAGE SQL
    EXECUTE AS CALLER
    as
declare
    rs resultset;
    rs2 resultset;
    rs_output resultset;
begin
    -- get relevant tables
    let db := :DBNAME;
    let db_catalog := db||'.INFORMATION_SCHEMA.columns';
    let table_schema := :TSCHEMA;
    let table_name := :TNAME;
    
    rs := (select table_catalog, table_schema, table_name, column_name, data_type 
           from IDENTIFIER(:db_catalog)
             where TABLE_SCHEMA != 'INFORMATION_SCHEMA'
               and TABLE_SCHEMA = :table_schema and table_name = :table_name);

    let tmp_array := ARRAY_CONSTRUCT();
    let table_count :=0;let i:=0;
    for arow_rs in rs do
        i:=i+1;

        let adb     := '"'|| arow_rs.table_catalog::TEXT || '"';
        let aschema := '"'|| arow_rs.table_schema::TEXT || '"';
        let atable  := '"'|| arow_rs.table_name::TEXT ||'"';
        let acol    := '"'|| arow_rs.column_name::TEXT ||'"';
        let adt     := arow_rs.data_type::TEXT;
        let qualified_table := adb||'.'||aschema||'.'||atable;     

        let query := 'with DIST as ( select '''||adb||''' as table_db, '''||aschema||''' as table_schema, '''||atable||''' as table_name, '''||acol||''' as fld_nm, '||acol||'  as fld_val, count(*) as numrows, sum( case when trim(nvl(to_char(fld_val),'''')) ='''' then 1 else 0 end ) as numblanks from ' ||qualified_table|| ' group by fld_val ), RANKING as ( select table_db, table_schema, table_name, fld_nm, fld_val, numrows, numblanks, dense_rank() over(order by numrows desc) as rank_asc, dense_rank() over(order by (case when fld_val is null then -1 else numrows end)  desc) as nonblank_rank_asc, dense_rank() over( order by numrows) as rank_desc from DIST ) select current_date, table_db, table_schema, table_name, fld_nm , sum(numrows) as total_rows,count(distinct fld_val) as total_vals, sum(numblanks) as total_blanks, min( fld_val ) as min_val, max( fld_val ) as max_val, max( case when rank_asc = 1 then fld_val else null end ) as top_rank, max( case when rank_asc = 1 then numrows else 0 end ) as top_rank_count, max( case when nonblank_rank_asc = 1 then fld_val else null end ) as nonblank_top_rank, max( case when nonblank_rank_asc = 1 then numrows else 0 end ) as nonblank_top_rank_count, length( nonblank_top_rank ) as nonblank_top_rank_length, max( case when rank_desc = 1 then fld_val else null end ) as bottom_rank, max( case when rank_desc = 1 then numrows else 0 end ) as bottom_rank_count, length( bottom_rank ) as bottom_rank_length from RANKING  group by table_db, table_schema, table_name, fld_nm';
        rs2 :=  ( execute immediate :query    );

        for arow_rs2 in rs2 do
          let table_db           := arow_rs2.table_db::text;
          let table_schema       := arow_rs2.table_schema::text;
          let field_name         := arow_rs2.fld_nm::text;
          let table_name         := arow_rs2.table_name::text;
          let total_rows         := arow_rs2.total_rows::number;
          let total_vals         := arow_rs2.total_vals::number;
          let total_blanks       := arow_rs2.total_blanks::number;
          let min_val            := arow_rs2.min_val::text;
          let max_val            := arow_rs2.max_val::text;
          let top_rank           := arow_rs2.top_rank::text;
          let top_rank_count     := arow_rs2.top_rank_count::number;
          let nonblank_top_rank  := arow_rs2.nonblank_top_rank::text;
          let nonblank_top_rank_count      := arow_rs2.nonblank_top_rank_count::number;
          let nonblank_top_rank_length     := arow_rs2.nonblank_top_rank_length::number; 
          let bottom_rank           := arow_rs2.bottom_rank::text;
          let bottom_rank_count     := arow_rs2.bottom_rank_count::number;
          let bottom_rank_length    := arow_rs2.bottom_rank_length::number;
          let obj       :=  OBJECT_CONSTRUCT('table_db',table_db, 'table_schema',table_schema, 'table_name',table_name, 'field_name',field_name, 'total_rows',total_rows, 'total_vals',total_vals, 'total_blanks',total_blanks, 'min_val',min_val, 'max_val',max_val, 'top_rank',top_rank, 'top_rank_count',top_rank_count, 'nonblank_top_rank',nonblank_top_rank, 'nonblank_top_rank_count',nonblank_top_rank_count, 'nonblank_top_rank_length',nonblank_top_rank_length, 'bottom_rank',bottom_rank, 'bottom_rank_count',bottom_rank_count,  'bottom_rank_length',bottom_rank_length );
          tmp_array := array_append(:tmp_array, obj );
        end for;

    end for;

    rs_output := (select 
                    value:table_db::text                    as table_db,
                    value:table_schema::text                as table_schema,
                    value:table_name::text                  as table_name,
                    value:field_name::text                  ||
                    IFF(value:total_vals::number=1,'  *','')  as field_name,
                    value:total_rows::number                as total_rows,
                    value:total_vals::number                as total_vals,
                    value:total_blanks::number              as total_blanks,
                    trunc( ((total_rows-total_blanks) / total_rows )*100, 2)    as pct_pop,
                    trunc( (total_vals / total_rows)*100, 2)    as pct_dist,
                    value:min_val::text                     as min_val,
                    value:max_val::text                     as max_val,
                    value:top_rank::text                    as top_rank,                  
                    value:top_rank_count::number            as top_rank_count,                  
                    value:nonblank_top_rank::text           as nonblank_top_rank,                  
                    value:nonblank_top_rank_count::number   as nonblank_top_rank_count,
                    value:nonblank_top_rank_length::number  as nonblank_top_rank_length,
                    value:bottom_rank::text                 as bottom_rank,                  
                    value:bottom_rank_count::number         as bottom_rank_count,                  
                    value:bottom_rank_length::number        as bottom_rank_length
                  from table(flatten(:tmp_array))
                 order by field_name);
    return table(rs_output);
end;


grant usage on PROCEDURE TABLE_PROFILE(varchar, varchar) TO PUBLIC;
grant usage on PROCEDURE TABLE_PROFILE(varchar, varchar, varchar) TO PUBLIC;

use database dev_edw;


call dev_edw.public.TABLE_PROFILE ('DEV_EDW','STAGING', 'DST_ACTIVITY');

call TABLE_PROFILE ('DEV_EDW_32600145','STAGING', 'DST_ACTIVITY');

call TABLE_PROFILE( 'RDA1_SOURCE', 'BWC_PEACH', 'TMPCOMD');

select * from DEV_EDW.INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS;


SELECT * FROM INFORMATION_SCHEMA.COLUMNS;



call dev_edw.public.FACT_METRICS ('CLAIMS_MART', 0);


call TABLE_PROFILE ('CLAIMS_MART', 'FACT_CLAIM_PROGRESS_SNAPSHOT');

call TABLE_PROFILE ('DW_SANDBOX', 'DST_EARNED_PREMIUM_BILLS');

use database dev_edw_32600145;

select *  from STAGING.DST_ACTIVITY;

create or replace table DEV_EDW_32600145.STAGING.DST_ACTIVITY2 as select * from DEV_EDW.STAGING.DST_ACTIVITY where actv_actn_typ_nm = 'ADDED';

select actv_actn_typ_nm, count(1) from  DEV_EDW_32600145.STAGING.DST_ACTIVITY group by 1;

show procedures;



drop procedure TABLE_PROFILE (varchar, varchar, varchar);
drop procedure TABLE_PROFILE( varchar, varchar);

describe procedure TABLE_PROFILE( varchar, varchar);

call FACT_METRICS('MEDICAL_MART',0);


call run_audits();

select * from DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS ;
select * from DEV_EDW_32600145.STAGING.AUDIT_VALIDATION;
select * from DEV_EDW_32600145.STAGING.AUDIT_JSON;

select * from DEV_EDW_32600145.STAGING.DATA_PROFILE ;



/*



--insert into DEV_EDW_32600145.staging.data_profile 

with 
DIST as ( select 'DEV_EDW.DIMENSIONS' as table_schema, 'DIM_EDIT' as table_name, 'EDIT_CODE' as fld_nm, EDIT_CODE as fld_val, 
    count(*) as numrows, sum( case when fld_val is null then 1 else 0 end ) as numblanks
    from DEV_EDW.DIMENSIONS.DIM_EDIT  WHERE PRIMARY_SOURCE_SYSTEM <>'MANUAL ENTRY' group by fld_val ),  
RANKING as ( select table_schema, table_name, fld_nm, fld_val, 
    numrows, numblanks,   
    dense_rank() over(order by numrows desc) as rank_asc,  
    dense_rank() over(order by (case when fld_val is null then -1 else numrows end)  desc) as nonblank_rank_asc,  
    dense_rank() over( order by numrows) as rank_desc from DIST )  
select current_date, table_schema, table_name, fld_nm ,
    sum(numrows) as total_rows  
    ,count(distinct fld_val) as total_vals  
    ,sum(numblanks) as total_blanks  
    ,min( fld_val ) as min_val
    ,max( fld_val ) as max_val
    ,max( case when rank_asc = 1 then fld_val else null end ) as top_rank  
    ,max( case when rank_asc = 1 then numrows else 0 end ) as top_rank_count 
    ,max( case when nonblank_rank_asc = 1 then fld_val else null end ) as nonblank_top_rank  
    ,max( case when nonblank_rank_asc = 1 then numrows else 0 end ) as nonblank_top_rank_count  
    ,length( nonblank_top_rank ) as nonblank_top_rank_length  
    ,max( case when rank_desc = 1 then fld_val else null end ) as bottom_rank  
    ,max( case when rank_desc = 1 then numrows else 0 end ) as bottom_rank_count
    ,length( bottom_rank ) as bottom_rank_length 
 from ranking  group by table_schema, table_name, fld_nm;

*/
;
SELECT * FROM STAGING.DST_ACTIVITY LIMIT 10;

/*
with DIST as ( 'STAGING' as table_schema, 'DST_ACTIVITY' as table_name, 'SUBLOC_TYP_NM' as fld_nm, SUBLOC_TYP_NM  as fld_val, count(*) as numrows, sum( case when fld_val is null then 1 else 0 end ) as numblanks from STAGING.DST_ACTIVITY group by fld_val ), RANKING as ( select table_schema, table_name, fld_nm, fld_val, numrows, numblanks, dense_rank() over(order by numrows desc) as rank_asc, dense_rank() over(order by (case when fld_val is null then -1 else numrows end)  desc) as nonblank_rank_asc, dense_rank() over( order by numrows) as rank_desc from DIST ) select current_date, table_schema, table_name, fld_nm , sum(numrows) as total_rows,count(distinct fld_val) as total_vals, sum(numblanks) as total_blanks, min( fld_val ) as min_val, max( fld_val ) as max_val, max( case when rank_asc = 1 then fld_val else null end ) as top_rank, max( case when rank_asc = 1 then numrows else 0 end ) as top_rank_count, max( case when nonblank_rank_asc = 1 then fld_val else null end ) as nonblank_top_rank, max( case when nonblank_rank_asc = 1 then numrows else 0 end ) as nonblank_top_rank_count, length( nonblank_top_rank ) as nonblank_top_rank_length, max( case when rank_desc = 1 then fld_val else null end ) as bottom_rank, max( case when rank_desc = 1 then numrows else 0 end ) as bottom_rank_count, length( bottom_rank ) as bottom_rank_length from RANKING  group by table_schema, table_name, fld_nm;
*/



ALTER TABLE EDW_STG_CLAIMS_MART.FLF_CLAIM_PARTICIPATION
ADD PRIMARY KEY (CLAIM_HKEY,PARTICIPATION_TYPE_HKEY,CUSTOMER_HKEY,PARTICIPATION_EFFECTIVE_DATE_KEY,PARTICIPATION_END_DATE_KEY);
ALTER TABLE EDW_STG_CLAIMS_MART.FLF_CLAIM_PARTICIPATION
ADD CONSTRAINT Claim_Participation_Claim_fk FOREIGN KEY (CLAIM_HKEY) REFERENCES DIMENSIONS.DIM_CLAIM (CLAIM_HKEY);
ALTER TABLE EDW_STG_CLAIMS_MART.FLF_CLAIM_PARTICIPATION
ADD CONSTRAINT Claim_Participation_Participation_Type_fk FOREIGN KEY (PARTICIPATION_TYPE_HKEY) REFERENCES DIMENSIONS.DIM_PARTICIPATION_TYPE (PARTICIPATION_TYPE_HKEY);
ALTER TABLE EDW_STG_CLAIMS_MART.FLF_CLAIM_PARTICIPATION
ADD CONSTRAINT Claim_Participation_Customer_fk FOREIGN KEY (CUSTOMER_HKEY) REFERENCES DIMENSIONS.DIM_CUSTOMER (CUSTOMER_HKEY);
ALTER TABLE EDW_STG_CLAIMS_MART.FLF_CLAIM_PARTICIPATION
ADD CONSTRAINT Claim_Participation_User_fk FOREIGN KEY (CREATE_USER_HKEY) REFERENCES DIMENSIONS.DIM_USER (USER_HKEY);
ALTER TABLE EDW_STG_CLAIMS_MART.FLF_CLAIM_PARTICIPATION
ADD CONSTRAINT Claim_Participation_Effective_Date_fk FOREIGN KEY (PARTICIPATION_EFFECTIVE_DATE_KEY) REFERENCES DIMENSIONS.DIM_DATE (DATE_KEY);
ALTER TABLE EDW_STG_CLAIMS_MART.FLF_CLAIM_PARTICIPATION
ADD CONSTRAINT Claim_Participation_End_Date_fk FOREIGN KEY (PARTICIPATION_END_DATE_KEY) REFERENCES DIMENSIONS.DIM_DATE (DATE_KEY);
ALTER TABLE EDW_STG_CLAIMS_MART.FLF_CLAIM_PARTICIPATION
ADD CONSTRAINT Claim_Participation_Update_User_fk FOREIGN KEY (UPDATE_USER_HKEY) REFERENCES DIMENSIONS.DIM_USER (USER_HKEY);
ALTER TABLE EDW_STG_CLAIMS_MART.FLF_CLAIM_PARTICIPATION
ADD CONSTRAINT Claim_Participation_Create_Date_fk FOREIGN KEY (CREATE_DATE_KEY) REFERENCES DIMENSIONS.DIM_DATE (DATE_KEY);
ALTER TABLE EDW_STG_CLAIMS_MART.FLF_CLAIM_PARTICIPATION
ADD CONSTRAINT Claim_Participation_Update_Date_fk FOREIGN KEY (UPDATE_DATE_KEY) REFERENCES DIMENSIONS.DIM_DATE (DATE_KEY); 














begin
    let rs RESUlTSET := (select 1,'a','b','c');
    return table(rs);
end;


declare
    rs resultset;
begin
    let db := 'UAT2_EDW';
    let db_catalog := db || '.INFORMATION_SCHEMA.TABLES';
    let table_schema := 'DIMENSIONS';
    
    rs := (select table_schema, table_name from IDENTIFIER(:db_catalog)  where TABLE_SCHEMA != 'INFORMATION_SCHEMA' and TABLE_SCHEMA = :table_schema );

    for arow_rs in rs do
        return arow_rs.table_name;
    end for;
end;

----------

select  note_text_text,
        regexp_replace(note_text_text,'[A-Za-z0-9 ]','') as nonalpha
from DEV_SOURCE.PCMP_2021_10_17.NOTE_TEXT
where ilike(note_text_text,'[\r\n\t]+') ;
limit 100;

select * from DEV_SOURCE.PCMP.BWC_INTERFACE_NOTES_IN limit 100;


select cust_addr_str_1,
        case when trim(cust_addr_str_1) = '' then 1 else 0 end as MT_flag
from DEV_EDW_32600145.STAGING.STG_CUSTOMER_ADDRESS
where trim(cust_addr_str_1) = '' ;or 
cust_addr_str_1 is null;

select cust_addr_end_date,
        case when trim(nvl(to_char(cust_addr_end_date),'')) = '' then 1 else 0 end as MT_flag
from DEV_EDW_32600145.STAGING.STG_CUSTOMER_ADDRESS
where --trim(cust_addr_str_1) = '' ;or 
cust_addr_end_date is null;

select * from DEV_EDW_32600145.STAGING.STG_CUSTOMER_ADDRESS;





with DIST as ( select 'DEV_EDW.STAGING' as table_schema, 'STG_CUSTOMER_ADDRESS' as table_name
	, 'CUST_ADDR_STR_1' as fld_nm, CUST_ADDR_STR_1 as fld_val
	, count(*) as numrows
    , sum( case when trim(nvl(to_char(fld_val),'')) ='' then 1 else 0 end ) as numblanks
    , sum( case when fld_val is null then 1 else 0 end ) as numnulls 
	from DEV_EDW.STAGING.STG_CUSTOMER_ADDRESS
	group by fld_val ),  
RANKING as ( select table_schema, table_name, fld_nm, fld_val, numrows, numblanks, numnulls
	,  dense_rank() over(order by numrows desc) as rank_asc
	,  dense_rank() over(order by (case when fld_val is null then 10 else numrows end)  desc) as nonblank_rank_asc
	,  dense_rank() over( order by numrows) as rank_desc from DIST)    
select current_date, table_schema, table_name, fld_nm 
	, sum(numrows) as total_rows  
	, count(distinct fld_val) as total_vals ,sum(numblanks) as total_blanks, sum(numnulls) as total_nulls 
	, max( case when rank_asc = 1 then fld_val else null end ) as top_rank  
	, max( case when rank_asc = 1 then numrows else 0 end ) as top_rank_count 
	, max( case when nonblank_rank_asc = 1 then fld_val else null end ) as nonblank_top_rank  
	, max( case when nonblank_rank_asc = 1 then numrows else 0 end ) as nonblank_top_rank_count  
	, length( nonblank_top_rank ) as nonblank_top_rank_length 
	, max( case when rank_desc = 1 then fld_val else null end ) as bottom_rank  
	, max( case when rank_desc = 1 then numrows else 0 end ) as bottom_rank_count 
	, length( bottom_rank ) as bottom_rank_length  
	from ranking  
	group by table_schema, table_name, fld_nm;



    let qry := 'select table_catalog, table_schema, table_name, column_name, data_type from ' ||:db_catalog||' where TABLE_SCHEMA != ''INFORMATION_SCHEMA'' and TABLE_SCHEMA = '''||:table_schema||''' and table_name = '''||:table_name||''' ';











begin
    let rs RESUlTSET := (select 1,'a','b','c');
    return table(rs);
end;


declare
    rs resultset;
begin
    let db := 'UAT2_EDW';
    let db_catalog := db || '.INFORMATION_SCHEMA.TABLES';
    let table_schema := 'DIMENSIONS';
    
    rs := (select table_schema, table_name from IDENTIFIER(:db_catalog)  where TABLE_SCHEMA != 'INFORMATION_SCHEMA' and TABLE_SCHEMA = :table_schema );

    for arow_rs in rs do
        return arow_rs.table_name;
    end for;
end;

-----

use database DEV_EDW;
use schema public;

create or replace procedure BUILD_VIEWS (SRC_DBNAME TEXT, SRC_SCHEMA TEXT, TGT_DBNAME TEXT, TGT_SCHEMA TEXT)
RETURNS VARCHAR
    LANGUAGE SQL
    EXECUTE AS CALLER
    as
$$
DECLARE
    rs resultset;
BEGIN
    let src_db  := :SRC_DBNAME ;
    let db_catalog := src_db||'.INFORMATION_SCHEMA.tables';
    let s_schema := :SRC_SCHEMA ;
    let tgt_db := :TGT_DBNAME ;
    let t_schema := :TGT_SCHEMA ;
    let qry_option := ' OR REPLACE ';
    
    rs := (select table_catalog, table_schema, table_name 
           from IDENTIFIER(:db_catalog)
             where TABLE_SCHEMA != 'INFORMATION_SCHEMA'
               and TABLE_SCHEMA = :s_schema ); 
           
    let tmp_array := ARRAY_CONSTRUCT();
    let table_count :=0;let i:=0;
    for arow_rs in rs do
        let adb     := '"'|| arow_rs.table_catalog::TEXT || '"';
        let aschema := '"'|| arow_rs.table_schema::TEXT || '"';
        let atable  := '"'|| arow_rs.table_name::TEXT ||'"';
        let src_qtable := adb||'.'||aschema||'.'||atable;     
        let tgt_view := '"'|| tgt_db::TEXT || '"."' || t_schema::TEXT || '"."' || arow_rs.table_name || '"';
           
        let query := 'CREATE ' || qry_option || ' VIEW ' || tgt_view || ' as select * from ' || src_qtable || ';';
        EXECUTE IMMEDIATE ( query );
    end for;

END;
$$
;      


    Set src_db = 'DEV_EDW_32600145'; 
    Set db_catalog = $src_db||'.INFORMATION_SCHEMA.tables' ;
    Set s_schema = 'HISTORY' ;
    Set tgt_db = 'DEV_EDW_32600145' ;
    Set tgt_catalog = :tgt_db||'.INFORMATION_SCHEMA.tables';
    Set t_schema = 'PUBLIC' ;

select * from DEV_EDW_32600145.information_schema.tables;

select  table_name as TABLE_NAME from DEV_EDW_32600145.information_schema.tables where TABLE_SCHEMA != 'INFORMATION_SCHEMA' and TABLE_SCHEMA = 'SANDBOX'
INTERSECT 
select  table_name as tbl from DEV_EDW_32600145.information_schema.tables where TABLE_SCHEMA != 'INFORMATION_SCHEMA' and TABLE_SCHEMA = 'PUBLIC';

use database DEV_EDW_32600145;
use schema PUBLIC;

with vw as (select * from information_schema.views
           where table_schema = 'SANDBOX')
select 'DROP VIEW IF EXISTS '|| table_catalog || '.' || table_schema || '.' || table_name || ' ;'
from vw;

call DEV_EDW.PUBLIC.BUILD_VIEWS( 'DEV_EDW_32600145','PUBLIC', 'DEV_EDW_32600145','SANDBOX' );



----- Create 3 parameter table profiler
create or replace procedure BUILD_VIEWS (SRC_DBNAME TEXT, SRC_SCHEMA TEXT, TGT_DBNAME TEXT, TGT_SCHEMA TEXT)
RETURNS VARCHAR
    LANGUAGE SQL
    EXECUTE AS CALLER
    as
$$
DECLARE
    rs resultset;
BEGIN
    let src_db  := :SRC_DBNAME ;
    let db_catalog := src_db||'.INFORMATION_SCHEMA.tables';
    let s_schema := :SRC_SCHEMA ;
    let tgt_db := :TGT_DBNAME ;
    let tgt_catalog := tgt_db||'.INFORMATION_SCHEMA.tables';
    let t_schema := :TGT_SCHEMA ;
    let qry_option := ' OR REPLACE ';
                  
    dt := (select  table_schema ||'.'||table_name as tbl from IDENTIFIER(:db_catalog) where TABLE_SCHEMA != 'INFORMATION_SCHEMA'
               and TABLE_SCHEMA = :s_schema 
           INTERSECT
            select  table_schema ||'.'||table_name as tbl from IDENTIFIER(:tgt_catalog) where TABLE_SCHEMA != 'INFORMATION_SCHEMA'
               and TABLE_SCHEMA = :t_schema ); 
    
    for arow_dt in dt do
        let tgt_view := '"'|| tgt_db::TEXT || '"."' || arow_dt.table_name || '"'; 
        let drop_tbl := 'DROP TABLE IF EXISTS ' || tgt_view ||';';
        EXECUTE IMMEDIATE ( drop_tbl );
    end for;
    
    rs := (select table_catalog, table_schema, table_name from IDENTIFIER(:db_catalog) where TABLE_SCHEMA != 'INFORMATION_SCHEMA' and TABLE_SCHEMA = :s_schema ); 
 
    for arow_rs in rs do
        let adb     := '"'|| arow_rs.table_catalog::TEXT || '"';
        let aschema := '"'|| arow_rs.table_schema::TEXT || '"';
        let atable  := '"'|| arow_rs.table_name::TEXT ||'"';
        let src_qtable := adb||'.'||aschema||'.'||atable;     
        let tgt_view := '"'|| tgt_db::TEXT || '"."' || t_schema::TEXT || '"."' || arow_rs.table_name || '"';
        
        -- let drop_tbl := 'DROP TABLE IF EXISTS ' || tgt_view ||';';
        -- EXECUTE IMMEDIATE ( drop_tbl );
        
        let query := 'CREATE ' || qry_option || ' VIEW ' || tgt_view || ' as select * from ' || src_qtable || ';';
        EXECUTE IMMEDIATE ( query );
    end for;

END;
$$
;          


with vw as (select table_catalog || '.' || table_schema || '.' || table_name as tbl
            from information_schema.tables
           where table_schema = 'SANDBOX'
           INTERSECT
           select table_catalog || '.' || table_schema || '.' || table_name as tbl
            from information_schema.tables
           where table_schema = 'SANDBOX')
select 'DROP TABLE IF EXISTS '|| table_catalog || '.' || table_schema || '.' || table_name || ' ;'
from vw;


with vw as (select * from information_schema.views
           where table_schema = 'SANDBOX')
select 'DROP VIEW IF EXISTS '|| table_catalog || '.' || table_schema || '.' || table_name || ' ;'
from vw;

call BUILD_VIEWS( 'DEV_EDW_32600145','PUBLIC', 'DEV_EDW_32600145','SANDBOX' );

DROP VIEW IF EXISTS DEV_EDW_32600145.SANDBOX.AUDIT_TBL ;
DROP VIEW IF EXISTS DEV_EDW_32600145.SANDBOX.CLAIMANT ;
DROP VIEW IF EXISTS DEV_EDW_32600145.SANDBOX.CLAIMS ;
DROP VIEW IF EXISTS DEV_EDW_32600145.SANDBOX.CTYPES ;
DROP VIEW IF EXISTS DEV_EDW_32600145.SANDBOX.EXAMPLE ;
DROP VIEW IF EXISTS DEV_EDW_32600145.SANDBOX.JSON_WEATHER_DATA_VIEW ;
DROP VIEW IF EXISTS DEV_EDW_32600145.SANDBOX.PIVOT_TEST ;
DROP VIEW IF EXISTS DEV_EDW_32600145.SANDBOX.POLICIES ;
DROP VIEW IF EXISTS DEV_EDW_32600145.SANDBOX.RANDOM_DATES ;
DROP VIEW IF EXISTS DEV_EDW_32600145.SANDBOX.SCDTEST ;
DROP VIEW IF EXISTS DEV_EDW_32600145.SANDBOX.TEST ;
DROP VIEW IF EXISTS DEV_EDW_32600145.SANDBOX.TESTTABLE ;
DROP VIEW IF EXISTS DEV_EDW_32600145.SANDBOX.TESTVIEW ;

drop view if exists DEV_EDW_32600145.SANDBOX.TEST ;

create table DEV_EDW_32600145.SANDBOX.TEST clone DEV_EDW_32600145.PUBLIC.TEST ;

declare
    rs resultset;
begin
    let db := 'UAT2_EDW';
    let db_catalog := db || '.INFORMATION_SCHEMA.TABLES';
    let table_schema := 'DIMENSIONS';
    
    rs := (select table_schema, table_name from IDENTIFIER(:db_catalog)  
           where TABLE_SCHEMA != 'INFORMATION_SCHEMA' and TABLE_SCHEMA = :table_schema );

    for arow_rs in rs do
        return arow_rs.table_name;
    end for;

end;

DECLARE
    rs resultset;
BEGIN
    let src_db  := 'DEV_EDW_32600145'; 
    let db_catalog := :src_db||'.INFORMATION_SCHEMA.tables' ;
    let s_schema := 'HISTORY' ;
    let tgt_db := 'DEV_EDW_32600145' ;
    let tgt_catalog := :tgt_db||'.INFORMATION_SCHEMA.tables';
    let t_schema := 'PUBLIC' ;
    let qry_option := ' OR REPLACE ';
   
   dt := (select  table_schema ||'.'||table_name as TABLE_NAME from IDENTIFIER(:db_catalog) where TABLE_SCHEMA != 'INFORMATION_SCHEMA' and TABLE_SCHEMA = :s_schema  INTERSECT select  table_schema ||'.'||table_name as tbl from IDENTIFIER(:tgt_catalog) where TABLE_SCHEMA != 'INFORMATION_SCHEMA' and TABLE_SCHEMA = :t_schema ); 
        
    for arow_dt in dt do
        let tgt_view := '"'|| tgt_db::TEXT || '"."' || arow_dt.table_name || '"'; 
        let drop_tbl := 'DROP TABLE IF EXISTS ' || tgt_view ||';';
        EXECUTE IMMEDIATE ( drop_tbl );
    end for;
    
    rs := (select table_catalog, table_schema, table_name from IDENTIFIER(:db_catalog) where TABLE_SCHEMA != 'INFORMATION_SCHEMA' and TABLE_SCHEMA = :s_schema );
    
    for arow_rs in RS2 do
        let adb     := '"'|| arow_rs.table_catalog::TEXT || '"';
        let aschema := '"'|| arow_rs.table_schema::TEXT || '"';
        let atable  := '"'|| arow_rs.table_name::TEXT ||'"';
        let src_qtable := adb||'.'||aschema||'.'||atable;     
        let tgt_view := '"'|| tgt_db::TEXT || '"."' || t_schema::TEXT || '"."' || arow_rs.table_name || '"';
        
        -- let drop_tbl := 'DROP TABLE IF EXISTS ' || tgt_view ||';';
        -- EXECUTE IMMEDIATE ( drop_tbl );
        
        let query := 'CREATE ' || qry_option || ' VIEW ' || tgt_view || ' as select * from ' || src_qtable || ';';
        EXECUTE IMMEDIATE ( query );
    end for;

END;

           
           
call VIEW_BUILDER();


---- 
--select * from DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS;
--create table DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS_ORIG as select * from DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS;

truncate table DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS;

select * from AUDIT_SCRIPTS;

--Executed using the following:
-- call run_audits();

with fails as (
select * from DEV_EDW_32600145.STAGING.AUDIT_JSON   where audit_dt = current_date()
  and src <> tgt)
select src_name, tgt_name, groupby, count(src) from fails
group by 1,2,3 order by 1,2,3;

create or replace procedure run_audits()
   returns varchar not null
   language javascript
   as
   $$
var return_value = "";
var sql_query = "select INSERT_STMT from DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS" ;
   var sql_statement = snowflake.createStatement(
          {
          sqlText: sql_query
          }
       );

var result_scan = sql_statement.execute();
   while (result_scan.next())  {
       sql2run = snowflake.createStatement ({sqlText: result_scan.getColumnValue(1)  });
       var sqlrun = sql2run.execute();
       }return return_value;
$$
;


/*
create or replace TABLE  DEV_EDW_32600145.STAGING.AUDIT_JSON (
	AUDIT_DT    DATE,
    AUDIT_ID    NUMBER,
	SRC_NAME    TEXT,
	TGT_NAME    TEXT,
	GROUPBY     TEXT,
	SRC         OBJECT,
	TGT         OBJECT
);
*/

--delete from DEV_EDW_32600145.STAGING.AUDIT_JSON where audit_dt >= current_date-1;

--#################################################################################################
--
-- FACT_HOSPITAL_INPATIENT_BILLING
--
--#################################################################################################
-- OVERALL
--#################################################################################################

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                     AS GROUPVAL,
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                     AS GROUPVAL,
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''OVERALL''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING P 
    join DIMENSIONS.DIM_DATE D
    ON ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''YEAR(RECEIPT_DATE)''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( REVENUE_CENTER_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( HOSPITAL_REVENUE_CENTER_CODE::text, ''~NA'')     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_REVENUE_CENTER R
    ON ( I.REVENUE_CENTER_HKEY = R.REVENUE_CENTER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''REVENUE_CENTER_CODE''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MCO_NUMBER::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NETWORK_NUMBER::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_NETWORK N
    ON ( I.SUBMITTING_NETWORK_HKEY = N.NETWORK_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MCO_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_NO::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( I.CLAIM_NUMBER::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM C
    on ( I.CLAIM_NUMBER = C.CLAIM_NUMBER )
        -- ON ( I.CLAIM_NUMBER_HKEY = C.CLAIM_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_NO''                                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_STATUS::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_HEADER_CURRENT_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''INVOICE_STATUS''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(LINE_STATUS_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_LINE_ITEM_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''LINE_STATUS_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CPT_PAYMENT_CATEGORY::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''PROCEDURE_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CUST_NO::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CUSTOMER_NUMBER::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INJURED_WORKER W
    ON ( I.INJURED_WORKER_HKEY = W.INJURED_WORKER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CUST_NO''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICING_PEACH_NUMBER::text, ''~NA'')                 AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROVIDER_PEACH_NUMBER::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_PROVIDER P
    ON ( I.SERVICE_PROVIDER_HKEY = P.PROVIDER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''SERVICING_PEACH_NUMBER''                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DIAGNOSIS_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ICD_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ICD P
    ON ( I.PRINCIPAL_ICD_HKEY = P.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''DIAGNOSIS_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADMISSION_TYPE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(HOSPITAL_ADMISSION_TYPE_CODE::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''ADMISSION_TYPE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADMISSION_SOURCE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_SOURCE_OF_ADMISSION_CODE::text, ''~NA'') AS GROUPVAL, 
    COUNT(*)                                        AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)         AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)           AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                    AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)        AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)    AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                   AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                       AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''ADMISSION_SOURCE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DISCHARGE_STATUS::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_HOSPITAL_DISCHARGE_STATUS_CODE::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''DISCHARGE_STATUS''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(BILL_TYPE::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_HOSPITAL_BILL_TYPE_CODE::text, ''~NA'')  AS GROUPVAL, 
    COUNT(*)                                        AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)         AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)           AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                    AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)        AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)    AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                   AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                       AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''BILL_TYPE''                                       as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FRMTTD_PRO_DRG::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(DIAGNOSIS_RELATED_GROUP_CODE::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_DIAGNOSIS_RELATED_GROUP P
    ON ( I.PROVIDER_SUBMITTED_DRG_HKEY = P.DRG_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''FRMTTD_PRO_DRG''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DRG_NUMBER::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(DIAGNOSIS_RELATED_GROUP_CODE::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_BWC_CALC_DRG_OUTPUT P
    ON ( I.BWC_CALC_DRG_OUTPUT_HKEY = P.BWC_CALC_DRG_OUTPUT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''DRG_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD1_MODIFIER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_1_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD1_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD2_MODIFIER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_2_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD2_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD3_MODIFIER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_3_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD3_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD4_MODIFIER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_4_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD4_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD_SET::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SET_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD_SET''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TYP_CD::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_TYPE_CODE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_TYP_CD''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STT_TYP_CD::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATE_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_STT_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STS_TYP_CD::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_STS_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_TRANS_RSN_TYP_CD''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_TYPE::text, ''~NA'')                           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_TYPE_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''INVOICE_TYPE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FEE_SCHEDULE::text, ''~NA'')                           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_FEE_SCHEDULE_DESC::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''FEE_SCHEDULE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_PAYMENT_CATEGORY::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''ADJUSTMENT_TYPE''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''PAID_ABOVE_ZERO_IND''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_FLAG::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(IN_SUBROGATION_IND::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''SUBROGATION_FLAG''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''SUBROGATION_TYPE_DESC''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INPUT_METHOD_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_INPUT_METHOD_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''INPUT_METHOD_CODE''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

    ---     added 2022-05-19
    ----POLICY STANDING
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''POLICY_TYPE_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_TYP_CD::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_STATUS_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''POLICY_STATUS_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_RSN_TYP_CD::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(STATUS_REASON_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''STATUS_REASON_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''POLICY_ACTIVE_IND''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) ');

    ---     added 2022-05-19


--#################################################################################################
--
-- FACT_HOSPITAL_OUTPATIENT_BILLING
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
            ''OVERALL''                                         as GROUPVAL,
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
            ''OVERALL''                                         as GROUPVAL,
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING O
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''OVERALL''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING P 
    join DIMENSIONS.DIM_DATE D
    ON ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''YEAR(RECEIPT_DATE)''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(REVENUE_CENTER_CODE::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE,
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(HOSPITAL_REVENUE_CENTER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_REVENUE_CENTER R
    ON ( I.REVENUE_CENTER_HKEY = R.REVENUE_CENTER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''REVENUE_CENTER_CODE''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MCO_NUMBER::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NETWORK_NUMBER::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_NETWORK N
    ON ( I.SUBMITTING_NETWORK_HKEY = N.NETWORK_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MCO_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLAIM_NUMBER::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO'' 
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(I.CLAIM_NUMBER::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM C
    on ( I.CLAIM_NUMBER = C.CLAIM_NUMBER )
        -- ON ( I.CLAIM_NUMBER_HKEY = C.CLAIM_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLAIM_NUMBER''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_STATUS::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_HEADER_CURRENT_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''INVOICE_STATUS''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(LINE_STATUS_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_LINE_ITEM_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''LINE_STATUS_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CPT_PAYMENT_CATEGORY::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PROCEDURE_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CUST_NO::text, ''~NA'')                                          AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CUSTOMER_NUMBER::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INJURED_WORKER W
    ON ( I.INJURED_WORKER_HKEY = W.INJURED_WORKER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CUST_NO''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICING_PEACH_NUMBER::text, ''~NA'')                           AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROVIDER_PEACH_NUMBER::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_PROVIDER P
    ON ( I.SERVICE_PROVIDER_HKEY = P.PROVIDER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''SERVICING_PEACH_NUMBER''                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DIAGNOSIS_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ICD_CODE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ICD P
    ON ( I.PRINCIPAL_ICD_HKEY = P.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''DIAGNOSIS_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADMISSION_TYPE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(HOSPITAL_ADMISSION_TYPE_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''ADMISSION_TYPE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADMISSION_SOURCE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_SOURCE_OF_ADMISSION_CODE::text, ''~NA'')         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''ADMISSION_SOURCE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DISCHARGE_STATUS::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_HOSPITAL_DISCHARGE_STATUS_CODE::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''DISCHARGE_STATUS''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(BILL_TYPE::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_HOSPITAL_BILL_TYPE_CODE::text, ''~NA'')          AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''BILL_TYPE''                                       as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(APC_CODE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_CODE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_AMBULATORY_PAYMENT_CLASSIFICATION P
    ON ( I.APC_HKEY = P.APC_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''APC_CODE''                                        as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(APC_STATUS::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_STATUS_INDICATOR_CODE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''APC_STATUS''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(NON_OPPS_BILL_TYPE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(OPPS_RETURN_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''NON_OPPS_BILL_TYPE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(OPPS_FLAG::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(OPPS_CODE::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''OPPS_FLAG''                                       as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_METHOD::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(OPPS_PAYMENT_METHOD_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_METHOD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DISCOUNT::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_DISCOUNTING_FRACTION_CODE::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''DISCOUNT''                                        as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(COMPOSITE_ADJUSTMENT::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_COMPOSITE_ADJUSTMENT_CODE::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''COMPOSITE_ADJUSTMENT''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_INDICATOR::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_PAYMENT_INDICATOR_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_INDICATOR''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PACKAGING::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_PACKAGING_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PACKAGING''                                       as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_ADJUSTMENT::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_PAYMENT_ADJUSTMENT_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_ADJUSTMENT''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD1_MODIFIER_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_1_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD1_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD2_MODIFIER_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_2_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD2_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD3_MODIFIER_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_3_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD3_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD4_MODIFIER_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_4_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD4_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD_SET::text, ''~NA'')                                          AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SET_CODE::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD_SET''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_TYPE_CODE::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLM_TYP_CD''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STT_TYP_CD::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATE_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLM_STT_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STS_TYP_CD::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_CODE::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLM_STS_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLM_TRANS_RSN_TYP_CD''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_TYPE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_TYPE_CODE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''INVOICE_TYPE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FEE_SCHEDULE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_FEE_SCHEDULE_DESC::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''FEE_SCHEDULE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_PAYMENT_CATEGORY::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''ADJUSTMENT_TYPE''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAID_ABOVE_ZERO_IND''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_FLAG::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(IN_SUBROGATION_IND::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''SUBROGATION_FLAG''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''SUBROGATION_TYPE_DESC''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INPUT_METHOD_CODE::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_INPUT_METHOD_CODE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''INPUT_METHOD_CODE''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

    -----  Added 2022-05-19

    ----POLICY_STANDING
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''POLICY_TYPE_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_TYP_CD::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_STATUS_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''POLICY_STATUS_CODE''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_RSN_TYP_CD::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(STATUS_REASON_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''STATUS_REASON_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 
        
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''POLICY_ACTIVE_IND''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 
    -----  Added 2022-05-19



--#################################################################################################
--
-- FACT_PROFESSIONAL_ASC_BILLING
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                                   AS GROUPVAL,
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                                   AS GROUPVAL,
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''OVERALL''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING P 
    join DIMENSIONS.DIM_DATE D
    ON ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''YEAR(RECEIPT_DATE)''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MCO_NUMBER::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NETWORK_NUMBER::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_NETWORK N
    ON ( I.SUBMITTING_NETWORK_HKEY = N.NETWORK_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MCO_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_NO::text, ''~NA'')                                               AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( I.CLAIM_NUMBER::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM C
    on ( I.CLAIM_NUMBER = C.CLAIM_NUMBER )
        -- ON ( I.CLAIM_NUMBER_HKEY = C.CLAIM_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_NO''                                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_STATUS::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_HEADER_CURRENT_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''INVOICE_STATUS''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(LINE_STATUS_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_LINE_ITEM_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''LINE_STATUS_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CPT_PAYMENT_CATEGORY::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PROCEDURE_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CUST_NO::text, ''~NA'')                                              AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CUSTOMER_NUMBER::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INJURED_WORKER W
    ON ( I.INJURED_WORKER_HKEY = W.INJURED_WORKER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CUST_NO''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICING_PEACH_NUMBER::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROVIDER_PEACH_NUMBER::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_PROVIDER P
    ON ( I.SERVICE_PROVIDER_HKEY = P.PROVIDER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''SERVICING_PEACH_NUMBER''                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLACE_OF_SERVICE_CODE::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(LINE_PLACE_OF_SERVICE_CODE::text, ''~NA'')                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_PLACE_OF_SERVICE P
    ON ( I.PLACE_OF_SERVICE_HKEY = P.PLACE_OF_SERVICE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PLACE_OF_SERVICE_CODE''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DIAGNOSIS_CODE::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ICD_CODE::text, ''~NA'')                                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_ICD P
    ON ( I.PRINCIPAL_ICD_HKEY = P.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''DIAGNOSIS_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_TYPE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_TYPE_CODE::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''INVOICE_TYPE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FEE_SCHEDULE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_FEE_SCHEDULE_DESC::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''FEE_SCHEDULE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_PAYMENT_CATEGORY::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''ADJUSTMENT_TYPE''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PAID_ABOVE_ZERO_IND''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_FLAG::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(IN_SUBROGATION_IND::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''SUBROGATION_FLAG''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''SUBROGATION_TYPE_DESC''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INPUT_METHOD_CODE::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_INPUT_METHOD_CODE::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''INPUT_METHOD_CODE''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD1_MODIFIER_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_1_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD1_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD2_MODIFIER_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_2_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD2_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD3_MODIFIER_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_3_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD3_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD4_MODIFIER_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_4_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD4_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD_SET::text, ''~NA'')                                              AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SET_CODE::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD_SET''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TYP_CD::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_TYPE_CODE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_TYP_CD''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STT_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_STT_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STS_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_CODE::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_STS_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_TRANS_RSN_TYP_CD''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''POLICY_TYPE_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_TYP_CD::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_STATUS_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PLCY_STS_TYP_CD''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_RSN_TYP_CD::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(STATUS_REASON_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PLCY_STS_RSN_TYP_CD''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''POLICY_ACTIVE_IND''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 


--#################################################################################################
--
-- FACT_PRESCRIPTION_BILLING
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                                   AS GROUPVAL,
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                                   AS GROUPVAL,
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''OVERALL''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING P 
    join DIMENSIONS.DIM_DATE D
    ON ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''YEAR(RECEIPT_DATE)''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MCO_NUMBER::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NETWORK_NUMBER::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_NETWORK N
    ON ( I.SUBMITTING_NETWORK_HKEY = N.NETWORK_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''MCO_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 


--insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
--'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    -- with src_tbl as (
    -- SELECT
    -- CLM_NO                                               AS GROUPVAL, 
    -- COUNT(*)                                                    AS CNT, 
    -- SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    -- SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    -- SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    -- SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    -- SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    -- SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    -- SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    -- SUM(PMT_AMT)                                                AS PMT_AMT
    -- FROM STAGING.DST_INVOICE_PRESCRIPTION C
    -- GROUP BY GROUPVAL
    -- ),
    -- tgt_tbl as (
    -- SELECT
    -- CLAIM_NUMBER                                         AS GROUPVAL, 
    -- COUNT(*)                                                    AS CNT, 
    -- SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    -- SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    -- SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    -- SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    -- SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    -- SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    -- SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    -- SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    -- FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    -- join DIMENSIONS.DIM_CLAIM C
    --  ON ( I.CLAIM_NUMBER_HKEY = C.CLAIM_HKEY )
    -- GROUP BY GROUPVAL
    -- )
    -- select
    --         current_date                                      as AUDIT_DT,
    --         ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
    --         ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
    --         ''CLM_NO''                                          as GROUPVAL,
    -- object_construct(
    --     ''GROUPVAL'',         src.GROUPVAL,
    --     ''COUNT'',            src.CNT,
    --     ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
    --     ''PAID_UNITS'',       src.PAID_UNITS,
    --     ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
    --     ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
    --     ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
    --     ''CALC_AMOUNT'',      src.CALC_AMOUNT,
    --     ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
    --     ''PMT_AMT'',          src.PMT_AMT
    -- ) AS src,      
    -- object_construct(
    --     ''GROUPVAL'',         tgt.GROUPVAL,
    --     ''COUNT'',            tgt.CNT,
    --     ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
    --     ''PAID_UNITS'',       tgt.PAID_UNITS,
    --     ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
    --     ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
    --     ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
    --     ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
    --     ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
    --     ''PMT_AMT'',          tgt.PMT_AMT
    -- ) AS tgt     
    -- from  SRC_TBL src
    --     FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) 
    -- ;


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_STATUS::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_HEADER_CURRENT_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''INVOICE_STATUS''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(LINE_STATUS_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_LINE_ITEM_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''LINE_STATUS_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CUST_NO::text, ''~NA'')                                              AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CUSTOMER_NUMBER::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INJURED_WORKER W
    ON ( I.INJURED_WORKER_HKEY = W.INJURED_WORKER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CUST_NO''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICING_PEACH_NUMBER::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROVIDER_PEACH_NUMBER::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_PROVIDER P
    ON ( I.PHARMACY_PROVIDER_HKEY = P.PROVIDER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''SERVICING_PEACH_NUMBER''                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PRICE_TYPE::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PRICE_TYPE_CODE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_PBM_PRICING_METHOD P
    ON ( I.PBM_PRICING_METHOD_HKEY = P.PBM_PRICING_METHOD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PRICE_TYPE''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 



insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLIENT_PRICING::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PBM_PRICING_SOURCE_CODE::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_PBM_PRICING_METHOD P
    ON ( I.PBM_PRICING_METHOD_HKEY = P.PBM_PRICING_METHOD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLIENT_PRICING''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 



insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DIAGNOSIS_CODE::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ICD_CODE::text, ''~NA'')                                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_ICD P
    ON ( I.PRINCIPAL_ICD_HKEY = P.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''DIAGNOSIS_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(NATIONAL_DRUG_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NDC_11_CODE::text, ''~NA'')                                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_NDC P
    ON ( I.NDC_GPI_HKEY = P.NDC_GPI_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''NATIONAL_DRUG_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_TYPE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_TYPE_CODE::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''INVOICE_TYPE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FEE_SCHEDULE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_FEE_SCHEDULE_DESC::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''FEE_SCHEDULE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_PAYMENT_CATEGORY::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''ADJUSTMENT_TYPE''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PAID_ABOVE_ZERO_IND''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_FLAG::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(IN_SUBROGATION_IND::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''SUBROGATION_FLAG''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''SUBROGATION_TYPE_DESC''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

-- insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
--'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    -- with src_tbl as (
    -- SELECT
    -- INPUT_METHOD_CODE                                    AS GROUPVAL, 
    -- COUNT(*)                                                    AS CNT, 
    -- SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    -- SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    -- SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    -- SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    -- SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    -- SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    -- SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    -- SUM(PMT_AMT)                                                AS PMT_AMT
    -- FROM STAGING.DST_INVOICE_PRESCRIPTION C
    -- GROUP BY GROUPVAL
    -- ),
    -- tgt_tbl as (
    -- SELECT
    -- INVOICE_INPUT_METHOD_CODE                            AS GROUPVAL, 
    -- COUNT(*)                                                    AS CNT, 
    -- SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    -- SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    -- SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    -- SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    -- SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    -- SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    -- SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    -- SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    -- FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    -- join DIMENSIONS.DIM_POLICY_STANDING P
    --  ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    -- GROUP BY GROUPVAL
    -- )
    -- select
    --         current_date                                      as AUDIT_DT,
    --         ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
    --         ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
    --         ''INPUT_METHOD_CODE''                               as GROUPVAL,
    -- object_construct(
    --     ''GROUPVAL'',         src.GROUPVAL,
    --     ''COUNT'',            src.CNT,
    --     ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
    --     ''PAID_UNITS'',       src.PAID_UNITS,
    --     ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
    --     ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
    --     ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
    --     ''CALC_AMOUNT'',      src.CALC_AMOUNT,
    --     ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
    --     ''PMT_AMT'',          src.PMT_AMT
    -- ) AS src,      
    -- object_construct(
    --     ''GROUPVAL'',         tgt.GROUPVAL,
    --     ''COUNT'',            tgt.CNT,
    --     ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
    --     ''PAID_UNITS'',       tgt.PAID_UNITS,
    --     ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
    --     ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
    --     ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
    --     ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
    --     ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
    --     ''PMT_AMT'',          tgt.PMT_AMT
    -- ) AS tgt     
    -- from  SRC_TBL src
    --     FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) 
    -- ;


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''POLICY_TYPE_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_TYP_CD::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_STATUS_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PLCY_STS_TYP_CD''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_RSN_TYP_CD::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(STATUS_REASON_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PLCY_STS_RSN_TYP_CD''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''POLICY_ACTIVE_IND''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICE_LEVEL::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SERVICE_LEVEL_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_PRESCRIPTION_BILL P
    ON ( I.PRESCRIPTION_BILL_HKEY = P.PRESCRIPTION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''SERVICE_LEVEL''                                   as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TYP_CD::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_TYPE_CODE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLM_TYP_CD''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STT_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLM_STT_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STS_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_CODE::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLM_STS_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLM_TRANS_RSN_TYP_CD''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

--#################################################################################################
--
-- FLF_MEDICAL_INVOICE_PROCEDURES
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_DATE D
        on ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''OVERALL''                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

--#################################################################################################
--
-- FLF_MEDICAL_INVOICE_PROCEDURES comparisons
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''OVERALL''                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- DATES (Year) grouping
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(YEAR(RECEIPT_DATE)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_DATE D
        on ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''RECEIPT YEAR''                                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(SERVICE_FROM)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_DATE D
        on ( P.INVOICE_SERVICE_FROM_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''SERVICE_FROM YEAR''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
        NVL( YEAR(SERVICE_TO)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_DATE D
        on ( P.INVOICE_SERVICE_TO_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''SERVICE_TO YEAR''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


    --#################################################################################################
    --HOSPITAL ICD PROCEDURE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(PROCEDURE_CODE::text, ''~NA'')          as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(ICD_PROCEDURE_CODE::text, ''~NA'')                          as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_HOSPITAL_ICD_PROCEDURE H
        on ( P.HEADER_PROCEDURE_HKEY = H.ICD_PROCEDURE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''PROCEDURE_CODE''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


--#################################################################################################
--
-- FLF_MEDICAL_INVOICE_DIAGNOSIS comparisons
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS dia 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS''  as TGT_NAME,
            ''OVERALL''                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- DATES (Year) grouping
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS dia 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_DATE D
        on ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''RECEIPT YEAR''                                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(SERVICE_FROM)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS dia 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_DATE D
        on ( P.INVOICE_SERVICE_FROM_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''SERVICE_FROM YEAR''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(SERVICE_TO)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS dia 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_DATE D
        on ( P.INVOICE_SERVICE_TO_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''SERVICE_TO YEAR''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');



    --#################################################################################################
    --ICD DIAGNOSTIC CODE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( hdr.DIAGNOSIS_CODE::text, ''~NA'')            as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS DIA 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(ICD_CODE::text, ''~NA'')                          as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_ICD D
        on ( P.HEADER_DIAGNOSIS_HKEY = D.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''DIAGNOSIS_CODE''                             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    --ICD ADMISSION PRESENCE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(PRESENT_ON_ADMIT::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS DIA 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(PRESENT_ON_ADMISSION_CODE::text, ''~NA'')                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_ICD_ADMISSION_PRESENCE D
        on ( P.PRESENT_ON_ADMISSION_HKEY = D.PRESENT_ON_ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''PRESENT_ON_ADMIT''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


--#################################################################################################
--
-- FLF_HEALTHCARE_SERVICE_AUTHORIZATION comparisons
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION P
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''OVERALL''                                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(CASE_SERV_AUTH_DT)::text, ''~NA'')                 as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_DATE D
        on( S.AUTHORIZATION_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_DATE YEAR''                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(CASE_SERV_APRV_FR_DT)::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_DATE D
        on( S.AUTHORIZATION_FROM_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_FROM_DATE YEAR''                                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(CASE_SERV_APRV_TO_DT)::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_DATE D
        on( S.AUTHORIZATION_THROUGH_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_THROUGH_DATE YEAR''                             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


    --#################################################################################################
    -- HEALTHCARE AUTHORIZATION STATUS
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CASE_SERV_STS_TYP_CD::text, ''~NA'')                  as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(AUTHORIZATION_STATUS_CODE::text, ''~NA'')                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_HEALTHCARE_AUTHORIZATION_STATUS D
        on( S.HEALTHCARE_AUTHORIZATION_STATUS_HKEY = D.HEALTHCARE_AUTHORIZATION_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_STATUS_CODE''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CASE_SERV_TYP_CD::text, ''~NA'')                      as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(AUTHORIZATION_SERVICE_TYPE_CODE::text, ''~NA'')             as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_HEALTHCARE_AUTHORIZATION_STATUS D
        on( S.HEALTHCARE_AUTHORIZATION_STATUS_HKEY = D.HEALTHCARE_AUTHORIZATION_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_SERVICE_TYPE_CODE''                             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    -- CASE TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CASE_TYP_CD::text, ''~NA'')                           as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CASE_TYPE_CODE::text, ''~NA'')                              as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_CASE_TYPE D
        on( S.CASE_TYPE_HKEY = D.CASE_TYPE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''CASE_TYPE_CODE''                                              as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CASE_CTG_TYP_CD::text, ''~NA'')                       as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CASE_CATEGORY_CODE::text, ''~NA'')                          as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_CASE_TYPE D
        on( S.CASE_TYPE_HKEY = D.CASE_TYPE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''CASE_CATEGORY_CODE''                                          as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


--#################################################################################################
--
-- FLF_CLAIM_ICD_ALLOWANCE comparisons
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  CLM
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( CLM.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL P
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''OVERALL''                                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(ICD_STS_DT)::text, ''~NA'')          as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_DATE D
        on ( CIAD.ICD_STATUS_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''ICD_STS_DT YEAR''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- ICD CODE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(ICD_CODE::text, ''~NA'')                as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(ICD_CODE::text, ''~NA'')                                    as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_ICD I
        on ( CIAD.ICD_HKEY = I.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''ICD_CODE''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- CLAIM ICD STATUS TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(ICD_STS_TYP_CD::text, ''~NA'')                as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(ICD_STATUS_TYPE_CODE::text, ''~NA'')                        as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_ICD_STATUS_TYPE I
        on ( CIAD.CLAIM_ICD_STATUS_TYPE_HKEY = I.CLAIM_ICD_STATUS_TYPE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''ICD_STATUS_TYPE_CODE''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_ICD_STS_PRI_IND::text, ''~NA'')     as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_ICD_PRIMARY_IND::text, ''~NA'')                       as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_ICD_STATUS_TYPE I
        on ( CIAD.CLAIM_ICD_STATUS_TYPE_HKEY = I.CLAIM_ICD_STATUS_TYPE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_ICD_PRIMARY_IND''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_TYP_CD::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_TYPE_CODE::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_TYPE_STATUS_HKEY''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CHNG_OVR_IND::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_TYPE_CHANGE_OVER_IND::text, ''~NA'')                  as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_TYPE_CHANGE_OVER_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_STT_TYP_CD::text, ''~NA'')          as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_STATE_CODE::text, ''~NA'')                            as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_STATE_CODE''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

        
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_STS_TYP_CD::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_STATUS_CODE::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_STATUS_CODE''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                          as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')                    as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_STATUS_REASON_CODE''                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    -- CLAIM DETAIL
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(OCCR_SRC_TYP_NM::text, ''~NA'')                as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(FILING_SOURCE_DESC::text, ''~NA'')                        as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''FILING_SOURCE_DESC''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(OCCR_MEDA_TYP_NM::text, ''~NA'')               as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(FILING_MEDIA_DESC::text, ''~NA'')                        as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''FILING_MEDIA_DESC''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(NOI_CTG_TYP_NM::text, ''~NA'')               as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(NATURE_OF_INJURY_CATEGORY::text, ''~NA'')                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''NATURE_OF_INJURY_CATEGORY''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(NOI_TYP_NM::text, ''~NA'')               as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(NATURE_OF_INJURY_TYPE::text, ''~NA'')                       as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''NATURE_OF_INJURY_TYPE''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(FIREFIGHTER_CANCER_IND::text, ''~NA'')         as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(FIREFIGHTER_CANCER_IND::text, ''~NA'')                      as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''FIREFIGHTER_CANCER_IND''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(COVID_EXPOSURE_IND::text, ''~NA'')             as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(COVID_EXPOSURE_IND::text, ''~NA'')                          as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''COVID_EXPOSURE_IND''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(COVID_EMERGENCY_WORKER_IND::text, ''~NA'')     as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(COVID_EMERGENCY_WORKER_IND::text, ''~NA'')                  as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''COVID_EMERGENCY_WORKER_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(COVID_HEALTH_CARE_WORKER_IND::text, ''~NA'')     as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(COVID_HEALTH_CARE_WORKER_IND::text, ''~NA'')                  as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''COVID_HEALTH_CARE_WORKER_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(COMBINED_CLAIM_IND::text, ''~NA'')             as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(COMBINED_IND::text, ''~NA'')                                as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''COMBINED_IND''                               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(SB223_IND::text, ''~NA'')                      as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(SB223_IND::text, ''~NA'')                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''SB223_IND''                                  as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(EMPLOYER_PREMISES_IND::text, ''~NA'')          as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(EMPLOYER_PREMISES_IND::text, ''~NA'')                       as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''EMPLOYER_PREMISES_IND''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_CTRPH_INJR_IND::text, ''~NA'')             as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CATASTROPHIC_IND::text, ''~NA'')                            as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CATASTROPHIC_IND''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


---- ADD FACT_CONSOLIDATED_MEDICAL_BILLING

--#################################################################################################
--
-- FACT_DETAIL_PAYMENT_CODING comparisons
-- added 2022-05-20
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                     AS GROUPVAL,
    COUNT(*)                                      AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                     AS GROUPVAL,
    COUNT(*)                                      AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''OVERALL''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(WRNT_DATE)::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                  AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_DATE D
            ON ( F.WARRANT_DATE_HKEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''WARRANT YEAR''                              as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- PAYMENT CODER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( ACNTB_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( ACCOUNTABILITY_CODE::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''ACCOUNTABILITY_CODE''                       as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PYMNT_FUND_TYPE::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PAYMENT_FUND_TYPE_CODE::text, ''~NA'')         AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''PAYMENT_FUND_TYPE_CODE''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CVRG_TYPE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( COVERAGE_TYPE_CODE::text, ''~NA'')             AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER  C
            ON (F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''COVERAGE_TYPE_CODE''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( BILL_TYPE_F2::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( BILL_TYPE_F2_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON (F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''BILL_TYPE_F2_CODE''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( BILL_TYPE_L3::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( BILL_TYPE_L3_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''BILL_TYPE_L3_CODE''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( ACDNT_TYPE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( ACCIDENT_TYPE_CODE::text, ''~NA'')             AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''ACCIDENT_TYPE_CODE''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( STS_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PAYMENT_STATUS_CODE::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''PAYMENT_STATUS_CODE''                       as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- PAYEE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PAYEE_NAME::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PAYEE_FULL_NAME::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYEE P
            ON ( F.PAYEE_HKEY = P.PAYEE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''PAYEE_FULL_NAME''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- CLAIM PAYMENT CATEGORY
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( CLAIM_PAYMENT_CATEGORY_DESC::text, ''~NA'')    AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DSV_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( CLAIM_PAYMENT_CATEGORY_DESC::text, ''~NA'')    AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_CLAIM_PAYMENT_CATEGORY C
            ON ( F.CLAIM_PAYMENT_CATEGORY_HKEY = C.CLAIM_PAYMENT_CATEGORY_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''CLAIM_PAYMENT_CATEGORY_DESC''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


--#################################################################################################
--
-- FACT_DISABILITY_TRACKING
-- ADDED 2022-05-20
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                    AS GROUPVAL,
    COUNT(*)                                     AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                    AS GROUPVAL,
    COUNT(*)                                     AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''OVERALL''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CLM_DISAB_MANG_EFF_DT)::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( DT.DISABILITY_START_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_START_DATE YEAR''                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CLM_DISAB_MANG_END_DT)::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN DIMENSIONS.DIM_DATE  D
            ON ( DT.DISABILITY_END_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_END_DATE YEAR''                  as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- USER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CR_USER_LGN_NM::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( USER_LOGIN_NAME::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING  DT
        JOIN  DIMENSIONS.DIM_USER U
            ON ( DT.CREATE_USER_HKEY = U.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''CR_USER_LGN_NM''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( UP_USER_LGN_NM::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( USER_LOGIN_NAME::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN DIMENSIONS.DIM_USER  U
            ON ( DT.UPDATE_USER_HKEY = U.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''UP_USER_LGN_NM''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- DISABILITY TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CLM_DISAB_MANG_DISAB_TYP_CD::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( DISABILITY_TYPE_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING  DT
        JOIN  DIMENSIONS.DIM_DISABILITY_TYPE  D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_TYPE_CODE''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CLM_DISAB_MANG_RSN_TYP_CD::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( DISABILITY_REASON_TYPE_CODE::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING  DT
        JOIN  DIMENSIONS.DIM_DISABILITY_TYPE D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_REASON_TYPE_CODE''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CLM_DISAB_MANG_MED_STS_TYP_CD::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( DISABILITY_MEDICAL_STATUS_TYPE_CODE::text, ''~NA'')          AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING  DT
        JOIN  DIMENSIONS.DIM_DISABILITY_TYPE D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY)
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_MEDICAL_STATUS_TYPE_CODE''       as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CLM_DISAB_MANG_WK_STS_TYP_CD, ''NA'')                 AS GROUPVAL, 
    COUNT(*)                                                 AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( DISABILITY_WORK_STATUS_TYPE_CODE::text, ''~NA'')             AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM  CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN DIMENSIONS.DIM_DISABILITY_TYPE  D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_WORK_STATUS_TYPE_CODE''          as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CURRENT_DISABILITY_STATUS_IND::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( CURRENT_DISABILITY_STATUS_IND::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM  CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN DIMENSIONS.DIM_DISABILITY_TYPE D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''CURRENT_DISABILITY_STATUS_IND''             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

--#################################################################################################
--
-- FACT_EARNED_PREMIUM
-- ADDED 2022-05-20
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                         AS GROUPVAL,
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                         AS GROUPVAL,
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''OVERALL''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(BILLED_DATE)::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(EARNED_AMOUNT)                                      AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                        AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                                     AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT 
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( EP.BILLED_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''BILLED_DATE YEAR''                          as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(BILL_DUE_DATE)::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_DATE D
            ON ( EP.BILL_DUE_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''BILL_DUE_DATE YEAR''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(PAID_DATE)::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_DATE D
            ON ( EP.PAID_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''PAID_DATE YEAR''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CERTIFIED_AG_DATE)::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( EP.CERTIFIED_TO_AG_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''CERTIFIED_AG_DATE YEAR''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


    --#################################################################################################
    -- EMPLOYER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CUSTOMER_NUMBER::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( CUSTOMER_NUMBER::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_EMPLOYER EMP
            ON (  EP.EMPLOYER_HKEY = EMP.EMPLOYER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''CUSTOMER_NUMBER''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- POLICY PERIOD
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(POLICY_PERIOD_EFFECTIVE_DATE)::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(POLICY_PERIOD_EFFECTIVE_DATE)::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_POLICY_PERIOD PP
            ON ( EP.POLICY_PERIOD_HKEY = PP.POLICY_PERIOD_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_PERIOD_EFFECTIVE_DATE YEAR''         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(POLICY_PERIOD_END_DATE)::text, ''~NA'')         AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT 
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(POLICY_PERIOD_END_DATE)::text, ''~NA'')         AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_PERIOD PP
            ON ( EP.POLICY_PERIOD_HKEY = PP.POLICY_PERIOD_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_PERIOD_END_DATE YEAR''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PEC_POLICY_IND::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PEC_POLICY_IND::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_PERIOD PP
            ON ( EP.POLICY_PERIOD_HKEY = PP.POLICY_PERIOD_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''PEC_POLICY_IND''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- POLICY STANDING
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( POLICY_TYPE_CODE, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( POLICY_TYPE_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_STANDING PS
            ON ( EP.POLICY_STANDING_HKEY = PS.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_TYPE_CODE''                          as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( POLICY_STATUS_CODE::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( POLICY_STATUS_CODE::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_STANDING PS
            ON EP.POLICY_STANDING_HKEY = PS.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_STATUS_CODE''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( STATUS_REASON_CODE::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( STATUS_REASON_CODE::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_STANDING PS
            ON ( EP.POLICY_STANDING_HKEY = PS.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''STATUS_REASON_CODE''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( POLICY_ACTIVE_IND::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( POLICY_ACTIVE_IND::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_STANDING PS
            ON ( EP.POLICY_STANDING_HKEY = PS.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_ACTIVE_IND''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- FINANCIAL TRANSACTION TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_TYPE_ID::text, ''~NA'')        AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_TYPE_ID::text, ''~NA'')        AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_FINANCIAL_TRANSACTION_TYPE PS
            ON ( EP.FINANCIAL_TRANSACTION_TYPE_HKEY = PS.FINANCIAL_TRANSACTION_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''FINANCIAL_TRANSACTION_TYPE_ID''             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- FINANCIAL TRANSACTION STATUS
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_STATUS_CODE::text, ''~NA'')    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_STATUS_CODE::text, ''~NA'')    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_FINANCIAL_TRANSACTION_STATUS PS
            ON ( EP.FINANCIAL_TRANSACTION_STATUS_HKEY = PS.FINANCIAL_TRANSACTION_STATUS_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''FINANCIAL_TRANSACTION_STATUS_CODE''         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    --  POLICY FINANCIAL TRANSACTION COMMENT
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PFT_COMMENT_TEXT::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_COMMENT_TEXT::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_POLICY_FINANCIAL_TRANSACTION_COMMENT PS
            ON ( EP.FINANCIAL_TRANSACTION_COMMENT_HKEY = PS.FINANCIAL_TRANSACTION_COMMENT_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''FINANCIAL_TRANSACTION_COMMENT_TEXT''        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    --  USER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CREATE_USER_LOGIN_NAME::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( USER_LOGIN_NAME::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_USER PS
            ON ( EP.FINANCIAL_TRANSACTION_CREATE_USER_HKEY = PS.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''CREATE_USER_LOGIN_NAME''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    --  POLICY BILLING
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PAYMENT_PLAN_TYPE_DESC::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PAYMENT_PLAN_TYPE_DESC::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''PAYMENT_PLAN_TYPE_DESC''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( REPORTING_FREQUENCY_TYPE_DESC::text, ''~NA'')        AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( REPORTING_FREQUENCY_TYPE_DESC::text, ''~NA'')        AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''REPORTING_FREQUENCY_TYPE_DESC''             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( AUDIT_TYPE_DESC::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( AUDIT_TYPE_DESC::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''AUDIT_TYPE_DESC''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( EMPLOYEE_LEASING_TYPE_DESC::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( EMPLOYEE_LEASING_TYPE_DESC::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''EMPLOYEE_LEASING_TYPE_DESC''                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( POLICY_15K_PROGRAM_IND::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( POLICY_15K_PROGRAM_IND::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_15K_PROGRAM_IND''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( REPORTED_ZERO_PAYROLL_IND::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( REPORTED_ZERO_PAYROLL_IND::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''REPORTED_ZERO_PAYROLL_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( ESTIMATED_PREMIUM_IND::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT 
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( ESTIMATED_PREMIUM_IND::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''ESTIMATED_PREMIUM_IND''                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

--#################################################################################################
--
-- FACT_CLAIM_PARTICIPATION
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    ''OVERALL''                                           AS GROUPVAL,
    COUNT(*)                                           AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    ''OVERALL''                                           AS GROUPVAL,
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''OVERALL''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(AUDIT_USER_CREATE_DATE)::text, ''~NA'')                 AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( P.CREATE_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''AUDIT_USER_CREATE_DATE YEAR''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(AUDIT_USER_UPDATE_DATE)::text, ''~NA'')                 AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( P.UPDATE_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''AUDIT_USER_UPDATE_DATE YEAR''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CLAIM_PARTICIPATION_EFFECTIVE_DATE)::text, ''~NA'')     AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN DIMENSIONS.DIM_DATE D
            ON ( P.PARTICIPATION_EFFECTIVE_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''CLAIM_PARTICIPATION_EFFECTIVE_DATE YEAR''   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CLAIM_PARTICIPATION_END_DATE)::text, ''~NA'')     AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( P.PARTICIPATION_END_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''CLAIM_PARTICIPATION_END_DATE YEAR''         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    -- PARTICIPATION TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PARTICIPATION_TYPE_CODE::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( PARTICIPATION_TYPE_CODE::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_PARTICIPATION_TYPE PT
            ON ( P.PARTICIPATION_TYPE_HKEY = PT.PARTICIPATION_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''PARTICIPATION_TYPE_CODE''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PARTICIPATION_PRIMARY_IND::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( PARTICIPATION_PRIMARY_IND::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_PARTICIPATION_TYPE PT
            ON ( P.PARTICIPATION_TYPE_HKEY = PT.PARTICIPATION_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''PARTICIPATION_PRIMARY_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    --  CUSTOMER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( PART.CUSTOMER_NUMBER::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( CUSTOMER_NUMBER::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_CUSTOMER C
            ON ( P.CUSTOMER_HKEY = C.CUSTOMER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''CUSTOMER_NUMBER''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    --  USER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PART.CREATE_USER_LOGIN_NAME::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( USER_LOGIN_NAME::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_USER U
            ON ( P.CREATE_USER_HKEY = U.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''USER_LOGIN_NAME''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PART.UPDATE_USER_LOGIN_NAME::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( USER_LOGIN_NAME::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_USER U
            ON ( P.UPDATE_USER_HKEY = U.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''UPDATE_USER_LOGIN_NAME''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');



---- ADD CLAIM_PROGRESS_SNAPSHOT



--select * from DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS;
--create table DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS_ORIG as select * from DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS;

truncate table DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS;

select * from AUDIT_SCRIPTS;

--Executed using the following:
-- call run_audits();

with fails as (
select * from DEV_EDW_32600145.STAGING.AUDIT_JSON   where audit_dt = current_date()
  and src <> tgt)
select src_name, tgt_name, groupby, count(src) from fails
group by 1,2,3 order by 1,2,3;

create or replace procedure run_audits()
   returns varchar not null
   language javascript
   as
   $$
var return_value = "";
var sql_query = "select INSERT_STMT from DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS" ;
   var sql_statement = snowflake.createStatement(
          {
          sqlText: sql_query
          }
       );

var result_scan = sql_statement.execute();
   while (result_scan.next())  {
       sql2run = snowflake.createStatement ({sqlText: result_scan.getColumnValue(1)  });
       var sqlrun = sql2run.execute();
       }return return_value;
$$
;


/*
create or replace TABLE  DEV_EDW_32600145.STAGING.AUDIT_JSON (
	AUDIT_DT    DATE,
    AUDIT_ID    NUMBER,
	SRC_NAME    TEXT,
	TGT_NAME    TEXT,
	GROUPBY     TEXT,
	SRC         OBJECT,
	TGT         OBJECT
);
*/

--delete from DEV_EDW_32600145.STAGING.AUDIT_JSON where audit_dt >= current_date-1;

--#################################################################################################
--
-- FACT_HOSPITAL_INPATIENT_BILLING
--
--#################################################################################################
-- OVERALL
--#################################################################################################

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                     AS GROUPVAL,
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                     AS GROUPVAL,
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''OVERALL''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING P 
    join DIMENSIONS.DIM_DATE D
    ON ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''YEAR(RECEIPT_DATE)''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( REVENUE_CENTER_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( HOSPITAL_REVENUE_CENTER_CODE::text, ''~NA'')     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_REVENUE_CENTER R
    ON ( I.REVENUE_CENTER_HKEY = R.REVENUE_CENTER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''REVENUE_CENTER_CODE''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MCO_NUMBER::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NETWORK_NUMBER::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_NETWORK N
    ON ( I.SUBMITTING_NETWORK_HKEY = N.NETWORK_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MCO_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_NO::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( I.CLAIM_NUMBER::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM C
    on ( I.CLAIM_NUMBER = C.CLAIM_NUMBER )
        -- ON ( I.CLAIM_NUMBER_HKEY = C.CLAIM_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_NO''                                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_STATUS::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_HEADER_CURRENT_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''INVOICE_STATUS''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(LINE_STATUS_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_LINE_ITEM_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''LINE_STATUS_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CPT_PAYMENT_CATEGORY::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''PROCEDURE_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CUST_NO::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CUSTOMER_NUMBER::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INJURED_WORKER W
    ON ( I.INJURED_WORKER_HKEY = W.INJURED_WORKER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CUST_NO''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICING_PEACH_NUMBER::text, ''~NA'')                 AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROVIDER_PEACH_NUMBER::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_PROVIDER P
    ON ( I.SERVICE_PROVIDER_HKEY = P.PROVIDER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''SERVICING_PEACH_NUMBER''                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DIAGNOSIS_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ICD_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ICD P
    ON ( I.PRINCIPAL_ICD_HKEY = P.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''DIAGNOSIS_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADMISSION_TYPE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(HOSPITAL_ADMISSION_TYPE_CODE::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''ADMISSION_TYPE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADMISSION_SOURCE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_SOURCE_OF_ADMISSION_CODE::text, ''~NA'') AS GROUPVAL, 
    COUNT(*)                                        AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)         AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)           AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                    AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)        AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)    AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                   AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                       AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''ADMISSION_SOURCE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DISCHARGE_STATUS::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_HOSPITAL_DISCHARGE_STATUS_CODE::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''DISCHARGE_STATUS''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(BILL_TYPE::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_HOSPITAL_BILL_TYPE_CODE::text, ''~NA'')  AS GROUPVAL, 
    COUNT(*)                                        AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)         AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)           AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                    AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)        AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)    AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                   AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                       AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''BILL_TYPE''                                       as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FRMTTD_PRO_DRG::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(DIAGNOSIS_RELATED_GROUP_CODE::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_DIAGNOSIS_RELATED_GROUP P
    ON ( I.PROVIDER_SUBMITTED_DRG_HKEY = P.DRG_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''FRMTTD_PRO_DRG''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DRG_NUMBER::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(DIAGNOSIS_RELATED_GROUP_CODE::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_BWC_CALC_DRG_OUTPUT P
    ON ( I.BWC_CALC_DRG_OUTPUT_HKEY = P.BWC_CALC_DRG_OUTPUT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''DRG_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD1_MODIFIER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_1_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD1_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD2_MODIFIER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_2_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD2_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD3_MODIFIER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_3_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD3_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD4_MODIFIER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_4_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD4_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD_SET::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SET_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD_SET''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TYP_CD::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_TYPE_CODE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_TYP_CD''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STT_TYP_CD::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATE_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_STT_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STS_TYP_CD::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_STS_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_TRANS_RSN_TYP_CD''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_TYPE::text, ''~NA'')                           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_TYPE_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''INVOICE_TYPE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FEE_SCHEDULE::text, ''~NA'')                           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_FEE_SCHEDULE_DESC::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''FEE_SCHEDULE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_PAYMENT_CATEGORY::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''ADJUSTMENT_TYPE''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''PAID_ABOVE_ZERO_IND''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_FLAG::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(IN_SUBROGATION_IND::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''SUBROGATION_FLAG''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''SUBROGATION_TYPE_DESC''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INPUT_METHOD_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_INPUT_METHOD_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''INPUT_METHOD_CODE''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

    ---     added 2022-05-19
    ----POLICY STANDING
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''POLICY_TYPE_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_TYP_CD::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_STATUS_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''POLICY_STATUS_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_RSN_TYP_CD::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(STATUS_REASON_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''STATUS_REASON_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''POLICY_ACTIVE_IND''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) ');

    ---     added 2022-05-19


--#################################################################################################
--
-- FACT_HOSPITAL_OUTPATIENT_BILLING
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
            ''OVERALL''                                         as GROUPVAL,
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
            ''OVERALL''                                         as GROUPVAL,
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING O
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''OVERALL''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING P 
    join DIMENSIONS.DIM_DATE D
    ON ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''YEAR(RECEIPT_DATE)''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(REVENUE_CENTER_CODE::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE,
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(HOSPITAL_REVENUE_CENTER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_REVENUE_CENTER R
    ON ( I.REVENUE_CENTER_HKEY = R.REVENUE_CENTER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''REVENUE_CENTER_CODE''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MCO_NUMBER::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NETWORK_NUMBER::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_NETWORK N
    ON ( I.SUBMITTING_NETWORK_HKEY = N.NETWORK_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MCO_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLAIM_NUMBER::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO'' 
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(I.CLAIM_NUMBER::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM C
    on ( I.CLAIM_NUMBER = C.CLAIM_NUMBER )
        -- ON ( I.CLAIM_NUMBER_HKEY = C.CLAIM_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLAIM_NUMBER''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_STATUS::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_HEADER_CURRENT_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''INVOICE_STATUS''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(LINE_STATUS_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_LINE_ITEM_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''LINE_STATUS_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CPT_PAYMENT_CATEGORY::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PROCEDURE_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CUST_NO::text, ''~NA'')                                          AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CUSTOMER_NUMBER::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INJURED_WORKER W
    ON ( I.INJURED_WORKER_HKEY = W.INJURED_WORKER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CUST_NO''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICING_PEACH_NUMBER::text, ''~NA'')                           AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROVIDER_PEACH_NUMBER::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_PROVIDER P
    ON ( I.SERVICE_PROVIDER_HKEY = P.PROVIDER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''SERVICING_PEACH_NUMBER''                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DIAGNOSIS_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ICD_CODE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ICD P
    ON ( I.PRINCIPAL_ICD_HKEY = P.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''DIAGNOSIS_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADMISSION_TYPE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(HOSPITAL_ADMISSION_TYPE_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''ADMISSION_TYPE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADMISSION_SOURCE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_SOURCE_OF_ADMISSION_CODE::text, ''~NA'')         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''ADMISSION_SOURCE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DISCHARGE_STATUS::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_HOSPITAL_DISCHARGE_STATUS_CODE::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''DISCHARGE_STATUS''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(BILL_TYPE::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_HOSPITAL_BILL_TYPE_CODE::text, ''~NA'')          AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''BILL_TYPE''                                       as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(APC_CODE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_CODE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_AMBULATORY_PAYMENT_CLASSIFICATION P
    ON ( I.APC_HKEY = P.APC_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''APC_CODE''                                        as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(APC_STATUS::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_STATUS_INDICATOR_CODE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''APC_STATUS''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(NON_OPPS_BILL_TYPE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(OPPS_RETURN_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''NON_OPPS_BILL_TYPE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(OPPS_FLAG::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(OPPS_CODE::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''OPPS_FLAG''                                       as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_METHOD::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(OPPS_PAYMENT_METHOD_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_METHOD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DISCOUNT::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_DISCOUNTING_FRACTION_CODE::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''DISCOUNT''                                        as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(COMPOSITE_ADJUSTMENT::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_COMPOSITE_ADJUSTMENT_CODE::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''COMPOSITE_ADJUSTMENT''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_INDICATOR::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_PAYMENT_INDICATOR_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_INDICATOR''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PACKAGING::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_PACKAGING_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PACKAGING''                                       as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_ADJUSTMENT::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_PAYMENT_ADJUSTMENT_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_ADJUSTMENT''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD1_MODIFIER_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_1_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD1_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD2_MODIFIER_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_2_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD2_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD3_MODIFIER_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_3_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD3_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD4_MODIFIER_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_4_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD4_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD_SET::text, ''~NA'')                                          AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SET_CODE::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD_SET''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_TYPE_CODE::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLM_TYP_CD''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STT_TYP_CD::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATE_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLM_STT_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STS_TYP_CD::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_CODE::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLM_STS_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLM_TRANS_RSN_TYP_CD''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_TYPE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_TYPE_CODE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''INVOICE_TYPE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FEE_SCHEDULE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_FEE_SCHEDULE_DESC::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''FEE_SCHEDULE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_PAYMENT_CATEGORY::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''ADJUSTMENT_TYPE''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAID_ABOVE_ZERO_IND''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_FLAG::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(IN_SUBROGATION_IND::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''SUBROGATION_FLAG''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''SUBROGATION_TYPE_DESC''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INPUT_METHOD_CODE::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_INPUT_METHOD_CODE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''INPUT_METHOD_CODE''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

    -----  Added 2022-05-19

    ----POLICY_STANDING
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''POLICY_TYPE_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_TYP_CD::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_STATUS_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''POLICY_STATUS_CODE''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_RSN_TYP_CD::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(STATUS_REASON_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''STATUS_REASON_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 
        
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''POLICY_ACTIVE_IND''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 
    -----  Added 2022-05-19



--#################################################################################################
--
-- FACT_PROFESSIONAL_ASC_BILLING
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                                   AS GROUPVAL,
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                                   AS GROUPVAL,
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''OVERALL''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING P 
    join DIMENSIONS.DIM_DATE D
    ON ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''YEAR(RECEIPT_DATE)''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MCO_NUMBER::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NETWORK_NUMBER::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_NETWORK N
    ON ( I.SUBMITTING_NETWORK_HKEY = N.NETWORK_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MCO_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_NO::text, ''~NA'')                                               AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( I.CLAIM_NUMBER::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM C
    on ( I.CLAIM_NUMBER = C.CLAIM_NUMBER )
        -- ON ( I.CLAIM_NUMBER_HKEY = C.CLAIM_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_NO''                                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_STATUS::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_HEADER_CURRENT_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''INVOICE_STATUS''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(LINE_STATUS_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_LINE_ITEM_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''LINE_STATUS_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CPT_PAYMENT_CATEGORY::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PROCEDURE_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CUST_NO::text, ''~NA'')                                              AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CUSTOMER_NUMBER::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INJURED_WORKER W
    ON ( I.INJURED_WORKER_HKEY = W.INJURED_WORKER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CUST_NO''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICING_PEACH_NUMBER::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROVIDER_PEACH_NUMBER::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_PROVIDER P
    ON ( I.SERVICE_PROVIDER_HKEY = P.PROVIDER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''SERVICING_PEACH_NUMBER''                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLACE_OF_SERVICE_CODE::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(LINE_PLACE_OF_SERVICE_CODE::text, ''~NA'')                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_PLACE_OF_SERVICE P
    ON ( I.PLACE_OF_SERVICE_HKEY = P.PLACE_OF_SERVICE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PLACE_OF_SERVICE_CODE''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DIAGNOSIS_CODE::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ICD_CODE::text, ''~NA'')                                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_ICD P
    ON ( I.PRINCIPAL_ICD_HKEY = P.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''DIAGNOSIS_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_TYPE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_TYPE_CODE::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''INVOICE_TYPE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FEE_SCHEDULE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_FEE_SCHEDULE_DESC::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''FEE_SCHEDULE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_PAYMENT_CATEGORY::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''ADJUSTMENT_TYPE''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PAID_ABOVE_ZERO_IND''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_FLAG::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(IN_SUBROGATION_IND::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''SUBROGATION_FLAG''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''SUBROGATION_TYPE_DESC''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INPUT_METHOD_CODE::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_INPUT_METHOD_CODE::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''INPUT_METHOD_CODE''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD1_MODIFIER_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_1_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD1_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD2_MODIFIER_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_2_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD2_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD3_MODIFIER_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_3_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD3_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD4_MODIFIER_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_4_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD4_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD_SET::text, ''~NA'')                                              AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SET_CODE::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD_SET''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TYP_CD::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_TYPE_CODE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_TYP_CD''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STT_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_STT_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STS_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_CODE::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_STS_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_TRANS_RSN_TYP_CD''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''POLICY_TYPE_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_TYP_CD::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_STATUS_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PLCY_STS_TYP_CD''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_RSN_TYP_CD::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(STATUS_REASON_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PLCY_STS_RSN_TYP_CD''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''POLICY_ACTIVE_IND''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 


--#################################################################################################
--
-- FACT_PRESCRIPTION_BILLING
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                                   AS GROUPVAL,
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                                   AS GROUPVAL,
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''OVERALL''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING P 
    join DIMENSIONS.DIM_DATE D
    ON ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''YEAR(RECEIPT_DATE)''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MCO_NUMBER::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NETWORK_NUMBER::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_NETWORK N
    ON ( I.SUBMITTING_NETWORK_HKEY = N.NETWORK_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''MCO_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 


--insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
--'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    -- with src_tbl as (
    -- SELECT
    -- CLM_NO                                               AS GROUPVAL, 
    -- COUNT(*)                                                    AS CNT, 
    -- SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    -- SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    -- SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    -- SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    -- SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    -- SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    -- SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    -- SUM(PMT_AMT)                                                AS PMT_AMT
    -- FROM STAGING.DST_INVOICE_PRESCRIPTION C
    -- GROUP BY GROUPVAL
    -- ),
    -- tgt_tbl as (
    -- SELECT
    -- CLAIM_NUMBER                                         AS GROUPVAL, 
    -- COUNT(*)                                                    AS CNT, 
    -- SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    -- SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    -- SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    -- SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    -- SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    -- SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    -- SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    -- SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    -- FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    -- join DIMENSIONS.DIM_CLAIM C
    --  ON ( I.CLAIM_NUMBER_HKEY = C.CLAIM_HKEY )
    -- GROUP BY GROUPVAL
    -- )
    -- select
    --         current_date                                      as AUDIT_DT,
    --         ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
    --         ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
    --         ''CLM_NO''                                          as GROUPVAL,
    -- object_construct(
    --     ''GROUPVAL'',         src.GROUPVAL,
    --     ''COUNT'',            src.CNT,
    --     ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
    --     ''PAID_UNITS'',       src.PAID_UNITS,
    --     ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
    --     ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
    --     ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
    --     ''CALC_AMOUNT'',      src.CALC_AMOUNT,
    --     ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
    --     ''PMT_AMT'',          src.PMT_AMT
    -- ) AS src,      
    -- object_construct(
    --     ''GROUPVAL'',         tgt.GROUPVAL,
    --     ''COUNT'',            tgt.CNT,
    --     ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
    --     ''PAID_UNITS'',       tgt.PAID_UNITS,
    --     ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
    --     ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
    --     ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
    --     ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
    --     ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
    --     ''PMT_AMT'',          tgt.PMT_AMT
    -- ) AS tgt     
    -- from  SRC_TBL src
    --     FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) 
    -- ;


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_STATUS::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_HEADER_CURRENT_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''INVOICE_STATUS''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(LINE_STATUS_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_LINE_ITEM_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''LINE_STATUS_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CUST_NO::text, ''~NA'')                                              AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CUSTOMER_NUMBER::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INJURED_WORKER W
    ON ( I.INJURED_WORKER_HKEY = W.INJURED_WORKER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CUST_NO''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICING_PEACH_NUMBER::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROVIDER_PEACH_NUMBER::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_PROVIDER P
    ON ( I.PHARMACY_PROVIDER_HKEY = P.PROVIDER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''SERVICING_PEACH_NUMBER''                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PRICE_TYPE::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PRICE_TYPE_CODE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_PBM_PRICING_METHOD P
    ON ( I.PBM_PRICING_METHOD_HKEY = P.PBM_PRICING_METHOD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PRICE_TYPE''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 



insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLIENT_PRICING::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PBM_PRICING_SOURCE_CODE::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_PBM_PRICING_METHOD P
    ON ( I.PBM_PRICING_METHOD_HKEY = P.PBM_PRICING_METHOD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLIENT_PRICING''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 



insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DIAGNOSIS_CODE::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ICD_CODE::text, ''~NA'')                                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_ICD P
    ON ( I.PRINCIPAL_ICD_HKEY = P.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''DIAGNOSIS_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(NATIONAL_DRUG_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NDC_11_CODE::text, ''~NA'')                                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_NDC P
    ON ( I.NDC_GPI_HKEY = P.NDC_GPI_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''NATIONAL_DRUG_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_TYPE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_TYPE_CODE::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''INVOICE_TYPE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FEE_SCHEDULE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_FEE_SCHEDULE_DESC::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''FEE_SCHEDULE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_PAYMENT_CATEGORY::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''ADJUSTMENT_TYPE''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PAID_ABOVE_ZERO_IND''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_FLAG::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(IN_SUBROGATION_IND::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''SUBROGATION_FLAG''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''SUBROGATION_TYPE_DESC''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

-- insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
--'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    -- with src_tbl as (
    -- SELECT
    -- INPUT_METHOD_CODE                                    AS GROUPVAL, 
    -- COUNT(*)                                                    AS CNT, 
    -- SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    -- SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    -- SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    -- SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    -- SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    -- SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    -- SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    -- SUM(PMT_AMT)                                                AS PMT_AMT
    -- FROM STAGING.DST_INVOICE_PRESCRIPTION C
    -- GROUP BY GROUPVAL
    -- ),
    -- tgt_tbl as (
    -- SELECT
    -- INVOICE_INPUT_METHOD_CODE                            AS GROUPVAL, 
    -- COUNT(*)                                                    AS CNT, 
    -- SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    -- SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    -- SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    -- SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    -- SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    -- SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    -- SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    -- SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    -- FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    -- join DIMENSIONS.DIM_POLICY_STANDING P
    --  ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    -- GROUP BY GROUPVAL
    -- )
    -- select
    --         current_date                                      as AUDIT_DT,
    --         ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
    --         ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
    --         ''INPUT_METHOD_CODE''                               as GROUPVAL,
    -- object_construct(
    --     ''GROUPVAL'',         src.GROUPVAL,
    --     ''COUNT'',            src.CNT,
    --     ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
    --     ''PAID_UNITS'',       src.PAID_UNITS,
    --     ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
    --     ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
    --     ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
    --     ''CALC_AMOUNT'',      src.CALC_AMOUNT,
    --     ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
    --     ''PMT_AMT'',          src.PMT_AMT
    -- ) AS src,      
    -- object_construct(
    --     ''GROUPVAL'',         tgt.GROUPVAL,
    --     ''COUNT'',            tgt.CNT,
    --     ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
    --     ''PAID_UNITS'',       tgt.PAID_UNITS,
    --     ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
    --     ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
    --     ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
    --     ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
    --     ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
    --     ''PMT_AMT'',          tgt.PMT_AMT
    -- ) AS tgt     
    -- from  SRC_TBL src
    --     FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) 
    -- ;


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''POLICY_TYPE_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_TYP_CD::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_STATUS_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PLCY_STS_TYP_CD''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_RSN_TYP_CD::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(STATUS_REASON_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PLCY_STS_RSN_TYP_CD''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''POLICY_ACTIVE_IND''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICE_LEVEL::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SERVICE_LEVEL_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_PRESCRIPTION_BILL P
    ON ( I.PRESCRIPTION_BILL_HKEY = P.PRESCRIPTION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''SERVICE_LEVEL''                                   as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TYP_CD::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_TYPE_CODE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLM_TYP_CD''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STT_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLM_STT_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STS_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_CODE::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLM_STS_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLM_TRANS_RSN_TYP_CD''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

--#################################################################################################
--
-- FLF_MEDICAL_INVOICE_PROCEDURES
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_DATE D
        on ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''OVERALL''                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

--#################################################################################################
--
-- FLF_MEDICAL_INVOICE_PROCEDURES comparisons
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''OVERALL''                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- DATES (Year) grouping
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(YEAR(RECEIPT_DATE)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_DATE D
        on ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''RECEIPT YEAR''                                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(SERVICE_FROM)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_DATE D
        on ( P.INVOICE_SERVICE_FROM_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''SERVICE_FROM YEAR''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
        NVL( YEAR(SERVICE_TO)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_DATE D
        on ( P.INVOICE_SERVICE_TO_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''SERVICE_TO YEAR''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


    --#################################################################################################
    --HOSPITAL ICD PROCEDURE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(PROCEDURE_CODE::text, ''~NA'')          as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(ICD_PROCEDURE_CODE::text, ''~NA'')                          as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_HOSPITAL_ICD_PROCEDURE H
        on ( P.HEADER_PROCEDURE_HKEY = H.ICD_PROCEDURE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''PROCEDURE_CODE''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


--#################################################################################################
--
-- FLF_MEDICAL_INVOICE_DIAGNOSIS comparisons
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS dia 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS''  as TGT_NAME,
            ''OVERALL''                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- DATES (Year) grouping
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS dia 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_DATE D
        on ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''RECEIPT YEAR''                                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(SERVICE_FROM)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS dia 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_DATE D
        on ( P.INVOICE_SERVICE_FROM_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''SERVICE_FROM YEAR''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(SERVICE_TO)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS dia 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_DATE D
        on ( P.INVOICE_SERVICE_TO_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''SERVICE_TO YEAR''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');



    --#################################################################################################
    --ICD DIAGNOSTIC CODE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( hdr.DIAGNOSIS_CODE::text, ''~NA'')            as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS DIA 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(ICD_CODE::text, ''~NA'')                          as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_ICD D
        on ( P.HEADER_DIAGNOSIS_HKEY = D.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''DIAGNOSIS_CODE''                             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    --ICD ADMISSION PRESENCE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(PRESENT_ON_ADMIT::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS DIA 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(PRESENT_ON_ADMISSION_CODE::text, ''~NA'')                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_ICD_ADMISSION_PRESENCE D
        on ( P.PRESENT_ON_ADMISSION_HKEY = D.PRESENT_ON_ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''PRESENT_ON_ADMIT''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


--#################################################################################################
--
-- FLF_HEALTHCARE_SERVICE_AUTHORIZATION comparisons
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION P
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''OVERALL''                                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(CASE_SERV_AUTH_DT)::text, ''~NA'')                 as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_DATE D
        on( S.AUTHORIZATION_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_DATE YEAR''                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(CASE_SERV_APRV_FR_DT)::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_DATE D
        on( S.AUTHORIZATION_FROM_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_FROM_DATE YEAR''                                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(CASE_SERV_APRV_TO_DT)::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_DATE D
        on( S.AUTHORIZATION_THROUGH_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_THROUGH_DATE YEAR''                             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


    --#################################################################################################
    -- HEALTHCARE AUTHORIZATION STATUS
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CASE_SERV_STS_TYP_CD::text, ''~NA'')                  as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(AUTHORIZATION_STATUS_CODE::text, ''~NA'')                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_HEALTHCARE_AUTHORIZATION_STATUS D
        on( S.HEALTHCARE_AUTHORIZATION_STATUS_HKEY = D.HEALTHCARE_AUTHORIZATION_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_STATUS_CODE''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CASE_SERV_TYP_CD::text, ''~NA'')                      as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(AUTHORIZATION_SERVICE_TYPE_CODE::text, ''~NA'')             as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_HEALTHCARE_AUTHORIZATION_STATUS D
        on( S.HEALTHCARE_AUTHORIZATION_STATUS_HKEY = D.HEALTHCARE_AUTHORIZATION_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_SERVICE_TYPE_CODE''                             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    -- CASE TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CASE_TYP_CD::text, ''~NA'')                           as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CASE_TYPE_CODE::text, ''~NA'')                              as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_CASE_TYPE D
        on( S.CASE_TYPE_HKEY = D.CASE_TYPE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''CASE_TYPE_CODE''                                              as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CASE_CTG_TYP_CD::text, ''~NA'')                       as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CASE_CATEGORY_CODE::text, ''~NA'')                          as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_CASE_TYPE D
        on( S.CASE_TYPE_HKEY = D.CASE_TYPE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''CASE_CATEGORY_CODE''                                          as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


--#################################################################################################
--
-- FLF_CLAIM_ICD_ALLOWANCE comparisons
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  CLM
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( CLM.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL P
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''OVERALL''                                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(ICD_STS_DT)::text, ''~NA'')          as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_DATE D
        on ( CIAD.ICD_STATUS_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''ICD_STS_DT YEAR''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- ICD CODE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(ICD_CODE::text, ''~NA'')                as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(ICD_CODE::text, ''~NA'')                                    as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_ICD I
        on ( CIAD.ICD_HKEY = I.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''ICD_CODE''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- CLAIM ICD STATUS TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(ICD_STS_TYP_CD::text, ''~NA'')                as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(ICD_STATUS_TYPE_CODE::text, ''~NA'')                        as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_ICD_STATUS_TYPE I
        on ( CIAD.CLAIM_ICD_STATUS_TYPE_HKEY = I.CLAIM_ICD_STATUS_TYPE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''ICD_STATUS_TYPE_CODE''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_ICD_STS_PRI_IND::text, ''~NA'')     as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_ICD_PRIMARY_IND::text, ''~NA'')                       as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_ICD_STATUS_TYPE I
        on ( CIAD.CLAIM_ICD_STATUS_TYPE_HKEY = I.CLAIM_ICD_STATUS_TYPE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_ICD_PRIMARY_IND''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_TYP_CD::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_TYPE_CODE::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_TYPE_STATUS_HKEY''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CHNG_OVR_IND::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_TYPE_CHANGE_OVER_IND::text, ''~NA'')                  as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_TYPE_CHANGE_OVER_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_STT_TYP_CD::text, ''~NA'')          as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_STATE_CODE::text, ''~NA'')                            as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_STATE_CODE''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

        
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_STS_TYP_CD::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_STATUS_CODE::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_STATUS_CODE''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                          as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')                    as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_STATUS_REASON_CODE''                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    -- CLAIM DETAIL
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(OCCR_SRC_TYP_NM::text, ''~NA'')                as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(FILING_SOURCE_DESC::text, ''~NA'')                        as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''FILING_SOURCE_DESC''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(OCCR_MEDA_TYP_NM::text, ''~NA'')               as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(FILING_MEDIA_DESC::text, ''~NA'')                        as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''FILING_MEDIA_DESC''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(NOI_CTG_TYP_NM::text, ''~NA'')               as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(NATURE_OF_INJURY_CATEGORY::text, ''~NA'')                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''NATURE_OF_INJURY_CATEGORY''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(NOI_TYP_NM::text, ''~NA'')               as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(NATURE_OF_INJURY_TYPE::text, ''~NA'')                       as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''NATURE_OF_INJURY_TYPE''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(FIREFIGHTER_CANCER_IND::text, ''~NA'')         as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(FIREFIGHTER_CANCER_IND::text, ''~NA'')                      as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''FIREFIGHTER_CANCER_IND''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(COVID_EXPOSURE_IND::text, ''~NA'')             as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(COVID_EXPOSURE_IND::text, ''~NA'')                          as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''COVID_EXPOSURE_IND''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(COVID_EMERGENCY_WORKER_IND::text, ''~NA'')     as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(COVID_EMERGENCY_WORKER_IND::text, ''~NA'')                  as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''COVID_EMERGENCY_WORKER_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(COVID_HEALTH_CARE_WORKER_IND::text, ''~NA'')     as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(COVID_HEALTH_CARE_WORKER_IND::text, ''~NA'')                  as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''COVID_HEALTH_CARE_WORKER_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(COMBINED_CLAIM_IND::text, ''~NA'')             as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(COMBINED_IND::text, ''~NA'')                                as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''COMBINED_IND''                               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(SB223_IND::text, ''~NA'')                      as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(SB223_IND::text, ''~NA'')                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''SB223_IND''                                  as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(EMPLOYER_PREMISES_IND::text, ''~NA'')          as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(EMPLOYER_PREMISES_IND::text, ''~NA'')                       as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''EMPLOYER_PREMISES_IND''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_CTRPH_INJR_IND::text, ''~NA'')             as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CATASTROPHIC_IND::text, ''~NA'')                            as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CATASTROPHIC_IND''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


---- ADD FACT_CONSOLIDATED_MEDICAL_BILLING

--#################################################################################################
--
-- FACT_DETAIL_PAYMENT_CODING comparisons
-- added 2022-05-20
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                     AS GROUPVAL,
    COUNT(*)                                      AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                     AS GROUPVAL,
    COUNT(*)                                      AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''OVERALL''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(WRNT_DATE)::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                  AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_DATE D
            ON ( F.WARRANT_DATE_HKEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''WARRANT YEAR''                              as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- PAYMENT CODER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( ACNTB_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( ACCOUNTABILITY_CODE::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''ACCOUNTABILITY_CODE''                       as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PYMNT_FUND_TYPE::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PAYMENT_FUND_TYPE_CODE::text, ''~NA'')         AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''PAYMENT_FUND_TYPE_CODE''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CVRG_TYPE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( COVERAGE_TYPE_CODE::text, ''~NA'')             AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER  C
            ON (F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''COVERAGE_TYPE_CODE''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( BILL_TYPE_F2::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( BILL_TYPE_F2_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON (F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''BILL_TYPE_F2_CODE''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( BILL_TYPE_L3::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( BILL_TYPE_L3_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''BILL_TYPE_L3_CODE''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( ACDNT_TYPE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( ACCIDENT_TYPE_CODE::text, ''~NA'')             AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''ACCIDENT_TYPE_CODE''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( STS_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PAYMENT_STATUS_CODE::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''PAYMENT_STATUS_CODE''                       as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- PAYEE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PAYEE_NAME::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PAYEE_FULL_NAME::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYEE P
            ON ( F.PAYEE_HKEY = P.PAYEE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''PAYEE_FULL_NAME''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- CLAIM PAYMENT CATEGORY
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( CLAIM_PAYMENT_CATEGORY_DESC::text, ''~NA'')    AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DSV_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( CLAIM_PAYMENT_CATEGORY_DESC::text, ''~NA'')    AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_CLAIM_PAYMENT_CATEGORY C
            ON ( F.CLAIM_PAYMENT_CATEGORY_HKEY = C.CLAIM_PAYMENT_CATEGORY_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''CLAIM_PAYMENT_CATEGORY_DESC''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


--#################################################################################################
--
-- FACT_DISABILITY_TRACKING
-- ADDED 2022-05-20
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                    AS GROUPVAL,
    COUNT(*)                                     AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                    AS GROUPVAL,
    COUNT(*)                                     AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''OVERALL''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CLM_DISAB_MANG_EFF_DT)::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( DT.DISABILITY_START_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_START_DATE YEAR''                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CLM_DISAB_MANG_END_DT)::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN DIMENSIONS.DIM_DATE  D
            ON ( DT.DISABILITY_END_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_END_DATE YEAR''                  as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- USER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CR_USER_LGN_NM::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( USER_LOGIN_NAME::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING  DT
        JOIN  DIMENSIONS.DIM_USER U
            ON ( DT.CREATE_USER_HKEY = U.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''CR_USER_LGN_NM''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( UP_USER_LGN_NM::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( USER_LOGIN_NAME::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN DIMENSIONS.DIM_USER  U
            ON ( DT.UPDATE_USER_HKEY = U.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''UP_USER_LGN_NM''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- DISABILITY TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CLM_DISAB_MANG_DISAB_TYP_CD::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( DISABILITY_TYPE_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING  DT
        JOIN  DIMENSIONS.DIM_DISABILITY_TYPE  D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_TYPE_CODE''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CLM_DISAB_MANG_RSN_TYP_CD::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( DISABILITY_REASON_TYPE_CODE::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING  DT
        JOIN  DIMENSIONS.DIM_DISABILITY_TYPE D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_REASON_TYPE_CODE''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CLM_DISAB_MANG_MED_STS_TYP_CD::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( DISABILITY_MEDICAL_STATUS_TYPE_CODE::text, ''~NA'')          AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING  DT
        JOIN  DIMENSIONS.DIM_DISABILITY_TYPE D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY)
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_MEDICAL_STATUS_TYPE_CODE''       as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CLM_DISAB_MANG_WK_STS_TYP_CD, ''NA'')                 AS GROUPVAL, 
    COUNT(*)                                                 AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( DISABILITY_WORK_STATUS_TYPE_CODE::text, ''~NA'')             AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM  CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN DIMENSIONS.DIM_DISABILITY_TYPE  D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_WORK_STATUS_TYPE_CODE''          as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CURRENT_DISABILITY_STATUS_IND::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( CURRENT_DISABILITY_STATUS_IND::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM  CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN DIMENSIONS.DIM_DISABILITY_TYPE D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''CURRENT_DISABILITY_STATUS_IND''             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

--#################################################################################################
--
-- FACT_EARNED_PREMIUM
-- ADDED 2022-05-20
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                         AS GROUPVAL,
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                         AS GROUPVAL,
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''OVERALL''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(BILLED_DATE)::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(EARNED_AMOUNT)                                      AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                        AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                                     AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT 
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( EP.BILLED_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''BILLED_DATE YEAR''                          as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(BILL_DUE_DATE)::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_DATE D
            ON ( EP.BILL_DUE_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''BILL_DUE_DATE YEAR''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(PAID_DATE)::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_DATE D
            ON ( EP.PAID_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''PAID_DATE YEAR''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CERTIFIED_AG_DATE)::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( EP.CERTIFIED_TO_AG_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''CERTIFIED_AG_DATE YEAR''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


    --#################################################################################################
    -- EMPLOYER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CUSTOMER_NUMBER::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( CUSTOMER_NUMBER::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_EMPLOYER EMP
            ON (  EP.EMPLOYER_HKEY = EMP.EMPLOYER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''CUSTOMER_NUMBER''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- POLICY PERIOD
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(POLICY_PERIOD_EFFECTIVE_DATE)::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(POLICY_PERIOD_EFFECTIVE_DATE)::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_POLICY_PERIOD PP
            ON ( EP.POLICY_PERIOD_HKEY = PP.POLICY_PERIOD_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_PERIOD_EFFECTIVE_DATE YEAR''         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(POLICY_PERIOD_END_DATE)::text, ''~NA'')         AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT 
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(POLICY_PERIOD_END_DATE)::text, ''~NA'')         AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_PERIOD PP
            ON ( EP.POLICY_PERIOD_HKEY = PP.POLICY_PERIOD_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_PERIOD_END_DATE YEAR''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PEC_POLICY_IND::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PEC_POLICY_IND::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_PERIOD PP
            ON ( EP.POLICY_PERIOD_HKEY = PP.POLICY_PERIOD_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''PEC_POLICY_IND''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- POLICY STANDING
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( POLICY_TYPE_CODE, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( POLICY_TYPE_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_STANDING PS
            ON ( EP.POLICY_STANDING_HKEY = PS.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_TYPE_CODE''                          as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( POLICY_STATUS_CODE::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( POLICY_STATUS_CODE::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_STANDING PS
            ON EP.POLICY_STANDING_HKEY = PS.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_STATUS_CODE''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( STATUS_REASON_CODE::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( STATUS_REASON_CODE::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_STANDING PS
            ON ( EP.POLICY_STANDING_HKEY = PS.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''STATUS_REASON_CODE''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( POLICY_ACTIVE_IND::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( POLICY_ACTIVE_IND::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_STANDING PS
            ON ( EP.POLICY_STANDING_HKEY = PS.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_ACTIVE_IND''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- FINANCIAL TRANSACTION TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_TYPE_ID::text, ''~NA'')        AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_TYPE_ID::text, ''~NA'')        AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_FINANCIAL_TRANSACTION_TYPE PS
            ON ( EP.FINANCIAL_TRANSACTION_TYPE_HKEY = PS.FINANCIAL_TRANSACTION_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''FINANCIAL_TRANSACTION_TYPE_ID''             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- FINANCIAL TRANSACTION STATUS
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_STATUS_CODE::text, ''~NA'')    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_STATUS_CODE::text, ''~NA'')    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_FINANCIAL_TRANSACTION_STATUS PS
            ON ( EP.FINANCIAL_TRANSACTION_STATUS_HKEY = PS.FINANCIAL_TRANSACTION_STATUS_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''FINANCIAL_TRANSACTION_STATUS_CODE''         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    --  POLICY FINANCIAL TRANSACTION COMMENT
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PFT_COMMENT_TEXT::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_COMMENT_TEXT::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_POLICY_FINANCIAL_TRANSACTION_COMMENT PS
            ON ( EP.FINANCIAL_TRANSACTION_COMMENT_HKEY = PS.FINANCIAL_TRANSACTION_COMMENT_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''FINANCIAL_TRANSACTION_COMMENT_TEXT''        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    --  USER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CREATE_USER_LOGIN_NAME::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( USER_LOGIN_NAME::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_USER PS
            ON ( EP.FINANCIAL_TRANSACTION_CREATE_USER_HKEY = PS.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''CREATE_USER_LOGIN_NAME''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    --  POLICY BILLING
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PAYMENT_PLAN_TYPE_DESC::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PAYMENT_PLAN_TYPE_DESC::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''PAYMENT_PLAN_TYPE_DESC''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( REPORTING_FREQUENCY_TYPE_DESC::text, ''~NA'')        AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( REPORTING_FREQUENCY_TYPE_DESC::text, ''~NA'')        AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''REPORTING_FREQUENCY_TYPE_DESC''             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( AUDIT_TYPE_DESC::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( AUDIT_TYPE_DESC::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''AUDIT_TYPE_DESC''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( EMPLOYEE_LEASING_TYPE_DESC::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( EMPLOYEE_LEASING_TYPE_DESC::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''EMPLOYEE_LEASING_TYPE_DESC''                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( POLICY_15K_PROGRAM_IND::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( POLICY_15K_PROGRAM_IND::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_15K_PROGRAM_IND''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( REPORTED_ZERO_PAYROLL_IND::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( REPORTED_ZERO_PAYROLL_IND::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''REPORTED_ZERO_PAYROLL_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( ESTIMATED_PREMIUM_IND::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT 
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( ESTIMATED_PREMIUM_IND::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''ESTIMATED_PREMIUM_IND''                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

--#################################################################################################
--
-- FACT_CLAIM_PARTICIPATION
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    ''OVERALL''                                           AS GROUPVAL,
    COUNT(*)                                           AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    ''OVERALL''                                           AS GROUPVAL,
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''OVERALL''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(AUDIT_USER_CREATE_DATE)::text, ''~NA'')                 AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( P.CREATE_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''AUDIT_USER_CREATE_DATE YEAR''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(AUDIT_USER_UPDATE_DATE)::text, ''~NA'')                 AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( P.UPDATE_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''AUDIT_USER_UPDATE_DATE YEAR''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CLAIM_PARTICIPATION_EFFECTIVE_DATE)::text, ''~NA'')     AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN DIMENSIONS.DIM_DATE D
            ON ( P.PARTICIPATION_EFFECTIVE_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''CLAIM_PARTICIPATION_EFFECTIVE_DATE YEAR''   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CLAIM_PARTICIPATION_END_DATE)::text, ''~NA'')     AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( P.PARTICIPATION_END_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''CLAIM_PARTICIPATION_END_DATE YEAR''         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    -- PARTICIPATION TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PARTICIPATION_TYPE_CODE::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( PARTICIPATION_TYPE_CODE::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_PARTICIPATION_TYPE PT
            ON ( P.PARTICIPATION_TYPE_HKEY = PT.PARTICIPATION_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''PARTICIPATION_TYPE_CODE''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PARTICIPATION_PRIMARY_IND::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( PARTICIPATION_PRIMARY_IND::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_PARTICIPATION_TYPE PT
            ON ( P.PARTICIPATION_TYPE_HKEY = PT.PARTICIPATION_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''PARTICIPATION_PRIMARY_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    --  CUSTOMER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( PART.CUSTOMER_NUMBER::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( CUSTOMER_NUMBER::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_CUSTOMER C
            ON ( P.CUSTOMER_HKEY = C.CUSTOMER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''CUSTOMER_NUMBER''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    --  USER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PART.CREATE_USER_LOGIN_NAME::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( USER_LOGIN_NAME::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_USER U
            ON ( P.CREATE_USER_HKEY = U.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''USER_LOGIN_NAME''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PART.UPDATE_USER_LOGIN_NAME::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( USER_LOGIN_NAME::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_USER U
            ON ( P.UPDATE_USER_HKEY = U.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''UPDATE_USER_LOGIN_NAME''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');



---- ADD CLAIM_PROGRESS_SNAPSHOT



--select * from DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS;
--create table DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS_ORIG as select * from DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS;

truncate table DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS;

select * from AUDIT_SCRIPTS;

--Executed using the following:
-- call run_audits();

with fails as (
select * from DEV_EDW_32600145.STAGING.AUDIT_JSON   where audit_dt = current_date()
  and src <> tgt)
select src_name, tgt_name, groupby, count(src) from fails
group by 1,2,3 order by 1,2,3;

create or replace procedure run_audits()
   returns varchar not null
   language javascript
   as
   $$
var return_value = "";
var sql_query = "select INSERT_STMT from DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS" ;
   var sql_statement = snowflake.createStatement(
          {
          sqlText: sql_query
          }
       );

var result_scan = sql_statement.execute();
   while (result_scan.next())  {
       sql2run = snowflake.createStatement ({sqlText: result_scan.getColumnValue(1)  });
       var sqlrun = sql2run.execute();
       }return return_value;
$$
;


/*
create or replace TABLE  DEV_EDW_32600145.STAGING.AUDIT_JSON (
	AUDIT_DT    DATE,
    AUDIT_ID    NUMBER,
	SRC_NAME    TEXT,
	TGT_NAME    TEXT,
	GROUPBY     TEXT,
	SRC         OBJECT,
	TGT         OBJECT
);
*/

--delete from DEV_EDW_32600145.STAGING.AUDIT_JSON where audit_dt >= current_date-1;

--#################################################################################################
--
-- FACT_HOSPITAL_INPATIENT_BILLING
--
--#################################################################################################
-- OVERALL
--#################################################################################################

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                     AS GROUPVAL,
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                     AS GROUPVAL,
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''OVERALL''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING P 
    join DIMENSIONS.DIM_DATE D
    ON ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''YEAR(RECEIPT_DATE)''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( REVENUE_CENTER_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( HOSPITAL_REVENUE_CENTER_CODE::text, ''~NA'')     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_REVENUE_CENTER R
    ON ( I.REVENUE_CENTER_HKEY = R.REVENUE_CENTER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''REVENUE_CENTER_CODE''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MCO_NUMBER::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NETWORK_NUMBER::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_NETWORK N
    ON ( I.SUBMITTING_NETWORK_HKEY = N.NETWORK_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MCO_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_NO::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( I.CLAIM_NUMBER::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM C
    on ( I.CLAIM_NUMBER = C.CLAIM_NUMBER )
        -- ON ( I.CLAIM_NUMBER_HKEY = C.CLAIM_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_NO''                                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_STATUS::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_HEADER_CURRENT_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''INVOICE_STATUS''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(LINE_STATUS_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_LINE_ITEM_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''LINE_STATUS_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CPT_PAYMENT_CATEGORY::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''PROCEDURE_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CUST_NO::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CUSTOMER_NUMBER::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INJURED_WORKER W
    ON ( I.INJURED_WORKER_HKEY = W.INJURED_WORKER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CUST_NO''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICING_PEACH_NUMBER::text, ''~NA'')                 AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROVIDER_PEACH_NUMBER::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_PROVIDER P
    ON ( I.SERVICE_PROVIDER_HKEY = P.PROVIDER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''SERVICING_PEACH_NUMBER''                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DIAGNOSIS_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ICD_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ICD P
    ON ( I.PRINCIPAL_ICD_HKEY = P.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''DIAGNOSIS_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADMISSION_TYPE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(HOSPITAL_ADMISSION_TYPE_CODE::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''ADMISSION_TYPE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADMISSION_SOURCE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_SOURCE_OF_ADMISSION_CODE::text, ''~NA'') AS GROUPVAL, 
    COUNT(*)                                        AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)         AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)           AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                    AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)        AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)    AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                   AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                       AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''ADMISSION_SOURCE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DISCHARGE_STATUS::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_HOSPITAL_DISCHARGE_STATUS_CODE::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''DISCHARGE_STATUS''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(BILL_TYPE::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_HOSPITAL_BILL_TYPE_CODE::text, ''~NA'')  AS GROUPVAL, 
    COUNT(*)                                        AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)         AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)           AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                    AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)        AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)    AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                   AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                       AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''BILL_TYPE''                                       as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FRMTTD_PRO_DRG::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(DIAGNOSIS_RELATED_GROUP_CODE::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_DIAGNOSIS_RELATED_GROUP P
    ON ( I.PROVIDER_SUBMITTED_DRG_HKEY = P.DRG_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''FRMTTD_PRO_DRG''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DRG_NUMBER::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(DIAGNOSIS_RELATED_GROUP_CODE::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_BWC_CALC_DRG_OUTPUT P
    ON ( I.BWC_CALC_DRG_OUTPUT_HKEY = P.BWC_CALC_DRG_OUTPUT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''DRG_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD1_MODIFIER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_1_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD1_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD2_MODIFIER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_2_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD2_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD3_MODIFIER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_3_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD3_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD4_MODIFIER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_4_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD4_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD_SET::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SET_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''MOD_SET''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TYP_CD::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_TYPE_CODE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_TYP_CD''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STT_TYP_CD::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATE_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_STT_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STS_TYP_CD::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_STS_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''CLM_TRANS_RSN_TYP_CD''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_TYPE::text, ''~NA'')                           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_TYPE_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''INVOICE_TYPE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FEE_SCHEDULE::text, ''~NA'')                           AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_FEE_SCHEDULE_DESC::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''FEE_SCHEDULE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_PAYMENT_CATEGORY::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''ADJUSTMENT_TYPE''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''PAID_ABOVE_ZERO_IND''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_FLAG::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(IN_SUBROGATION_IND::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''SUBROGATION_FLAG''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''SUBROGATION_TYPE_DESC''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INPUT_METHOD_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_INPUT_METHOD_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''INPUT_METHOD_CODE''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

    ---     added 2022-05-19
    ----POLICY STANDING
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''POLICY_TYPE_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_TYP_CD::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_STATUS_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''POLICY_STATUS_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_RSN_TYP_CD::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(STATUS_REASON_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''STATUS_REASON_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(UNITS_OF_SERVICE)                         AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                               AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                          AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                         AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                              AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                          AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                  AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HI''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                      AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)       AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)         AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)              AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                  AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)      AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)  AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                 AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                     AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_INPATIENT_BILLING''    as TGT_NAME,
            ''POLICY_ACTIVE_IND''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) ');

    ---     added 2022-05-19


--#################################################################################################
--
-- FACT_HOSPITAL_OUTPATIENT_BILLING
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
            ''OVERALL''                                         as GROUPVAL,
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
            ''OVERALL''                                         as GROUPVAL,
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING O
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''OVERALL''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING P 
    join DIMENSIONS.DIM_DATE D
    ON ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''YEAR(RECEIPT_DATE)''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(REVENUE_CENTER_CODE::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE,
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(HOSPITAL_REVENUE_CENTER_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_REVENUE_CENTER R
    ON ( I.REVENUE_CENTER_HKEY = R.REVENUE_CENTER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''REVENUE_CENTER_CODE''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MCO_NUMBER::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NETWORK_NUMBER::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_NETWORK N
    ON ( I.SUBMITTING_NETWORK_HKEY = N.NETWORK_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MCO_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLAIM_NUMBER::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO'' 
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(I.CLAIM_NUMBER::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM C
    on ( I.CLAIM_NUMBER = C.CLAIM_NUMBER )
        -- ON ( I.CLAIM_NUMBER_HKEY = C.CLAIM_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLAIM_NUMBER''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_STATUS::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_HEADER_CURRENT_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''INVOICE_STATUS''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(LINE_STATUS_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_LINE_ITEM_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''LINE_STATUS_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CPT_PAYMENT_CATEGORY::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PROCEDURE_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CUST_NO::text, ''~NA'')                                          AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CUSTOMER_NUMBER::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INJURED_WORKER W
    ON ( I.INJURED_WORKER_HKEY = W.INJURED_WORKER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CUST_NO''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICING_PEACH_NUMBER::text, ''~NA'')                           AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROVIDER_PEACH_NUMBER::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_PROVIDER P
    ON ( I.SERVICE_PROVIDER_HKEY = P.PROVIDER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''SERVICING_PEACH_NUMBER''                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DIAGNOSIS_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ICD_CODE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ICD P
    ON ( I.PRINCIPAL_ICD_HKEY = P.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''DIAGNOSIS_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADMISSION_TYPE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(HOSPITAL_ADMISSION_TYPE_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''ADMISSION_TYPE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADMISSION_SOURCE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_SOURCE_OF_ADMISSION_CODE::text, ''~NA'')         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''ADMISSION_SOURCE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DISCHARGE_STATUS::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_HOSPITAL_DISCHARGE_STATUS_CODE::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''DISCHARGE_STATUS''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(BILL_TYPE::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_HOSPITAL_BILL_TYPE_CODE::text, ''~NA'')          AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_ADMISSION P
    ON ( I.ADMISSION_HKEY = P.ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''BILL_TYPE''                                       as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(APC_CODE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_CODE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_AMBULATORY_PAYMENT_CLASSIFICATION P
    ON ( I.APC_HKEY = P.APC_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''APC_CODE''                                        as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(APC_STATUS::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_STATUS_INDICATOR_CODE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''APC_STATUS''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(NON_OPPS_BILL_TYPE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(OPPS_RETURN_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''NON_OPPS_BILL_TYPE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(OPPS_FLAG::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(OPPS_CODE::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''OPPS_FLAG''                                       as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_METHOD::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(OPPS_PAYMENT_METHOD_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_METHOD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DISCOUNT::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_DISCOUNTING_FRACTION_CODE::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''DISCOUNT''                                        as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(COMPOSITE_ADJUSTMENT::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_COMPOSITE_ADJUSTMENT_CODE::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''COMPOSITE_ADJUSTMENT''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_INDICATOR::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_PAYMENT_INDICATOR_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_INDICATOR''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PACKAGING::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_PACKAGING_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PACKAGING''                                       as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_ADJUSTMENT::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(APC_PAYMENT_ADJUSTMENT_CODE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_OUTPATIENT_GROUPER P
    ON ( I.GROUPER_HKEY = P.GROUPER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_ADJUSTMENT''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD1_MODIFIER_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_1_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD1_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD2_MODIFIER_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_2_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD2_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD3_MODIFIER_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_3_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD3_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD4_MODIFIER_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_4_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD4_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD_SET::text, ''~NA'')                                          AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SET_CODE::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''MOD_SET''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_TYPE_CODE::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLM_TYP_CD''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STT_TYP_CD::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATE_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLM_STT_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STS_TYP_CD::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_CODE::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLM_STS_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''CLM_TRANS_RSN_TYP_CD''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_TYPE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_TYPE_CODE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''INVOICE_TYPE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FEE_SCHEDULE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_FEE_SCHEDULE_DESC::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''FEE_SCHEDULE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_PAYMENT_CATEGORY::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''ADJUSTMENT_TYPE''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''PAID_ABOVE_ZERO_IND''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_FLAG::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(IN_SUBROGATION_IND::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''SUBROGATION_FLAG''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''SUBROGATION_TYPE_DESC''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INPUT_METHOD_CODE::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_INPUT_METHOD_CODE::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''INPUT_METHOD_CODE''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

    -----  Added 2022-05-19

    ----POLICY_STANDING
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''POLICY_TYPE_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_TYP_CD::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_STATUS_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''POLICY_STATUS_CODE''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_RSN_TYP_CD::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(STATUS_REASON_CODE::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''STATUS_REASON_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 
        
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(UNITS_OF_SERVICE)                                   AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                         AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                      AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                    AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                   AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                        AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                    AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                            AS PMT_AMT
    FROM STAGING.DST_INVOICE_HOSPITAL C
    WHERE INVOICE_TYPE = ''HO''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                 AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                   AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                        AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                            AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)            AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                           AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                               AS PMT_AMT
    FROM MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING I, DIMENSIONS.DIM_POLICY_STANDING P
    WHERE I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_HOSPITAL''                    as SRC_NAME,
            ''MEDICAL_MART.FACT_HOSPITAL_OUTPATIENT_BILLING''   as TGT_NAME,
            ''POLICY_ACTIVE_IND''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 
    -----  Added 2022-05-19



--#################################################################################################
--
-- FACT_PROFESSIONAL_ASC_BILLING
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                                   AS GROUPVAL,
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                                   AS GROUPVAL,
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''OVERALL''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING P 
    join DIMENSIONS.DIM_DATE D
    ON ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''YEAR(RECEIPT_DATE)''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MCO_NUMBER::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NETWORK_NUMBER::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_NETWORK N
    ON ( I.SUBMITTING_NETWORK_HKEY = N.NETWORK_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MCO_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_NO::text, ''~NA'')                                               AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( I.CLAIM_NUMBER::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM C
    on ( I.CLAIM_NUMBER = C.CLAIM_NUMBER )
        -- ON ( I.CLAIM_NUMBER_HKEY = C.CLAIM_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_NO''                                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_STATUS::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_HEADER_CURRENT_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''INVOICE_STATUS''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(LINE_STATUS_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_LINE_ITEM_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''LINE_STATUS_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CPT_PAYMENT_CATEGORY::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROCEDURE_CODE::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CPT C
    ON ( I.CPT_SERVICE_RENDERED_HKEY = C.CPT_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PROCEDURE_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CUST_NO::text, ''~NA'')                                              AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CUSTOMER_NUMBER::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INJURED_WORKER W
    ON ( I.INJURED_WORKER_HKEY = W.INJURED_WORKER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CUST_NO''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICING_PEACH_NUMBER::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROVIDER_PEACH_NUMBER::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_PROVIDER P
    ON ( I.SERVICE_PROVIDER_HKEY = P.PROVIDER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''SERVICING_PEACH_NUMBER''                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLACE_OF_SERVICE_CODE::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(LINE_PLACE_OF_SERVICE_CODE::text, ''~NA'')                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_PLACE_OF_SERVICE P
    ON ( I.PLACE_OF_SERVICE_HKEY = P.PLACE_OF_SERVICE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PLACE_OF_SERVICE_CODE''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DIAGNOSIS_CODE::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ICD_CODE::text, ''~NA'')                                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_ICD P
    ON ( I.PRINCIPAL_ICD_HKEY = P.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''DIAGNOSIS_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_TYPE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_TYPE_CODE::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''INVOICE_TYPE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FEE_SCHEDULE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_FEE_SCHEDULE_DESC::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''FEE_SCHEDULE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_PAYMENT_CATEGORY::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''ADJUSTMENT_TYPE''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PAID_ABOVE_ZERO_IND''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_FLAG::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(IN_SUBROGATION_IND::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''SUBROGATION_FLAG''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''SUBROGATION_TYPE_DESC''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INPUT_METHOD_CODE::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_INPUT_METHOD_CODE::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''INPUT_METHOD_CODE''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD1_MODIFIER_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_1_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD1_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD2_MODIFIER_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_2_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD2_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD3_MODIFIER_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_3_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD3_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD4_MODIFIER_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SEQUENCE_4_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD4_MODIFIER_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MOD_SET::text, ''~NA'')                                              AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MODIFIER_SET_CODE::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_MODIFIER_SEQUENCE P
    ON ( I.MODIFIER_SEQUENCE_HKEY = P.MODIFIER_SEQUENCE_CODE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''MOD_SET''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TYP_CD::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_TYPE_CODE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_TYP_CD''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STT_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_STT_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STS_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_CODE::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_STS_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''CLM_TRANS_RSN_TYP_CD''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''POLICY_TYPE_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_TYP_CD::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_STATUS_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PLCY_STS_TYP_CD''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_RSN_TYP_CD::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(STATUS_REASON_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''PLCY_STS_RSN_TYP_CD''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE C
    WHERE INVOICE_TYPE = ''PR'' OR INVOICE_TYPE = ''AS''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_MCO_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE''                             as SRC_NAME,
            ''MEDICAL_MART.FACT_PROFESSIONAL_ASC_BILLING''      as TGT_NAME,
            ''POLICY_ACTIVE_IND''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 


--#################################################################################################
--
-- FACT_PRESCRIPTION_BILLING
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                                   AS GROUPVAL,
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                                   AS GROUPVAL,
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''OVERALL''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING P 
    join DIMENSIONS.DIM_DATE D
    ON ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''YEAR(RECEIPT_DATE)''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(MCO_NUMBER::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NETWORK_NUMBER::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_NETWORK N
    ON ( I.SUBMITTING_NETWORK_HKEY = N.NETWORK_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''MCO_NUMBER''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 


--insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
--'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    -- with src_tbl as (
    -- SELECT
    -- CLM_NO                                               AS GROUPVAL, 
    -- COUNT(*)                                                    AS CNT, 
    -- SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    -- SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    -- SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    -- SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    -- SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    -- SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    -- SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    -- SUM(PMT_AMT)                                                AS PMT_AMT
    -- FROM STAGING.DST_INVOICE_PRESCRIPTION C
    -- GROUP BY GROUPVAL
    -- ),
    -- tgt_tbl as (
    -- SELECT
    -- CLAIM_NUMBER                                         AS GROUPVAL, 
    -- COUNT(*)                                                    AS CNT, 
    -- SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    -- SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    -- SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    -- SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    -- SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    -- SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    -- SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    -- SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    -- FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    -- join DIMENSIONS.DIM_CLAIM C
    --  ON ( I.CLAIM_NUMBER_HKEY = C.CLAIM_HKEY )
    -- GROUP BY GROUPVAL
    -- )
    -- select
    --         current_date                                      as AUDIT_DT,
    --         ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
    --         ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
    --         ''CLM_NO''                                          as GROUPVAL,
    -- object_construct(
    --     ''GROUPVAL'',         src.GROUPVAL,
    --     ''COUNT'',            src.CNT,
    --     ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
    --     ''PAID_UNITS'',       src.PAID_UNITS,
    --     ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
    --     ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
    --     ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
    --     ''CALC_AMOUNT'',      src.CALC_AMOUNT,
    --     ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
    --     ''PMT_AMT'',          src.PMT_AMT
    -- ) AS src,      
    -- object_construct(
    --     ''GROUPVAL'',         tgt.GROUPVAL,
    --     ''COUNT'',            tgt.CNT,
    --     ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
    --     ''PAID_UNITS'',       tgt.PAID_UNITS,
    --     ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
    --     ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
    --     ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
    --     ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
    --     ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
    --     ''PMT_AMT'',          tgt.PMT_AMT
    -- ) AS tgt     
    -- from  SRC_TBL src
    --     FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) 
    -- ;


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_STATUS::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_HEADER_CURRENT_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''INVOICE_STATUS''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(LINE_STATUS_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_STATUS_CODE::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_STATUS S
    ON ( I.INVOICE_LINE_ITEM_STATUS_HKEY = S.INVOICE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''LINE_STATUS_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CUST_NO::text, ''~NA'')                                              AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CUSTOMER_NUMBER::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INJURED_WORKER W
    ON ( I.INJURED_WORKER_HKEY = W.INJURED_WORKER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CUST_NO''                                         as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICING_PEACH_NUMBER::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PROVIDER_PEACH_NUMBER::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_PROVIDER P
    ON ( I.PHARMACY_PROVIDER_HKEY = P.PROVIDER_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''SERVICING_PEACH_NUMBER''                          as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PRICE_TYPE::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PRICE_TYPE_CODE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_PBM_PRICING_METHOD P
    ON ( I.PBM_PRICING_METHOD_HKEY = P.PBM_PRICING_METHOD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PRICE_TYPE''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 



insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLIENT_PRICING::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PBM_PRICING_SOURCE_CODE::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_PBM_PRICING_METHOD P
    ON ( I.PBM_PRICING_METHOD_HKEY = P.PBM_PRICING_METHOD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLIENT_PRICING''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 



insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(DIAGNOSIS_CODE::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ICD_CODE::text, ''~NA'')                                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_ICD P
    ON ( I.PRINCIPAL_ICD_HKEY = P.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''DIAGNOSIS_CODE''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(NATIONAL_DRUG_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(NDC_11_CODE::text, ''~NA'')                                          AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_NDC P
    ON ( I.NDC_GPI_HKEY = P.NDC_GPI_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''NATIONAL_DRUG_CODE''                              as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(INVOICE_TYPE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(MEDICAL_INVOICE_TYPE_CODE::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''INVOICE_TYPE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(FEE_SCHEDULE::text, ''~NA'')                                         AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_FEE_SCHEDULE_DESC::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''FEE_SCHEDULE''                                    as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAYMENT_CATEGORY::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(INVOICE_PAYMENT_CATEGORY::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PAYMENT_CATEGORY''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(ADJUSTMENT_TYPE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''ADJUSTMENT_TYPE''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(PAID_ABOVE_ZERO_IND::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PAID_ABOVE_ZERO_IND''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_FLAG::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(IN_SUBROGATION_IND::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''SUBROGATION_FLAG''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SUBROGATION_TYPE_DESC::text, ''~NA'')                                AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_INVOICE_PROFILE P
    ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''SUBROGATION_TYPE_DESC''                           as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

-- insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
--'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    -- with src_tbl as (
    -- SELECT
    -- INPUT_METHOD_CODE                                    AS GROUPVAL, 
    -- COUNT(*)                                                    AS CNT, 
    -- SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    -- SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    -- SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    -- SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    -- SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    -- SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    -- SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    -- SUM(PMT_AMT)                                                AS PMT_AMT
    -- FROM STAGING.DST_INVOICE_PRESCRIPTION C
    -- GROUP BY GROUPVAL
    -- ),
    -- tgt_tbl as (
    -- SELECT
    -- INVOICE_INPUT_METHOD_CODE                            AS GROUPVAL, 
    -- COUNT(*)                                                    AS CNT, 
    -- SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    -- SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    -- SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    -- SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    -- SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    -- SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    -- SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    -- SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    -- FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    -- join DIMENSIONS.DIM_POLICY_STANDING P
    --  ON ( I.INVOICE_PROFILE_HKEY = P.INVOICE_PROFILE_HKEY )
    -- GROUP BY GROUPVAL
    -- )
    -- select
    --         current_date                                      as AUDIT_DT,
    --         ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
    --         ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
    --         ''INPUT_METHOD_CODE''                               as GROUPVAL,
    -- object_construct(
    --     ''GROUPVAL'',         src.GROUPVAL,
    --     ''COUNT'',            src.CNT,
    --     ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
    --     ''PAID_UNITS'',       src.PAID_UNITS,
    --     ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
    --     ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
    --     ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
    --     ''CALC_AMOUNT'',      src.CALC_AMOUNT,
    --     ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
    --     ''PMT_AMT'',          src.PMT_AMT
    -- ) AS src,      
    -- object_construct(
    --     ''GROUPVAL'',         tgt.GROUPVAL,
    --     ''COUNT'',            tgt.CNT,
    --     ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
    --     ''PAID_UNITS'',       tgt.PAID_UNITS,
    --     ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
    --     ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
    --     ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
    --     ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
    --     ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
    --     ''PMT_AMT'',          tgt.PMT_AMT
    -- ) AS tgt     
    -- from  SRC_TBL src
    --     FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) 
    -- ;


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_TYPE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''POLICY_TYPE_CODE''                                as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_TYP_CD::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_STATUS_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PLCY_STS_TYP_CD''                                 as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(PLCY_STS_RSN_TYP_CD::text, ''~NA'')                                  AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(STATUS_REASON_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''PLCY_STS_RSN_TYP_CD''                             as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(POLICY_ACTIVE_IND::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_POLICY_STANDING P
    ON ( I.POLICY_STANDING_HKEY = P.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''POLICY_ACTIVE_IND''                               as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(SERVICE_LEVEL::text, ''~NA'')                                        AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(SERVICE_LEVEL_CODE::text, ''~NA'')                                   AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_PRESCRIPTION_BILL P
    ON ( I.PRESCRIPTION_BILL_HKEY = P.PRESCRIPTION_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''SERVICE_LEVEL''                                   as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TYP_CD::text, ''~NA'')                                           AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_TYPE_CODE::text, ''~NA'')                                      AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLM_TYP_CD''                                      as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STT_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATE_CODE::text, ''~NA'')                                     AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLM_STT_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_STS_TYP_CD::text, ''~NA'')                                       AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_CODE::text, ''~NA'')                                    AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLM_STS_TYP_CD''                                  as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')                                 AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(UNITS_OF_SERVICE)                                       AS UNITS_OF_SERVICE, 
    SUM(PAID_UNITS)                                             AS PAID_UNITS, 
    SUM(BILLED_AMOUNT)                                          AS BILLED_AMOUNT, 
    SUM(NTWK_BILLED_AMT)                                        AS NTWK_BILLED_AMT, 
    SUM(FEE_SCHED_AMOUNT)                                       AS FEE_SCHED_AMOUNT, 
    SUM(CALC_AMOUNT)                                            AS CALC_AMOUNT, 
    SUM(APPROVED_AMOUNT)                                        AS APPROVED_AMOUNT, 
    SUM(PMT_AMT)                                                AS PMT_AMT
    FROM STAGING.DST_INVOICE_PRESCRIPTION C
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')                             AS GROUPVAL, 
    COUNT(*)                                                    AS CNT, 
    SUM(LINE_UNITS_OF_BILLED_SERVICE_COUNT)                     AS UNITS_OF_SERVICE, 
    SUM(LINE_UNITS_OF_PAID_SERVICE_COUNT)                       AS PAID_UNITS, 
    SUM(LINE_PROVIDER_BILLED_AMOUNT)                            AS BILLED_AMOUNT, 
    SUM(LINE_PBM_ALLOWED_AMOUNT)                                AS NTWK_BILLED_AMT, 
    SUM(LINE_BWC_FEE_SCHEDULE_LOOKUP_AMOUNT)                    AS FEE_SCHED_AMOUNT, 
    SUM(LINE_BWC_FEE_SCHEDULE_CALCULATED_AMOUNT)                AS CALC_AMOUNT, 
    SUM(LINE_BWC_APPROVED_AMOUNT)                               AS APPROVED_AMOUNT, 
    SUM(LINE_INTEREST_AMOUNT)                                   AS PMT_AMT
    FROM MEDICAL_MART.FACT_PRESCRIPTION_BILLING I 
    join DIMENSIONS.DIM_CLAIM_TYPE_STATUS P
    ON ( I.CLAIM_TYPE_STATUS_HKEY = P.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select
            current_date                                      as AUDIT_DT,
            ''STAGING.DST_INVOICE_PRESCRIPTION''                as SRC_NAME,
            ''MEDICAL_MART.FACT_PRESCRIPTION_BILLING''          as TGT_NAME,
            ''CLM_TRANS_RSN_TYP_CD''                            as GROUPVAL,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT,
        ''UNITS_OF_SERVICE'', src.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       src.PAID_UNITS,
        ''BILLED_AMOUNT'',    src.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  src.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', src.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      src.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  src.APPROVED_AMOUNT,
        ''PMT_AMT'',          src.PMT_AMT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT,
        ''UNITS_OF_SERVICE'', tgt.UNITS_OF_SERVICE,
        ''PAID_UNITS'',       tgt.PAID_UNITS,
        ''BILLED_AMOUNT'',    tgt.BILLED_AMOUNT,
        ''NTWK_BILLED_AMT'',  tgt.NTWK_BILLED_AMT,
        ''FEE_SCHED_AMOUNT'', tgt.FEE_SCHED_AMOUNT,
        ''CALC_AMOUNT'',      tgt.CALC_AMOUNT,
        ''APPROVED_AMOUNT'',  tgt.APPROVED_AMOUNT,
        ''PMT_AMT'',          tgt.PMT_AMT
    ) AS tgt     
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on ( src.GROUPVAL = tgt.GROUPVAL  ) '); 

--#################################################################################################
--
-- FLF_MEDICAL_INVOICE_PROCEDURES
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_DATE D
        on ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''OVERALL''                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

--#################################################################################################
--
-- FLF_MEDICAL_INVOICE_PROCEDURES comparisons
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''OVERALL''                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- DATES (Year) grouping
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(YEAR(RECEIPT_DATE)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_DATE D
        on ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''RECEIPT YEAR''                                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(SERVICE_FROM)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_DATE D
        on ( P.INVOICE_SERVICE_FROM_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''SERVICE_FROM YEAR''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
        NVL( YEAR(SERVICE_TO)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_DATE D
        on ( P.INVOICE_SERVICE_TO_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''SERVICE_TO YEAR''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


    --#################################################################################################
    --HOSPITAL ICD PROCEDURE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(PROCEDURE_CODE::text, ''~NA'')          as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_HOSPITAL_PROCEDURE PRO 
        on ( hdr.invoice_header_id = PRO.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(ICD_PROCEDURE_CODE::text, ''~NA'')                          as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES P
        join DIMENSIONS.DIM_HOSPITAL_ICD_PROCEDURE H
        on ( P.HEADER_PROCEDURE_HKEY = H.ICD_PROCEDURE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_PROCEDURES'' as TGT_NAME,
            ''PROCEDURE_CODE''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


--#################################################################################################
--
-- FLF_MEDICAL_INVOICE_DIAGNOSIS comparisons
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS dia 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS''  as TGT_NAME,
            ''OVERALL''                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- DATES (Year) grouping
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(RECEIPT_DATE)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS dia 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_DATE D
        on ( P.BWC_BILL_RECEIPT_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''RECEIPT YEAR''                                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(SERVICE_FROM)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS dia 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_DATE D
        on ( P.INVOICE_SERVICE_FROM_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''SERVICE_FROM YEAR''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(SERVICE_TO)::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS dia 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(D.ACTUAL_DATE)::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_DATE D
        on ( P.INVOICE_SERVICE_TO_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''SERVICE_TO YEAR''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');



    --#################################################################################################
    --ICD DIAGNOSTIC CODE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( hdr.DIAGNOSIS_CODE::text, ''~NA'')            as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS DIA 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(ICD_CODE::text, ''~NA'')                          as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_ICD D
        on ( P.HEADER_DIAGNOSIS_HKEY = D.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''DIAGNOSIS_CODE''                             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    --ICD ADMISSION PRESENCE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(PRESENT_ON_ADMIT::text, ''~NA'')        as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.STG_INVOICE_HEADER  hdr
        inner join STAGING.STG_INVOICE_DIAGNOSIS DIA 
        on ( hdr.invoice_header_id = dia.invoice_header_id )
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(PRESENT_ON_ADMISSION_CODE::text, ''~NA'')                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS P
        join DIMENSIONS.DIM_ICD_ADMISSION_PRESENCE D
        on ( P.PRESENT_ON_ADMISSION_HKEY = D.PRESENT_ON_ADMISSION_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.STG_INVOICE_HEADER''                as SRC_NAME,
            ''MEDICAL_MART.FLF_MEDICAL_INVOICE_DIAGNOSIS'' as TGT_NAME,
            ''PRESENT_ON_ADMIT''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


--#################################################################################################
--
-- FLF_HEALTHCARE_SERVICE_AUTHORIZATION comparisons
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION P
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''OVERALL''                                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(CASE_SERV_AUTH_DT)::text, ''~NA'')                 as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_DATE D
        on( S.AUTHORIZATION_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_DATE YEAR''                                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(CASE_SERV_APRV_FR_DT)::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_DATE D
        on( S.AUTHORIZATION_FROM_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_FROM_DATE YEAR''                                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(CASE_SERV_APRV_TO_DT)::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_DATE D
        on( S.AUTHORIZATION_THROUGH_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_THROUGH_DATE YEAR''                             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


    --#################################################################################################
    -- HEALTHCARE AUTHORIZATION STATUS
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CASE_SERV_STS_TYP_CD::text, ''~NA'')                  as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(AUTHORIZATION_STATUS_CODE::text, ''~NA'')                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_HEALTHCARE_AUTHORIZATION_STATUS D
        on( S.HEALTHCARE_AUTHORIZATION_STATUS_HKEY = D.HEALTHCARE_AUTHORIZATION_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_STATUS_CODE''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CASE_SERV_TYP_CD::text, ''~NA'')                      as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(AUTHORIZATION_SERVICE_TYPE_CODE::text, ''~NA'')             as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_HEALTHCARE_AUTHORIZATION_STATUS D
        on( S.HEALTHCARE_AUTHORIZATION_STATUS_HKEY = D.HEALTHCARE_AUTHORIZATION_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''AUTHORIZATION_SERVICE_TYPE_CODE''                             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    -- CASE TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CASE_TYP_CD::text, ''~NA'')                           as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CASE_TYPE_CODE::text, ''~NA'')                              as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_CASE_TYPE D
        on( S.CASE_TYPE_HKEY = D.CASE_TYPE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''CASE_TYPE_CODE''                                              as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CASE_CTG_TYP_CD::text, ''~NA'')                       as GROUPVAL, 
            COUNT(*)                              as CNT
    FROM  STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION  hdr
        WHERE YEAR(CASE_SERV_AUTH_DT) > 2016
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CASE_CATEGORY_CODE::text, ''~NA'')                          as GROUPVAL,
            count(*)                                    as CNT
    FROM  MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION  S
        inner join DIMENSIONS.DIM_CASE_TYPE D
        on( S.CASE_TYPE_HKEY = D.CASE_TYPE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                                  as AUDIT_DT,
            ''STAGING.DST_HEALTHCARE_SERVICE_AUTHORIZATION''                as SRC_NAME,
            ''MEDICAL_MART.FLF_HEALTHCARE_SERVICE_AUTHORIZATION''           as TGT_NAME,
            ''CASE_CATEGORY_CODE''                                          as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


--#################################################################################################
--
-- FLF_CLAIM_ICD_ALLOWANCE comparisons
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            ''OVERALL''               as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  CLM
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( CLM.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            ''OVERALL''                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL P
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''OVERALL''                                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL( YEAR(ICD_STS_DT)::text, ''~NA'')          as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_DATE D
        on ( CIAD.ICD_STATUS_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''ICD_STS_DT YEAR''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- ICD CODE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(ICD_CODE::text, ''~NA'')                as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(ICD_CODE::text, ''~NA'')                                    as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_ICD I
        on ( CIAD.ICD_HKEY = I.ICD_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''ICD_CODE''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- CLAIM ICD STATUS TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(ICD_STS_TYP_CD::text, ''~NA'')                as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(ICD_STATUS_TYPE_CODE::text, ''~NA'')                        as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_ICD_STATUS_TYPE I
        on ( CIAD.CLAIM_ICD_STATUS_TYPE_HKEY = I.CLAIM_ICD_STATUS_TYPE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''ICD_STATUS_TYPE_CODE''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_ICD_STS_PRI_IND::text, ''~NA'')     as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_ICD_PRIMARY_IND::text, ''~NA'')                       as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_ICD_STATUS_TYPE I
        on ( CIAD.CLAIM_ICD_STATUS_TYPE_HKEY = I.CLAIM_ICD_STATUS_TYPE_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_ICD_PRIMARY_IND''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_TYP_CD::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_TYPE_CODE::text, ''~NA'')                             as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_TYPE_STATUS_HKEY''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CHNG_OVR_IND::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_TYPE_CHANGE_OVER_IND::text, ''~NA'')                  as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_TYPE_CHANGE_OVER_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_STT_TYP_CD::text, ''~NA'')          as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_STATE_CODE::text, ''~NA'')                            as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_STATE_CODE''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

        
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_STS_TYP_CD::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_STATUS_CODE::text, ''~NA'')                           as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_STATUS_CODE''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_TRANS_RSN_TYP_CD::text, ''~NA'')              as GROUPVAL, 
            COUNT(*)                          as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CLAIM_STATUS_REASON_CODE::text, ''~NA'')                    as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_TYPE_STATUS I
        on ( CIAD.CLAIM_TYPE_STATUS_HKEY = I.CLAIM_TYPE_STATUS_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CLAIM_STATUS_REASON_CODE''                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    -- CLAIM DETAIL
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(OCCR_SRC_TYP_NM::text, ''~NA'')                as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(FILING_SOURCE_DESC::text, ''~NA'')                        as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''FILING_SOURCE_DESC''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(OCCR_MEDA_TYP_NM::text, ''~NA'')               as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(FILING_MEDIA_DESC::text, ''~NA'')                        as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''FILING_MEDIA_DESC''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(NOI_CTG_TYP_NM::text, ''~NA'')               as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(NATURE_OF_INJURY_CATEGORY::text, ''~NA'')                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''NATURE_OF_INJURY_CATEGORY''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(NOI_TYP_NM::text, ''~NA'')               as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(NATURE_OF_INJURY_TYPE::text, ''~NA'')                       as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''NATURE_OF_INJURY_TYPE''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(FIREFIGHTER_CANCER_IND::text, ''~NA'')         as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(FIREFIGHTER_CANCER_IND::text, ''~NA'')                      as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''FIREFIGHTER_CANCER_IND''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(COVID_EXPOSURE_IND::text, ''~NA'')             as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(COVID_EXPOSURE_IND::text, ''~NA'')                          as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''COVID_EXPOSURE_IND''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(COVID_EMERGENCY_WORKER_IND::text, ''~NA'')     as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(COVID_EMERGENCY_WORKER_IND::text, ''~NA'')                  as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''COVID_EMERGENCY_WORKER_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(COVID_HEALTH_CARE_WORKER_IND::text, ''~NA'')     as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(COVID_HEALTH_CARE_WORKER_IND::text, ''~NA'')                  as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''COVID_HEALTH_CARE_WORKER_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(COMBINED_CLAIM_IND::text, ''~NA'')             as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(COMBINED_IND::text, ''~NA'')                                as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''COMBINED_IND''                               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(SB223_IND::text, ''~NA'')                      as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(SB223_IND::text, ''~NA'')                                   as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''SB223_IND''                                  as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(EMPLOYER_PREMISES_IND::text, ''~NA'')          as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(EMPLOYER_PREMISES_IND::text, ''~NA'')                       as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''EMPLOYER_PREMISES_IND''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    select 
            NVL(CLM_CTRPH_INJR_IND::text, ''~NA'')             as GROUPVAL, 
            COUNT(*)                       as CNT
    FROM  STAGING.DSV_CLAIM_ICD_STATUS_HISTORY  hdr
        join DIMENSIONS.DIM_ICD ICD
        on ( coalesce( hdr.ICD_CD, ''UNK'') = ICD.ICD_CODE AND ICD_STS_DT BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31'') )
    WHERE VOID_IND = ''N''
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    select 
            NVL(CATASTROPHIC_IND::text, ''~NA'')                            as GROUPVAL,
            count(*)                                    as CNT
    FROM  CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL CIAD
        JOIN DIMENSIONS.DIM_CLAIM_DETAIL I
        on ( CIAD.CLAIM_DETAIL_HKEY = I.CLAIM_DETAIL_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                 as AUDIT_DT,
            ''STAGING.DSV_CLAIM_ICD_STATUS_HISTORY''       as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_ICD_ALLOWANCE_DETAIL'' as TGT_NAME,
            ''CATASTROPHIC_IND''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


---- ADD FACT_CONSOLIDATED_MEDICAL_BILLING

--#################################################################################################
--
-- FACT_DETAIL_PAYMENT_CODING comparisons
-- added 2022-05-20
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into DEV_EDW_32600145.STAGING.AUDIT_JSON  ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                     AS GROUPVAL,
    COUNT(*)                                      AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                     AS GROUPVAL,
    COUNT(*)                                      AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''OVERALL''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(WRNT_DATE)::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                  AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_DATE D
            ON ( F.WARRANT_DATE_HKEY = D.DATE_KEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''WARRANT YEAR''                              as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- PAYMENT CODER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( ACNTB_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( ACCOUNTABILITY_CODE::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''ACCOUNTABILITY_CODE''                       as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PYMNT_FUND_TYPE::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PAYMENT_FUND_TYPE_CODE::text, ''~NA'')         AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''PAYMENT_FUND_TYPE_CODE''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CVRG_TYPE::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( COVERAGE_TYPE_CODE::text, ''~NA'')             AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER  C
            ON (F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''COVERAGE_TYPE_CODE''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( BILL_TYPE_F2::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( BILL_TYPE_F2_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON (F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''BILL_TYPE_F2_CODE''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( BILL_TYPE_L3::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( BILL_TYPE_L3_CODE::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''BILL_TYPE_L3_CODE''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( ACDNT_TYPE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( ACCIDENT_TYPE_CODE::text, ''~NA'')             AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''ACCIDENT_TYPE_CODE''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( STS_CODE::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PAYMENT_STATUS_CODE::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYMENT_CODER C
            ON ( F.PAYMENT_CODER_HKEY = C.PAYMENT_CODER_HKEY )
    GROUP BY GROUPVAL
    )
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''PAYMENT_STATUS_CODE''                       as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- PAYEE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PAYEE_NAME::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DST_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PAYEE_FULL_NAME::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_PAYEE P
            ON ( F.PAYEE_HKEY = P.PAYEE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''PAYEE_FULL_NAME''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- CLAIM PAYMENT CATEGORY
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( CLAIM_PAYMENT_CATEGORY_DESC::text, ''~NA'')    AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM STAGING.DSV_DETAIL_PAYMENT_CODING
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( CLAIM_PAYMENT_CATEGORY_DESC::text, ''~NA'')    AS GROUPVAL, 
    COUNT(*)                                    AS CNT
    FROM MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING F
        JOIN DIMENSIONS.DIM_CLAIM_PAYMENT_CATEGORY C
            ON ( F.CLAIM_PAYMENT_CATEGORY_HKEY = C.CLAIM_PAYMENT_CATEGORY_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DETAIL_PAYMENT_CODING''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DETAIL_PAYMENT_CODING''   as TGT_NAME,
            ''CLAIM_PAYMENT_CATEGORY_DESC''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


--#################################################################################################
--
-- FACT_DISABILITY_TRACKING
-- ADDED 2022-05-20
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                    AS GROUPVAL,
    COUNT(*)                                     AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                    AS GROUPVAL,
    COUNT(*)                                     AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''OVERALL''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CLM_DISAB_MANG_EFF_DT)::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( DT.DISABILITY_START_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_START_DATE YEAR''                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CLM_DISAB_MANG_END_DT)::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN DIMENSIONS.DIM_DATE  D
            ON ( DT.DISABILITY_END_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_END_DATE YEAR''                  as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- USER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CR_USER_LGN_NM::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( USER_LOGIN_NAME::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING  DT
        JOIN  DIMENSIONS.DIM_USER U
            ON ( DT.CREATE_USER_HKEY = U.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''CR_USER_LGN_NM''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( UP_USER_LGN_NM::text, ''~NA'')                               AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT
    NVL( USER_LOGIN_NAME::text, ''~NA'')                              AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN DIMENSIONS.DIM_USER  U
            ON ( DT.UPDATE_USER_HKEY = U.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''UP_USER_LGN_NM''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- DISABILITY TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CLM_DISAB_MANG_DISAB_TYP_CD::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( DISABILITY_TYPE_CODE::text, ''~NA'')                         AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING  DT
        JOIN  DIMENSIONS.DIM_DISABILITY_TYPE  D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_TYPE_CODE''                      as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CLM_DISAB_MANG_RSN_TYP_CD::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( DISABILITY_REASON_TYPE_CODE::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING  DT
        JOIN  DIMENSIONS.DIM_DISABILITY_TYPE D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_REASON_TYPE_CODE''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CLM_DISAB_MANG_MED_STS_TYP_CD::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( DISABILITY_MEDICAL_STATUS_TYPE_CODE::text, ''~NA'')          AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FACT_DISABILITY_TRACKING  DT
        JOIN  DIMENSIONS.DIM_DISABILITY_TYPE D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY)
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_MEDICAL_STATUS_TYPE_CODE''       as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CLM_DISAB_MANG_WK_STS_TYP_CD, ''NA'')                 AS GROUPVAL, 
    COUNT(*)                                                 AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( DISABILITY_WORK_STATUS_TYPE_CODE::text, ''~NA'')             AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM  CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN DIMENSIONS.DIM_DISABILITY_TYPE  D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''DISABILITY_WORK_STATUS_TYPE_CODE''          as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CURRENT_DISABILITY_STATUS_IND::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DST_DISABILITY_MANAGEMENT
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( CURRENT_DISABILITY_STATUS_IND::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM  CLAIMS_MART.FACT_DISABILITY_TRACKING DT
        JOIN DIMENSIONS.DIM_DISABILITY_TYPE D
            ON ( DT.DISABILITY_TYPE_HKEY = D.DISABILITY_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DST_DISABILITY_MANAGEMENT''         as SRC_NAME,
            ''MEDICAL_MART.FACT_DISABILITY_TRACKING''     as TGT_NAME,
            ''CURRENT_DISABILITY_STATUS_IND''             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

--#################################################################################################
--
-- FACT_EARNED_PREMIUM
-- ADDED 2022-05-20
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    ''OVERALL''                                         AS GROUPVAL,
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    ''OVERALL''                                         AS GROUPVAL,
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''OVERALL''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(BILLED_DATE)::text, ''~NA'')                          AS GROUPVAL, 
    COUNT(*)                                                AS CNT, 
    SUM(EARNED_AMOUNT)                                      AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                        AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                                     AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT 
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( EP.BILLED_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''BILLED_DATE YEAR''                          as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(BILL_DUE_DATE)::text, ''~NA'')                  AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_DATE D
            ON ( EP.BILL_DUE_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''BILL_DUE_DATE YEAR''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(PAID_DATE)::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_DATE D
            ON ( EP.PAID_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''PAID_DATE YEAR''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CERTIFIED_AG_DATE)::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( EP.CERTIFIED_TO_AG_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''CERTIFIED_AG_DATE YEAR''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');


    --#################################################################################################
    -- EMPLOYER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CUSTOMER_NUMBER::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( CUSTOMER_NUMBER::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_EMPLOYER EMP
            ON (  EP.EMPLOYER_HKEY = EMP.EMPLOYER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''CUSTOMER_NUMBER''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- POLICY PERIOD
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(POLICY_PERIOD_EFFECTIVE_DATE)::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(POLICY_PERIOD_EFFECTIVE_DATE)::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_POLICY_PERIOD PP
            ON ( EP.POLICY_PERIOD_HKEY = PP.POLICY_PERIOD_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_PERIOD_EFFECTIVE_DATE YEAR''         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(POLICY_PERIOD_END_DATE)::text, ''~NA'')         AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT 
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( YEAR(POLICY_PERIOD_END_DATE)::text, ''~NA'')         AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_PERIOD PP
            ON ( EP.POLICY_PERIOD_HKEY = PP.POLICY_PERIOD_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_PERIOD_END_DATE YEAR''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PEC_POLICY_IND::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PEC_POLICY_IND::text, ''~NA'')                       AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_PERIOD PP
            ON ( EP.POLICY_PERIOD_HKEY = PP.POLICY_PERIOD_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''PEC_POLICY_IND''                            as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

    --#################################################################################################
    -- POLICY STANDING
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( POLICY_TYPE_CODE, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( POLICY_TYPE_CODE::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_STANDING PS
            ON ( EP.POLICY_STANDING_HKEY = PS.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_TYPE_CODE''                          as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( POLICY_STATUS_CODE::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( POLICY_STATUS_CODE::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_STANDING PS
            ON EP.POLICY_STANDING_HKEY = PS.POLICY_STANDING_HKEY
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_STATUS_CODE''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( STATUS_REASON_CODE::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( STATUS_REASON_CODE::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_STANDING PS
            ON ( EP.POLICY_STANDING_HKEY = PS.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''STATUS_REASON_CODE''                        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( POLICY_ACTIVE_IND::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( POLICY_ACTIVE_IND::text, ''~NA'')                    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_STANDING PS
            ON ( EP.POLICY_STANDING_HKEY = PS.POLICY_STANDING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_ACTIVE_IND''                         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- FINANCIAL TRANSACTION TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_TYPE_ID::text, ''~NA'')        AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_TYPE_ID::text, ''~NA'')        AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_FINANCIAL_TRANSACTION_TYPE PS
            ON ( EP.FINANCIAL_TRANSACTION_TYPE_HKEY = PS.FINANCIAL_TRANSACTION_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''FINANCIAL_TRANSACTION_TYPE_ID''             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- FINANCIAL TRANSACTION STATUS
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_STATUS_CODE::text, ''~NA'')    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_STATUS_CODE::text, ''~NA'')    AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_FINANCIAL_TRANSACTION_STATUS PS
            ON ( EP.FINANCIAL_TRANSACTION_STATUS_HKEY = PS.FINANCIAL_TRANSACTION_STATUS_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''FINANCIAL_TRANSACTION_STATUS_CODE''         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    --  POLICY FINANCIAL TRANSACTION COMMENT
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PFT_COMMENT_TEXT::text, ''~NA'')                     AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( FINANCIAL_TRANSACTION_COMMENT_TEXT::text, ''~NA'')   AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_POLICY_FINANCIAL_TRANSACTION_COMMENT PS
            ON ( EP.FINANCIAL_TRANSACTION_COMMENT_HKEY = PS.FINANCIAL_TRANSACTION_COMMENT_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''FINANCIAL_TRANSACTION_COMMENT_TEXT''        as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    --  USER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( CREATE_USER_LOGIN_NAME::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( USER_LOGIN_NAME::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_USER PS
            ON ( EP.FINANCIAL_TRANSACTION_CREATE_USER_HKEY = PS.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''CREATE_USER_LOGIN_NAME''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    --  POLICY BILLING
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PAYMENT_PLAN_TYPE_DESC::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( PAYMENT_PLAN_TYPE_DESC::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''PAYMENT_PLAN_TYPE_DESC''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( REPORTING_FREQUENCY_TYPE_DESC::text, ''~NA'')        AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( REPORTING_FREQUENCY_TYPE_DESC::text, ''~NA'')        AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''REPORTING_FREQUENCY_TYPE_DESC''             as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( AUDIT_TYPE_DESC::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( AUDIT_TYPE_DESC::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''AUDIT_TYPE_DESC''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( EMPLOYEE_LEASING_TYPE_DESC::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( EMPLOYEE_LEASING_TYPE_DESC::text, ''~NA'')           AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''EMPLOYEE_LEASING_TYPE_DESC''                as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( POLICY_15K_PROGRAM_IND::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( POLICY_15K_PROGRAM_IND::text, ''~NA'')               AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''POLICY_15K_PROGRAM_IND''                    as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( REPORTED_ZERO_PAYROLL_IND::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( REPORTED_ZERO_PAYROLL_IND::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''REPORTED_ZERO_PAYROLL_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( ESTIMATED_PREMIUM_IND::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT 
    FROM STAGING.DSV_EARNED_PREMIUM EP
        JOIN EDW_STAGING_DIM.DIM_EMPLOYER EMP 
            ON ( EP.EMPLOYER_CUSTOMER_NUMBER = EMP.CUSTOMER_NUMBER 
                AND EP.BILLED_DATE BETWEEN EMP.RECORD_EFFECTIVE_DATE 
                    AND COALESCE(EMP.RECORD_END_DATE, ''2999-12-31'') )
        LEFT JOIN EDW_STAGING_DIM.DIM_USER U 
            ON ( EP.CREATE_USER_LOGIN_NAME = U.USER_LOGIN_NAME)
    GROUP BY GROUPVAL
    ),
    tgt_tbl as (
    SELECT 
    NVL( ESTIMATED_PREMIUM_IND::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                          AS CNT, 
    SUM(EARNED_AMOUNT)                                AS EARNED_AMOUNT, 
    SUM(PAID_AMOUNT)                                  AS PAID_AMOUNT, 
    SUM(BALANCE_AMOUNT)                               AS BALANCE_AMOUNT
    FROM POLICY_MART.FACT_EARNED_PREMIUM EP
        JOIN  DIMENSIONS.DIM_POLICY_BILLING PS
            ON ( EP.POLICY_BILLING_HKEY = PS.POLICY_BILLING_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_EARNED_PREMIUM''                as SRC_NAME,
            ''POLICY_MART.FACT_EARNED_PREMIUM''           as TGT_NAME,
            ''ESTIMATED_PREMIUM_IND''                     as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

--#################################################################################################
--
-- FACT_CLAIM_PARTICIPATION
--
--#################################################################################################
-- OVERALL
--#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    ''OVERALL''                                           AS GROUPVAL,
    COUNT(*)                                           AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    ''OVERALL''                                           AS GROUPVAL,
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''OVERALL''                                   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    -- DATE (YEAR)
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(AUDIT_USER_CREATE_DATE)::text, ''~NA'')                 AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                            AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( P.CREATE_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''AUDIT_USER_CREATE_DATE YEAR''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(AUDIT_USER_UPDATE_DATE)::text, ''~NA'')                 AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( P.UPDATE_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''AUDIT_USER_UPDATE_DATE YEAR''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CLAIM_PARTICIPATION_EFFECTIVE_DATE)::text, ''~NA'')     AS GROUPVAL, 
    COUNT(*)                                                  AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN DIMENSIONS.DIM_DATE D
            ON ( P.PARTICIPATION_EFFECTIVE_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''CLAIM_PARTICIPATION_EFFECTIVE_DATE YEAR''   as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( YEAR(CLAIM_PARTICIPATION_END_DATE)::text, ''~NA'')     AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT
    NVL( YEAR(ACTUAL_DATE)::text, ''~NA'')                      AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_DATE D
            ON ( P.PARTICIPATION_END_DATE_KEY = D.DATE_KEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''CLAIM_PARTICIPATION_END_DATE YEAR''         as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    -- PARTICIPATION TYPE
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PARTICIPATION_TYPE_CODE::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( PARTICIPATION_TYPE_CODE::text, ''~NA'')                AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_PARTICIPATION_TYPE PT
            ON ( P.PARTICIPATION_TYPE_HKEY = PT.PARTICIPATION_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''PARTICIPATION_TYPE_CODE''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PARTICIPATION_PRIMARY_IND::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( PARTICIPATION_PRIMARY_IND::text, ''~NA'')              AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_PARTICIPATION_TYPE PT
            ON ( P.PARTICIPATION_TYPE_HKEY = PT.PARTICIPATION_TYPE_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''PARTICIPATION_PRIMARY_IND''                 as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval )');


    --#################################################################################################
    --  CUSTOMER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT
    NVL( PART.CUSTOMER_NUMBER::text, ''~NA'')                   AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( CUSTOMER_NUMBER::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_CUSTOMER C
            ON ( P.CUSTOMER_HKEY = C.CUSTOMER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''CUSTOMER_NUMBER''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

    --#################################################################################################
    --  USER
    --#################################################################################################
insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PART.CREATE_USER_LOGIN_NAME::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( USER_LOGIN_NAME::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_USER U
            ON ( P.CREATE_USER_HKEY = U.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''USER_LOGIN_NAME''                           as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');

insert into DEV_EDW_32600145.STAGING.AUDIT_SCRIPTS values (
'insert into  DEV_EDW_32600145.STAGING.AUDIT_JSON ( audit_dt, src_name, tgt_name, groupby, src, tgt )
    with src_tbl as (
    SELECT 
    NVL( PART.UPDATE_USER_LOGIN_NAME::text, ''~NA'')            AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM STAGING.DSV_CLAIM_PARTICIPATION PART
        LEFT JOIN DIMENSIONS.DIM_CUSTOMER CUST 
        ON ( PART.CUSTOMER_NUMBER = CUST.CUSTOMER_NUMBER 
            AND coalesce(CLAIM_PARTICIPATION_END_DATE,''2099-12-31'') 
                BETWEEN RECORD_EFFECTIVE_DATE AND coalesce(RECORD_END_DATE, ''2099-12-31''))
    GROUP BY GROUPVAL
    ),
    tgt_tbl AS (
    SELECT 
    NVL( USER_LOGIN_NAME::text, ''~NA'')                        AS GROUPVAL, 
    COUNT(*)                                            AS CNT
    FROM CLAIMS_MART.FLF_CLAIM_PARTICIPATION P
        JOIN  DIMENSIONS.DIM_USER U
            ON ( P.UPDATE_USER_HKEY = U.USER_HKEY )
    GROUP BY GROUPVAL)
    select 
            current_date                                as AUDIT_DT,
            ''STAGING.DSV_CLAIM_PARTICIPATION''           as SRC_NAME,
            ''CLAIMS_MART.FLF_CLAIM_PARTICIPATION''       as TGT_NAME,
            ''UPDATE_USER_LOGIN_NAME''               as GROUPBY,
    object_construct(
        ''GROUPVAL'',         src.GROUPVAL,
        ''COUNT'',            src.CNT
    ) AS src,      
    object_construct(
        ''GROUPVAL'',         tgt.GROUPVAL,
        ''COUNT'',            tgt.CNT
    ) AS tgt
    from  SRC_TBL src
        FULL OUTER JOIN TGT_TBL  tgt on (src.groupval = tgt.groupval ) ');



---- ADD CLAIM_PROGRESS_SNAPSHOT


create or replace procedure TABLE_PROFILE (TSCHEMA TEXT, TNAME TEXT)
    RETURNS TABLE ( tblnm text, colnm text, ttl_cnt number, miss_cnt number, ttl_dist number,  min_val text, max_val text, min_len number, max_len number)
    LANGUAGE SQL
    EXECUTE AS OWNER
    as
declare
    rs resultset;
    rs2 resultset;
    rs_output resultset;
begin
    -- get relevant tables
    let dbname := 'DEV_EDW';
    let db_catalog:= dbname||'.INFORMATION_SCHEMA.columns';
    let table_schema := :TSCHEMA;
    let table_name := :TNAME;
    -- let cutoff := 5;
    
    rs := (select table_schema, table_name, column_name, data_type from 
            IDENTIFIER(:db_catalog)
             where TABLE_SCHEMA != 'INFORMATION_SCHEMA'
               and TABLE_SCHEMA = :table_schema and table_name = :table_name);

    let tmp_array := ARRAY_CONSTRUCT();
    let table_count :=0;let i:=0;
    for arow_rs in rs do
        i:= i+1;
        let aschema := '"'|| arow_rs.table_schema::TEXT || '"';
        let atable  := '"'|| arow_rs.table_name::TEXT ||'"';
        let acol    := '"'|| arow_rs.column_name::TEXT ||'"';
        let adt     := arow_rs.data_type::TEXT;
        let qualified_table := aschema||'.'||atable;     

        let query := 'select '''||qualified_table||''' as tblnm, '''||acol||''' as colnm, count(1) as ttl_cnt, sum(nvl2('||acol||',0,1)) as miss_cnt, count(distinct '||acol||') as ttl_dist,  min('||acol||') as min_val, max('||acol||') as max_val, len(min('||acol||')) as min_len, len(max('||acol||')) as max_len from '|| qualified_table;
        rs2 :=  ( execute immediate :query    );
        
        for arow_rs2 in rs2 do
          let tbl       := arow_rs2.tblnm::text;
          let colnm     := arow_rs2.colnm::text;
          let ttl_cnt   := arow_rs2.ttl_cnt::number;
          let miss_cnt  := arow_rs2.miss_cnt::number;
          let ttl_dist  := arow_rs2.ttl_dist::number;
          let min_val   := arow_rs2.min_val::text;
          let max_val   := arow_rs2.max_val::text;
          let min_len   := arow_rs2.min_len::number;
          let max_len   := arow_rs2.max_len::number;
          let obj       :=  OBJECT_CONSTRUCT('table_name', tbl, 'column',colnm, 'ttl_cnt',ttl_cnt, 'miss_cnt',miss_cnt, 'ttl_dist',ttl_dist, 'min_val',min_val, 'max_val',max_val, 'min_len',min_len, 'max_len',max_len );
          tmp_array := array_append(:tmp_array, obj );
        end for;

       -- if (i >= :cutoff ) then break; end if;    
    end for; 

    rs_output := (select 
                    value:table_name::text as tblnm,
                    value:column::text as colnm,
                    value:ttl_cnt::number as ttl_cnt,
                    value:miss_cnt::number as miss_cnt,
                    value:ttl_dist::number as ttl_dist,
                    value:min_val::text as min_val,
                    value:max_val::text as max_val,
                    value:min_len::number as min_len,
                    value:max_len::number as max_len
                  from table(flatten(:tmp_array)));
    return table(rs_output);
end;

call TABLE_PROFILE ('CLAIMS_MART', 'FACT_CLAIM_PROGRESS_SNAPSHOT');


call FACT_METRICS('MEDICAL_MART',-1);




select current_date;


